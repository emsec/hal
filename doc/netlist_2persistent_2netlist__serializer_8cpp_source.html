<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HAL: /home/runner/work/hal/hal/src/netlist/persistent/netlist_serializer.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="hal_icon.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">HAL
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('netlist_2persistent_2netlist__serializer_8cpp_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">netlist_serializer.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="netlist_2persistent_2netlist__serializer_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="netlist__serializer_8h.html">hal_core/netlist/persistent/netlist_serializer.h</a>&quot;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160; </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="boolean__function_8h.html">hal_core/netlist/boolean_function.h</a>&quot;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="gate_8h.html">hal_core/netlist/gate.h</a>&quot;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="gate__library__manager_8h.html">hal_core/netlist/gate_library/gate_library_manager.h</a>&quot;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="module_8h.html">hal_core/netlist/module.h</a>&quot;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="net_8h.html">hal_core/netlist/net.h</a>&quot;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="include_2hal__core_2netlist_2netlist_8h.html">hal_core/netlist/netlist.h</a>&quot;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="project__manager_8h.html">hal_core/netlist/project_manager.h</a>&quot;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="log_8h.html">hal_core/utilities/log.h</a>&quot;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;rapidjson/filereadstream.h&quot;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &quot;rapidjson/stringbuffer.h&quot;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160; </div>
<div class="line"><a name="l00014"></a><span class="lineno"><a class="line" href="netlist_2persistent_2netlist__serializer_8cpp.html#a442c4f02c70cb01b96e1d3068b619d20">   14</a></span>&#160;<span class="preprocessor">#define PRETTY_JSON_OUTPUT false</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#if PRETTY_JSON_OUTPUT</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;rapidjson/prettywriter.h&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;rapidjson/writer.h&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &lt;chrono&gt;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &lt;fstream&gt;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &lt;queue&gt;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &lt;sstream&gt;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#ifndef DURATION</span></div>
<div class="line"><a name="l00027"></a><span class="lineno"><a class="line" href="netlist_2persistent_2netlist__serializer_8cpp.html#a2abf3f6130ba2e37b47ff418fe01ec3e">   27</a></span>&#160;<span class="preprocessor">#define DURATION(begin_time) ((double)std::chrono::duration_cast&lt;std::chrono::milliseconds&gt;(std::chrono::high_resolution_clock::now() - begin_time).count() / 1000)</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacehal.html">hal</a></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;{</div>
<div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="namespacehal_1_1netlist__serializer.html">   32</a></span>&#160;    <span class="keyword">namespace </span><a class="code" href="namespacenetlist__serializer.html">netlist_serializer</a></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    {</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        <span class="comment">// serializing functions</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        <span class="keyword">namespace</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        {</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="netlist_2project__manager_8cpp.html#a81307d7817962d3671d54e8e63c37c78">SERIALIZATION_FORMAT_VERSION</a> = 14;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;            <span class="keywordtype">int</span> encoded_format_version;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;            <span class="comment">// Ver 12 : location of gates</span></div>
<div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="netlist_2persistent_2netlist__serializer_8cpp.html#ad9bde63b1c828a1328bf592ad5325fa6">   41</a></span>&#160;<span class="preprocessor">#define JSON_STR_HELPER(x) rapidjson::Value{}.SetString(x.c_str(), x.length(), allocator)</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="netlist_2persistent_2netlist__serializer_8cpp.html#abfdc4ed5873b08e0d4f07d3e287ca2f5">   43</a></span>&#160;<span class="preprocessor">#define assert_availablility(MEMBER)                                                               \</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">    if (!root.HasMember(MEMBER))                                                                   \</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">    {                                                                                              \</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">        log_critical(&quot;netlist_persistent&quot;</span>, &quot;&#39;netlist&#39; node does not include a &#39;{}&#39; node&quot;, MEMBER); \</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        return nullptr;                                                                            \</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    }</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;            <span class="keyword">namespace</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;            {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                <span class="keyword">struct </span>PinGroupInformation</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                    <span class="keyword">struct </span>PinInformation</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                    {</div>
<div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="netlist_2persistent_2netlist__serializer_8cpp.html#ab832d8349a6c8a3927b85c5ada524cb2">   56</a></span>&#160;                        <a class="code" href="defines_8h.html#aec41e5f8e4b7aef2540e84268692fa84">i32</a> <span class="keywordtype">id</span> = -1;</div>
<div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="netlist_2persistent_2netlist__serializer_8cpp.html#a504c73ff1a68c50e5435dece66bc2772">   57</a></span>&#160;                        Net* <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a504c73ff1a68c50e5435dece66bc2772">net</a>;</div>
<div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="netlist_2persistent_2netlist__serializer_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">   58</a></span>&#160;                        std::string <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a>;</div>
<div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="netlist_2persistent_2netlist__serializer_8cpp.html#a05e5f99d786b527ca4a260c21170c5e7">   59</a></span>&#160;                        <a class="code" href="namespacehal.html#ae062cd9848a7ac51bd0bb4d76f1fb94b">PinType</a> <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a05e5f99d786b527ca4a260c21170c5e7">type</a> = <a class="code" href="namespacehal.html#ae062cd9848a7ac51bd0bb4d76f1fb94ba334c4a4c42fdb79d7ebc3e73b517e6f8">PinType::none</a>;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                    };</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                    <a class="code" href="defines_8h.html#aec41e5f8e4b7aef2540e84268692fa84">i32</a> <span class="keywordtype">id</span> = -1;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                    std::string <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a>;</div>
<div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="netlist_2persistent_2netlist__serializer_8cpp.html#a924ab95925fc83b38cba3ac2d8d7e9aa">   64</a></span>&#160;                    <a class="code" href="namespacehal.html#a119eb4e25d047caa41d83e762cbed8ec">PinDirection</a> <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a924ab95925fc83b38cba3ac2d8d7e9aa">direction</a> = <a class="code" href="namespacehal.html#a119eb4e25d047caa41d83e762cbed8eca334c4a4c42fdb79d7ebc3e73b517e6f8">PinDirection::none</a>;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                    <a class="code" href="namespacehal.html#ae062cd9848a7ac51bd0bb4d76f1fb94b">PinType</a> <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a05e5f99d786b527ca4a260c21170c5e7">type</a>           = <a class="code" href="namespacehal.html#ae062cd9848a7ac51bd0bb4d76f1fb94ba334c4a4c42fdb79d7ebc3e73b517e6f8">PinType::none</a>;</div>
<div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="netlist_2persistent_2netlist__serializer_8cpp.html#a1e273622affc5aefcd63c0036e5ce1b9">   66</a></span>&#160;                    std::vector&lt;PinInformation&gt; <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a1e273622affc5aefcd63c0036e5ce1b9">pins</a>;</div>
<div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="netlist_2persistent_2netlist__serializer_8cpp.html#a8ea27602bf4d3ec3850549a2d313ad0c">   67</a></span>&#160;                    <span class="keywordtype">bool</span> <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a8ea27602bf4d3ec3850549a2d313ad0c">ascending</a>  = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="netlist_2persistent_2netlist__serializer_8cpp.html#a75c5aaa50f6193870be97c566b274281">   68</a></span>&#160;                    <a class="code" href="net__layout__point_8h.html#aa7fe0c70576e86ca2c5f641bb47ccc9d">u32</a> <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a75c5aaa50f6193870be97c566b274281">start_index</a> = 0;</div>
<div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="netlist_2persistent_2netlist__serializer_8cpp.html#a40c532d6ba6706818b15b50db4a991fe">   69</a></span>&#160;                    <span class="keywordtype">bool</span> <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a40c532d6ba6706818b15b50db4a991fe">ordered</a>    = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                };</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;            }    <span class="comment">// namespace</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;            <span class="comment">// serialize container data</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;            rapidjson::Value serialize(<span class="keyword">const</span> std::map&lt;std::tuple&lt;std::string, std::string&gt;, std::tuple&lt;std::string, std::string&gt;&gt;&amp; data, rapidjson::Document::AllocatorType&amp; allocator)</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                rapidjson::Value val(rapidjson::kArrayType);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; it : <a class="code" href="namespacehal.html#ae062cd9848a7ac51bd0bb4d76f1fb94ba8d777f385d3dfec8815d20f7496026dc">data</a>)</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                {</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                    rapidjson::Value entry(rapidjson::kArrayType);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                    entry.PushBack(<a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#ad9bde63b1c828a1328bf592ad5325fa6">JSON_STR_HELPER</a>(std::get&lt;0&gt;(it.first)), allocator);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                    entry.PushBack(<a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#ad9bde63b1c828a1328bf592ad5325fa6">JSON_STR_HELPER</a>(std::get&lt;1&gt;(it.first)), allocator);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                    entry.PushBack(<a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#ad9bde63b1c828a1328bf592ad5325fa6">JSON_STR_HELPER</a>(std::get&lt;0&gt;(it.second)), allocator);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                    entry.PushBack(<a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#ad9bde63b1c828a1328bf592ad5325fa6">JSON_STR_HELPER</a>(std::get&lt;1&gt;(it.second)), allocator);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                    val.PushBack(entry, allocator);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                }</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                <span class="keywordflow">return</span> val;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            }</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;            <span class="keywordtype">void</span> deserialize_data(DataContainer* c, <span class="keyword">const</span> rapidjson::Value&amp; val)</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;            {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; entry : val.GetArray())</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                    c-&gt;set_data(entry[0].GetString(), entry[1].GetString(), entry[2].GetString(), entry[3].GetString());</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                }</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;            }</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;            <span class="comment">// serialize endpoint</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            rapidjson::Value serialize(<span class="keyword">const</span> Endpoint* ep, rapidjson::Document::AllocatorType&amp; allocator)</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                rapidjson::Value val(rapidjson::kObjectType);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                val.AddMember(<span class="stringliteral">&quot;gate_id&quot;</span>, ep-&gt;get_gate()-&gt;get_id(), allocator);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                val.AddMember(<span class="stringliteral">&quot;pin_id&quot;</span>, ep-&gt;get_pin()-&gt;get_id(), allocator);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                <span class="keywordflow">return</span> val;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            }</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            <span class="keywordtype">bool</span> deserialize_destination(Netlist* nl, Net* <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a504c73ff1a68c50e5435dece66bc2772">net</a>, <span class="keyword">const</span> rapidjson::Value&amp; val)</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;            {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                <a class="code" href="group__gui.html#ggaab0cd38a41c1215ae70822b1d501daa1ad25b4bd4c72aa2c07ee87adb10b59f16">Gate</a>* gate = nl-&gt;get_gate_by_id(val[<span class="stringliteral">&quot;gate_id&quot;</span>].GetUint());</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                GatePin* pin;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                <span class="keywordflow">if</span> (val.HasMember(<span class="stringliteral">&quot;pin_id&quot;</span>))</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                    <span class="keyword">const</span> <a class="code" href="net__layout__point_8h.html#aa7fe0c70576e86ca2c5f641bb47ccc9d">u32</a> pin_id = val[<span class="stringliteral">&quot;pin_id&quot;</span>].GetUint();</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                    pin              = gate-&gt;get_type()-&gt;get_pin_by_id(pin_id);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                    <span class="keywordflow">if</span> (pin == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                    {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                        <a class="code" href="group__utilities.html#ga522d6d0c8a408128993be37c86656280">log_error</a>(<span class="stringliteral">&quot;netlist_persistent&quot;</span>,</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                                  <span class="stringliteral">&quot;could not deserialize destination of net &#39;&quot;</span> + <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a504c73ff1a68c50e5435dece66bc2772">net</a>-&gt;get_name() + <span class="stringliteral">&quot;&#39; with ID &quot;</span> + std::to_string(<a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a504c73ff1a68c50e5435dece66bc2772">net</a>-&gt;get_id()) + <span class="stringliteral">&quot;: failed to get pin with ID &quot;</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                                      + std::to_string(pin_id));</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                    }</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                    <span class="keywordflow">if</span> (encoded_format_version &lt;= 12)</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                    {</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                        <span class="comment">// swap pins because of legacy pin group bug</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                        <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> [group, index] = pin-&gt;get_group(); group-&gt;size() &gt; 1)</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                        {</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                            <span class="keywordtype">bool</span> <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a8ea27602bf4d3ec3850549a2d313ad0c">ascending</a>   = group-&gt;is_ascending();</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                            <a class="code" href="net__layout__point_8h.html#aa7fe0c70576e86ca2c5f641bb47ccc9d">u32</a> len          = group-&gt;size();</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                            <a class="code" href="defines_8h.html#aec41e5f8e4b7aef2540e84268692fa84">i32</a> <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a75c5aaa50f6193870be97c566b274281">start_index</a>  = group-&gt;get_start_index();</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                            <a class="code" href="defines_8h.html#aec41e5f8e4b7aef2540e84268692fa84">i32</a> end_index    = <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a8ea27602bf4d3ec3850549a2d313ad0c">ascending</a> ? (<a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a75c5aaa50f6193870be97c566b274281">start_index</a> + (<a class="code" href="defines_8h.html#aec41e5f8e4b7aef2540e84268692fa84">i32</a>)len - 1) : (<a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a75c5aaa50f6193870be97c566b274281">start_index</a> - (<a class="code" href="defines_8h.html#aec41e5f8e4b7aef2540e84268692fa84">i32</a>)len + 1);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                            <a class="code" href="defines_8h.html#aec41e5f8e4b7aef2540e84268692fa84">i32</a> target_index = <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a8ea27602bf4d3ec3850549a2d313ad0c">ascending</a> ? (end_index - (index - <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a75c5aaa50f6193870be97c566b274281">start_index</a>)) : (end_index + (<a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a75c5aaa50f6193870be97c566b274281">start_index</a> - index));</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                            <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> pin_res = group-&gt;get_pin_at_index(target_index); pin_res.is_error())</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                            {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                                <a class="code" href="group__utilities.html#ga522d6d0c8a408128993be37c86656280">log_error</a>(<span class="stringliteral">&quot;netlist_persistent&quot;</span>,</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                                          <span class="stringliteral">&quot;could not deserialize destination of net &#39;&quot;</span> + <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a504c73ff1a68c50e5435dece66bc2772">net</a>-&gt;get_name() + <span class="stringliteral">&quot;&#39; with ID &quot;</span> + std::to_string(<a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a504c73ff1a68c50e5435dece66bc2772">net</a>-&gt;get_id()) + <span class="stringliteral">&quot;: failed to swap pin with ID &quot;</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                                              + std::to_string(pin_id) + <span class="stringliteral">&quot;:\n{}&quot;</span>,</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                                          pin_res.get_error().get());</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                            }</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                            {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                                pin = pin_res.get();</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                            }</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                        }</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                    }</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                }</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                    <span class="comment">// legacy code for backward compatibility</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                    <span class="keyword">const</span> std::string pin_name = val[<span class="stringliteral">&quot;pin_type&quot;</span>].GetString();</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                    pin                        = gate-&gt;get_type()-&gt;get_pin_by_name(pin_name);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                    <span class="keywordflow">if</span> (pin == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                    {</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                        <a class="code" href="group__utilities.html#ga522d6d0c8a408128993be37c86656280">log_error</a>(<span class="stringliteral">&quot;netlist_persistent&quot;</span>,</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                                  <span class="stringliteral">&quot;could not deserialize destination of net &#39;&quot;</span> + <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a504c73ff1a68c50e5435dece66bc2772">net</a>-&gt;get_name() + <span class="stringliteral">&quot;&#39; with ID &quot;</span> + std::to_string(<a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a504c73ff1a68c50e5435dece66bc2772">net</a>-&gt;get_id()) + <span class="stringliteral">&quot;: failed to get pin with name &#39;&quot;</span> + pin_name + <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                    }</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                }</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a504c73ff1a68c50e5435dece66bc2772">net</a>-&gt;add_destination(gate, pin))</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                {</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                    <a class="code" href="group__utilities.html#ga522d6d0c8a408128993be37c86656280">log_error</a>(<span class="stringliteral">&quot;netlist_persistent&quot;</span>,</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                              <span class="stringliteral">&quot;could not deserialize destination of net &#39;&quot;</span> + <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a504c73ff1a68c50e5435dece66bc2772">net</a>-&gt;get_name() + <span class="stringliteral">&quot;&#39; with ID &quot;</span> + std::to_string(<a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a504c73ff1a68c50e5435dece66bc2772">net</a>-&gt;get_id()) + <span class="stringliteral">&quot;: failed to add pin &#39;&quot;</span> + pin-&gt;get_name()</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                                  + <span class="stringliteral">&quot;&#39; as destination to net &#39;&quot;</span> + <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a504c73ff1a68c50e5435dece66bc2772">net</a>-&gt;get_name() + <span class="stringliteral">&quot;&#39; with ID &quot;</span> + std::to_string(<a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a504c73ff1a68c50e5435dece66bc2772">net</a>-&gt;get_id()));</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                }</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            }</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            <span class="keywordtype">bool</span> deserialize_source(Netlist* nl, Net* <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a504c73ff1a68c50e5435dece66bc2772">net</a>, <span class="keyword">const</span> rapidjson::Value&amp; val)</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            {</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                <a class="code" href="group__gui.html#ggaab0cd38a41c1215ae70822b1d501daa1ad25b4bd4c72aa2c07ee87adb10b59f16">Gate</a>* gate = nl-&gt;get_gate_by_id(val[<span class="stringliteral">&quot;gate_id&quot;</span>].GetUint());</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                GatePin* pin;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                <span class="keywordflow">if</span> (val.HasMember(<span class="stringliteral">&quot;pin_id&quot;</span>))</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                {</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                    <span class="keyword">const</span> <a class="code" href="net__layout__point_8h.html#aa7fe0c70576e86ca2c5f641bb47ccc9d">u32</a> pin_id = val[<span class="stringliteral">&quot;pin_id&quot;</span>].GetUint();</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                    pin              = gate-&gt;get_type()-&gt;get_pin_by_id(pin_id);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                    <span class="keywordflow">if</span> (pin == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                    {</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                        <a class="code" href="group__utilities.html#ga522d6d0c8a408128993be37c86656280">log_error</a>(<span class="stringliteral">&quot;netlist_persistent&quot;</span>,</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                                  <span class="stringliteral">&quot;could not deserialize source of net &#39;&quot;</span> + <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a504c73ff1a68c50e5435dece66bc2772">net</a>-&gt;get_name() + <span class="stringliteral">&quot;&#39; with ID &quot;</span> + std::to_string(<a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a504c73ff1a68c50e5435dece66bc2772">net</a>-&gt;get_id()) + <span class="stringliteral">&quot;: failed to get pin with ID &quot;</span> + std::to_string(pin_id));</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                    }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                    <span class="keywordflow">if</span> (encoded_format_version &lt;= 12)</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                    {</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                        <span class="comment">// swap pins because of legacy pin group bug</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                        <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> [group, index] = pin-&gt;get_group(); group-&gt;size() &gt; 1)</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                        {</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                            <span class="keywordtype">bool</span> <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a8ea27602bf4d3ec3850549a2d313ad0c">ascending</a>   = group-&gt;is_ascending();</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                            <a class="code" href="net__layout__point_8h.html#aa7fe0c70576e86ca2c5f641bb47ccc9d">u32</a> len          = group-&gt;size();</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                            <a class="code" href="defines_8h.html#aec41e5f8e4b7aef2540e84268692fa84">i32</a> <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a75c5aaa50f6193870be97c566b274281">start_index</a>  = group-&gt;get_start_index();</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                            <a class="code" href="defines_8h.html#aec41e5f8e4b7aef2540e84268692fa84">i32</a> end_index    = <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a8ea27602bf4d3ec3850549a2d313ad0c">ascending</a> ? (<a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a75c5aaa50f6193870be97c566b274281">start_index</a> + (<a class="code" href="defines_8h.html#aec41e5f8e4b7aef2540e84268692fa84">i32</a>)len - 1) : (<a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a75c5aaa50f6193870be97c566b274281">start_index</a> - (<a class="code" href="defines_8h.html#aec41e5f8e4b7aef2540e84268692fa84">i32</a>)len + 1);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                            <a class="code" href="defines_8h.html#aec41e5f8e4b7aef2540e84268692fa84">i32</a> target_index = <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a8ea27602bf4d3ec3850549a2d313ad0c">ascending</a> ? (end_index - (index - <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a75c5aaa50f6193870be97c566b274281">start_index</a>)) : (end_index + (<a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a75c5aaa50f6193870be97c566b274281">start_index</a> - index));</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160; </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                            <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> pin_res = group-&gt;get_pin_at_index(target_index); pin_res.is_error())</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                            {</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                                <a class="code" href="group__utilities.html#ga522d6d0c8a408128993be37c86656280">log_error</a>(<span class="stringliteral">&quot;netlist_persistent&quot;</span>,</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                                          <span class="stringliteral">&quot;could not deserialize source of net &#39;&quot;</span> + <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a504c73ff1a68c50e5435dece66bc2772">net</a>-&gt;get_name() + <span class="stringliteral">&quot;&#39; with ID &quot;</span> + std::to_string(<a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a504c73ff1a68c50e5435dece66bc2772">net</a>-&gt;get_id()) + <span class="stringliteral">&quot;: failed to swap pin with ID &quot;</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                                              + std::to_string(pin_id) + <span class="stringliteral">&quot;:\n{}&quot;</span>,</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                                          pin_res.get_error().get());</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                            }</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                            {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                                pin = pin_res.get();</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                            }</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                        }</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                    }</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                }</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                {</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                    <span class="comment">// legacy code for backward compatibility</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                    <span class="keyword">const</span> std::string pin_name = val[<span class="stringliteral">&quot;pin_type&quot;</span>].GetString();</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                    pin                        = gate-&gt;get_type()-&gt;get_pin_by_name(pin_name);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                    <span class="keywordflow">if</span> (pin == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                    {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                        <a class="code" href="group__utilities.html#ga522d6d0c8a408128993be37c86656280">log_error</a>(<span class="stringliteral">&quot;netlist_persistent&quot;</span>,</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                                  <span class="stringliteral">&quot;could not deserialize source of net &#39;&quot;</span> + <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a504c73ff1a68c50e5435dece66bc2772">net</a>-&gt;get_name() + <span class="stringliteral">&quot;&#39; with ID &quot;</span> + std::to_string(<a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a504c73ff1a68c50e5435dece66bc2772">net</a>-&gt;get_id()) + <span class="stringliteral">&quot;: failed to get pin with name &#39;&quot;</span> + pin_name + <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                    }</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                }</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a504c73ff1a68c50e5435dece66bc2772">net</a>-&gt;add_source(gate, pin) == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                    <a class="code" href="group__utilities.html#ga522d6d0c8a408128993be37c86656280">log_error</a>(<span class="stringliteral">&quot;netlist_persistent&quot;</span>,</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                              <span class="stringliteral">&quot;could not deserialize source of net &#39;&quot;</span> + <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a504c73ff1a68c50e5435dece66bc2772">net</a>-&gt;get_name() + <span class="stringliteral">&quot;&#39; with ID &quot;</span> + std::to_string(<a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a504c73ff1a68c50e5435dece66bc2772">net</a>-&gt;get_id()) + <span class="stringliteral">&quot;: failed to add pin &#39;&quot;</span> + pin-&gt;get_name()</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                                  + <span class="stringliteral">&quot;&#39; as source to net &#39;&quot;</span> + <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a504c73ff1a68c50e5435dece66bc2772">net</a>-&gt;get_name() + <span class="stringliteral">&quot;&#39; with ID &quot;</span> + std::to_string(<a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a504c73ff1a68c50e5435dece66bc2772">net</a>-&gt;get_id()));</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                }</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            }</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            <span class="comment">// serialize gate</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            rapidjson::Value serialize(<span class="keyword">const</span> Gate* gate, rapidjson::Document::AllocatorType&amp; allocator)</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                rapidjson::Value val(rapidjson::kObjectType);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                val.AddMember(<span class="stringliteral">&quot;id&quot;</span>, gate-&gt;get_id(), allocator);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                val.AddMember(<span class="stringliteral">&quot;name&quot;</span>, gate-&gt;get_name(), allocator);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                val.AddMember(<span class="stringliteral">&quot;type&quot;</span>, gate-&gt;get_type()-&gt;get_name(), allocator);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                <span class="keywordflow">if</span> (gate-&gt;has_location())</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                {</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                    val.AddMember(<span class="stringliteral">&quot;location_x&quot;</span>, gate-&gt;get_location_x(), allocator);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                    val.AddMember(<span class="stringliteral">&quot;location_y&quot;</span>, gate-&gt;get_location_y(), allocator);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                }</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                <span class="keyword">auto</span> <a class="code" href="namespacehal.html#ae062cd9848a7ac51bd0bb4d76f1fb94ba8d777f385d3dfec8815d20f7496026dc">data</a> = serialize(gate-&gt;get_data_map(), allocator);</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="namespacehal.html#ae062cd9848a7ac51bd0bb4d76f1fb94ba8d777f385d3dfec8815d20f7496026dc">data</a>.Empty())</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                {</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                    val.AddMember(<span class="stringliteral">&quot;data&quot;</span>, data, allocator);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                }</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                {</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                    rapidjson::Value functions(rapidjson::kObjectType);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [<a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a>, <span class="keyword">function</span>] : gate-&gt;get_boolean_functions(<span class="keyword">true</span>))</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                    {</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                        <span class="keyword">const</span> std::string function_str = <span class="keyword">function</span>.to_string();</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                        functions.AddMember(<a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#ad9bde63b1c828a1328bf592ad5325fa6">JSON_STR_HELPER</a>(<a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a>), <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#ad9bde63b1c828a1328bf592ad5325fa6">JSON_STR_HELPER</a>(function_str), allocator);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                    }</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                    <span class="keywordflow">if</span> (functions.MemberCount() &gt; 0)</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                    {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                        val.AddMember(<span class="stringliteral">&quot;custom_functions&quot;</span>, functions, allocator);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                    }</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                }</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                <span class="keywordflow">return</span> val;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            }</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            <span class="keywordtype">bool</span> deserialize_gate(Netlist* nl, <span class="keyword">const</span> rapidjson::Value&amp; val, <span class="keyword">const</span> std::unordered_map&lt;std::string, hal::GateType*&gt;&amp; gate_types)</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            {</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                <span class="keyword">const</span> <a class="code" href="net__layout__point_8h.html#aa7fe0c70576e86ca2c5f641bb47ccc9d">u32</a> gate_id           = val[<span class="stringliteral">&quot;id&quot;</span>].GetUint();</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                <span class="keyword">const</span> std::string gate_name = val[<span class="stringliteral">&quot;name&quot;</span>].GetString();</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                <span class="keyword">const</span> std::string gate_type = val[<span class="stringliteral">&quot;type&quot;</span>].GetString();</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                <a class="code" href="defines_8h.html#aec41e5f8e4b7aef2540e84268692fa84">i32</a> lx                      = -1;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                <a class="code" href="defines_8h.html#aec41e5f8e4b7aef2540e84268692fa84">i32</a> ly                      = -1;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                <span class="keywordflow">if</span> (val.HasMember(<span class="stringliteral">&quot;location_x&quot;</span>) &amp;&amp; val.HasMember(<span class="stringliteral">&quot;location_y&quot;</span>))</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                {</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                    lx = val[<span class="stringliteral">&quot;location_x&quot;</span>].GetInt();</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                    ly = val[<span class="stringliteral">&quot;location_y&quot;</span>].GetInt();</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                }</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                <span class="keywordflow">if</span> (<span class="keyword">auto</span> it = gate_types.find(gate_type); it != gate_types.end())</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                {</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                    <span class="keyword">auto</span> gate = nl-&gt;create_gate(gate_id, it-&gt;second, gate_name, lx, ly);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                    <span class="keywordflow">if</span> (gate == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                    {</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                        <a class="code" href="group__utilities.html#ga522d6d0c8a408128993be37c86656280">log_error</a>(<span class="stringliteral">&quot;netlist_persistent&quot;</span>, <span class="stringliteral">&quot;could not deserialize gate &#39;&quot;</span> + gate_name + <span class="stringliteral">&quot;&#39; with ID &quot;</span> + std::to_string(gate_id) + <span class="stringliteral">&quot;: failed to create gate&quot;</span>);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                    }</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                    <span class="keywordflow">if</span> (val.HasMember(<span class="stringliteral">&quot;data&quot;</span>))</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                    {</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                        deserialize_data(gate, val[<span class="stringliteral">&quot;data&quot;</span>]);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                    }</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160; </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                    <span class="keywordflow">if</span> (val.HasMember(<span class="stringliteral">&quot;custom_functions&quot;</span>))</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                    {</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                        <span class="keyword">auto</span> functions = val[<span class="stringliteral">&quot;custom_functions&quot;</span>].GetObject();</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                        <span class="keywordflow">for</span> (<span class="keyword">auto</span> f_it = functions.MemberBegin(); f_it != functions.MemberEnd(); ++f_it)</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                        {</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                            <span class="keyword">auto</span> func = <a class="code" href="classhal_1_1_boolean_function.html#a9c83dda09f69fb886f33d792cfb8fa6f">BooleanFunction::from_string</a>(f_it-&gt;value.GetString());</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                            <span class="keywordflow">if</span> (func.is_error())</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                            {</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                                <a class="code" href="group__utilities.html#ga522d6d0c8a408128993be37c86656280">log_error</a>(<span class="stringliteral">&quot;netlist_persistent&quot;</span>,</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                                          <span class="stringliteral">&quot;could not deserialize gate &#39;&quot;</span> + gate_name + <span class="stringliteral">&quot;&#39; with ID &quot;</span> + std::to_string(gate_id) + <span class="stringliteral">&quot;: failed to parse Boolean function from string\n{}&quot;</span>,</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                                          func.get_error().get());</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                            }</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                            gate-&gt;add_boolean_function(f_it-&gt;name.GetString(), func.get());</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                        }</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                    }</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                }</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160; </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                <a class="code" href="group__utilities.html#ga522d6d0c8a408128993be37c86656280">log_error</a>(<span class="stringliteral">&quot;netlist_persistent&quot;</span>,</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                          <span class="stringliteral">&quot;could not deserialize gate &#39;&quot;</span> + gate_name + <span class="stringliteral">&quot;&#39; with ID &quot;</span> + std::to_string(gate_id) + <span class="stringliteral">&quot;: failed to find gate &#39;&quot;</span> + gate_type + <span class="stringliteral">&quot;&#39; in gate library &#39;&quot;</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                              + nl-&gt;get_gate_library()-&gt;get_name() + <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            }</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160; </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;            <span class="comment">// serialize net</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            rapidjson::Value serialize(<span class="keyword">const</span> Net* <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a504c73ff1a68c50e5435dece66bc2772">net</a>, rapidjson::Document::AllocatorType&amp; allocator)</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;            {</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                rapidjson::Value val(rapidjson::kObjectType);</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                val.AddMember(<span class="stringliteral">&quot;id&quot;</span>, <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a504c73ff1a68c50e5435dece66bc2772">net</a>-&gt;get_id(), allocator);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                val.AddMember(<span class="stringliteral">&quot;name&quot;</span>, <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a504c73ff1a68c50e5435dece66bc2772">net</a>-&gt;get_name(), allocator);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160; </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                {</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                    rapidjson::Value srcs(rapidjson::kArrayType);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                    std::vector&lt;Endpoint*&gt; sorted = <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a504c73ff1a68c50e5435dece66bc2772">net</a>-&gt;get_sources();</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                    std::sort(sorted.begin(), sorted.end(), [](Endpoint* lhs, Endpoint* rhs) { return lhs-&gt;get_gate()-&gt;get_id() &lt; rhs-&gt;get_gate()-&gt;get_id(); });</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                    <span class="keywordflow">for</span> (<span class="keyword">const</span> Endpoint* src : sorted)</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                    {</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                        srcs.PushBack(serialize(src, allocator), allocator);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                    }</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                    <span class="keywordflow">if</span> (!srcs.Empty())</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                    {</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                        val.AddMember(<span class="stringliteral">&quot;srcs&quot;</span>, srcs, allocator);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                    }</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                }</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160; </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                {</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                    rapidjson::Value dsts(rapidjson::kArrayType);</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                    std::vector&lt;Endpoint*&gt; sorted = <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a504c73ff1a68c50e5435dece66bc2772">net</a>-&gt;get_destinations();</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                    std::sort(sorted.begin(), sorted.end(), [](Endpoint* lhs, Endpoint* rhs) { return lhs-&gt;get_gate()-&gt;get_id() &lt; rhs-&gt;get_gate()-&gt;get_id(); });</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                    <span class="keywordflow">for</span> (<span class="keyword">const</span> Endpoint* dst : sorted)</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                    {</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                        dsts.PushBack(serialize(dst, allocator), allocator);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                    }</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                    <span class="keywordflow">if</span> (!dsts.Empty())</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                    {</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                        val.AddMember(<span class="stringliteral">&quot;dsts&quot;</span>, dsts, allocator);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                    }</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                }</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160; </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                <span class="keyword">auto</span> <a class="code" href="namespacehal.html#ae062cd9848a7ac51bd0bb4d76f1fb94ba8d777f385d3dfec8815d20f7496026dc">data</a> = serialize(<a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a504c73ff1a68c50e5435dece66bc2772">net</a>-&gt;get_data_map(), allocator);</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="namespacehal.html#ae062cd9848a7ac51bd0bb4d76f1fb94ba8d777f385d3dfec8815d20f7496026dc">data</a>.Empty())</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                {</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                    val.AddMember(<span class="stringliteral">&quot;data&quot;</span>, data, allocator);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                }</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                <span class="keywordflow">return</span> val;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;            }</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;            <span class="keywordtype">bool</span> deserialize_net(Netlist* nl, <span class="keyword">const</span> rapidjson::Value&amp; val)</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;            {</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                <span class="keyword">const</span> <a class="code" href="net__layout__point_8h.html#aa7fe0c70576e86ca2c5f641bb47ccc9d">u32</a> net_id           = val[<span class="stringliteral">&quot;id&quot;</span>].GetUint();</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                <span class="keyword">const</span> std::string net_name = val[<span class="stringliteral">&quot;name&quot;</span>].GetString();</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                <span class="keyword">auto</span> <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a504c73ff1a68c50e5435dece66bc2772">net</a>                   = nl-&gt;create_net(net_id, net_name);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a504c73ff1a68c50e5435dece66bc2772">net</a> == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                {</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                    <a class="code" href="group__utilities.html#ga522d6d0c8a408128993be37c86656280">log_error</a>(<span class="stringliteral">&quot;netlist_persistent&quot;</span>, <span class="stringliteral">&quot;could not deserialize net &#39;&quot;</span> + net_name + <span class="stringliteral">&quot;&#39; with ID &quot;</span> + std::to_string(net_id) + <span class="stringliteral">&quot;: failed to create net&quot;</span>);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                }</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160; </div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                <span class="keywordflow">if</span> (val.HasMember(<span class="stringliteral">&quot;srcs&quot;</span>))</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                {</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; src_node : val[<span class="stringliteral">&quot;srcs&quot;</span>].GetArray())</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                    {</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                        <span class="keywordflow">if</span> (!deserialize_source(nl, <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a504c73ff1a68c50e5435dece66bc2772">net</a>, src_node))</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                        {</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                            <a class="code" href="group__utilities.html#ga522d6d0c8a408128993be37c86656280">log_error</a>(<span class="stringliteral">&quot;netlist_persistent&quot;</span>, <span class="stringliteral">&quot;could not deserialize net &#39;&quot;</span> + net_name + <span class="stringliteral">&quot;&#39; with ID &quot;</span> + std::to_string(net_id) + <span class="stringliteral">&quot;: failed to deserialize source&quot;</span>);</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                        }</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                    }</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                }</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160; </div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                <span class="keywordflow">if</span> (val.HasMember(<span class="stringliteral">&quot;dsts&quot;</span>))</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                {</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; dst_node : val[<span class="stringliteral">&quot;dsts&quot;</span>].GetArray())</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                    {</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                        <span class="keywordflow">if</span> (!deserialize_destination(nl, <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a504c73ff1a68c50e5435dece66bc2772">net</a>, dst_node))</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                        {</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                            <a class="code" href="group__utilities.html#ga522d6d0c8a408128993be37c86656280">log_error</a>(<span class="stringliteral">&quot;netlist_persistent&quot;</span>, <span class="stringliteral">&quot;could not deserialize net &#39;&quot;</span> + net_name + <span class="stringliteral">&quot;&#39; with ID &quot;</span> + std::to_string(net_id) + <span class="stringliteral">&quot;: failed to deserialize destination&quot;</span>);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                        }</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                    }</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                }</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160; </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                <span class="keywordflow">if</span> (val.HasMember(<span class="stringliteral">&quot;data&quot;</span>))</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                {</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                    deserialize_data(<a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a504c73ff1a68c50e5435dece66bc2772">net</a>, val[<span class="stringliteral">&quot;data&quot;</span>]);</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                }</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160; </div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;            }</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160; </div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;            <span class="comment">// serialize module</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;            rapidjson::Value serialize(<span class="keyword">const</span> Module* <a class="code" href="namespacehal_1_1_shortest_path.html#a6f60f4bfa62d51227fa5fcc3e7d838a9">module</a>, rapidjson::Document::AllocatorType&amp; allocator)</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;            {</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                rapidjson::Value val(rapidjson::kObjectType);</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                val.AddMember(<span class="stringliteral">&quot;id&quot;</span>, <a class="code" href="namespacehal_1_1_shortest_path.html#a6f60f4bfa62d51227fa5fcc3e7d838a9">module</a>-&gt;<a class="code" href="classhal_1_1_module.html#af771e486709f93e4abab9f0fe092010b">get_id</a>(), allocator);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                val.AddMember(<span class="stringliteral">&quot;type&quot;</span>, <a class="code" href="namespacehal_1_1_shortest_path.html#a6f60f4bfa62d51227fa5fcc3e7d838a9">module</a>-&gt;<a class="code" href="classhal_1_1_module.html#af2e1a399775172613cc78fcb2d493e3e">get_type</a>(), allocator);</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                val.AddMember(<span class="stringliteral">&quot;name&quot;</span>, <a class="code" href="namespacehal_1_1_shortest_path.html#a6f60f4bfa62d51227fa5fcc3e7d838a9">module</a>-&gt;<a class="code" href="classhal_1_1_module.html#a87cf9f30579e5e461f525ab78274e1df">get_name</a>(), allocator);</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                <a class="code" href="group__gui.html#ggaab0cd38a41c1215ae70822b1d501daa1ae55f75a29310d7b60f7ac1d390c8ae42">Module</a>* parent = <a class="code" href="namespacehal_1_1_shortest_path.html#a6f60f4bfa62d51227fa5fcc3e7d838a9">module</a>-&gt;<a class="code" href="classhal_1_1_module.html#a1af5f0f3f5ea75b8762d65d5fcfab3e3">get_parent_module</a>();</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                <span class="keywordflow">if</span> (parent == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                {</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                    val.AddMember(<span class="stringliteral">&quot;parent&quot;</span>, 0, allocator);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                }</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                {</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                    val.AddMember(<span class="stringliteral">&quot;parent&quot;</span>, parent-&gt;get_id(), allocator);</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                }</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                {</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                    rapidjson::Value gates(rapidjson::kArrayType);</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                    std::vector&lt;Gate*&gt; sorted = <a class="code" href="namespacehal_1_1_shortest_path.html#a6f60f4bfa62d51227fa5fcc3e7d838a9">module</a>-&gt;<a class="code" href="classhal_1_1_module.html#a7a969d9d27d1d5f9ab6b6826b0745085">get_gates</a>(<span class="keyword">nullptr</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                    std::sort(sorted.begin(), sorted.end(), [](Gate* lhs, Gate* rhs) { return lhs-&gt;get_id() &lt; rhs-&gt;get_id(); });</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                    <span class="keywordflow">for</span> (<span class="keyword">const</span> Gate* <a class="code" href="namespacetest__plugin.html#abd3083aec6bd8d3b9851214d6d355740">g</a> : sorted)</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                    {</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                        gates.PushBack(<a class="code" href="namespacetest__plugin.html#abd3083aec6bd8d3b9851214d6d355740">g</a>-&gt;get_id(), allocator);</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                    }</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                    <span class="keywordflow">if</span> (!gates.Empty())</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                    {</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                        val.AddMember(<span class="stringliteral">&quot;gates&quot;</span>, gates, allocator);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                    }</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                }</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                {</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                    rapidjson::Value json_pin_groups(rapidjson::kArrayType);</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                    <span class="keywordflow">for</span> (<span class="keyword">const</span> PinGroup&lt;ModulePin&gt;* pin_group : <a class="code" href="namespacehal_1_1_shortest_path.html#a6f60f4bfa62d51227fa5fcc3e7d838a9">module</a>-&gt;<a class="code" href="classhal_1_1_module.html#acf36f1449ccad8eadd31678f7edcb41a">get_pin_groups</a>())</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                    {</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                        rapidjson::Value json_pin_group(rapidjson::kObjectType);</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                        json_pin_group.AddMember(<span class="stringliteral">&quot;id&quot;</span>, pin_group-&gt;get_id(), allocator);</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                        json_pin_group.AddMember(<span class="stringliteral">&quot;name&quot;</span>, pin_group-&gt;get_name(), allocator);</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                        json_pin_group.AddMember(<span class="stringliteral">&quot;direction&quot;</span>, <a class="code" href="namespacehal.html#afe11c53f9f94ae23527944574e1f5df3">enum_to_string</a>(pin_group-&gt;get_direction()), allocator);</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                        json_pin_group.AddMember(<span class="stringliteral">&quot;type&quot;</span>, <a class="code" href="namespacehal.html#afe11c53f9f94ae23527944574e1f5df3">enum_to_string</a>(pin_group-&gt;get_type()), allocator);</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                        json_pin_group.AddMember(<span class="stringliteral">&quot;ascending&quot;</span>, pin_group-&gt;is_ascending(), allocator);</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                        json_pin_group.AddMember(<span class="stringliteral">&quot;ordered&quot;</span>, pin_group-&gt;is_ordered(), allocator);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                        json_pin_group.AddMember(<span class="stringliteral">&quot;start_index&quot;</span>, pin_group-&gt;get_start_index(), allocator);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                        rapidjson::Value json_pins(rapidjson::kArrayType);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                        <span class="keywordflow">for</span> (<span class="keyword">const</span> ModulePin* pin : pin_group-&gt;get_pins())</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                        {</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                            rapidjson::Value json_pin(rapidjson::kObjectType);</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                            json_pin.AddMember(<span class="stringliteral">&quot;id&quot;</span>, pin-&gt;get_id(), allocator);</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                            json_pin.AddMember(<span class="stringliteral">&quot;name&quot;</span>, pin-&gt;get_name(), allocator);</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                            json_pin.AddMember(<span class="stringliteral">&quot;type&quot;</span>, <a class="code" href="namespacehal.html#afe11c53f9f94ae23527944574e1f5df3">enum_to_string</a>(pin-&gt;get_type()), allocator);</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                            json_pin.AddMember(<span class="stringliteral">&quot;net_id&quot;</span>, pin-&gt;get_net()-&gt;get_id(), allocator);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                            json_pins.PushBack(json_pin, allocator);</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                        }</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                        json_pin_group.AddMember(<span class="stringliteral">&quot;pins&quot;</span>, json_pins, allocator);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                        json_pin_groups.PushBack(json_pin_group, allocator);</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                    }</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                    <span class="keywordflow">if</span> (!json_pin_groups.Empty())</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                    {</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                        val.AddMember(<span class="stringliteral">&quot;pin_groups&quot;</span>, json_pin_groups, allocator);</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                    }</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                }</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160; </div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                <span class="keyword">auto</span> <a class="code" href="namespacehal.html#ae062cd9848a7ac51bd0bb4d76f1fb94ba8d777f385d3dfec8815d20f7496026dc">data</a> = serialize(<a class="code" href="namespacehal_1_1_shortest_path.html#a6f60f4bfa62d51227fa5fcc3e7d838a9">module</a>-&gt;<a class="code" href="classhal_1_1_data_container.html#a1067630aa486e2a76391c0572d263a24">get_data_map</a>(), allocator);</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="namespacehal.html#ae062cd9848a7ac51bd0bb4d76f1fb94ba8d777f385d3dfec8815d20f7496026dc">data</a>.Empty())</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                {</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                    val.AddMember(<span class="stringliteral">&quot;data&quot;</span>, data, allocator);</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                }</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                <span class="keywordflow">return</span> val;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;            }</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160; </div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;            <span class="keywordtype">bool</span> deserialize_module(Netlist* nl, <span class="keyword">const</span> rapidjson::Value&amp; val, std::unordered_map&lt;Module*, std::vector&lt;PinGroupInformation&gt;&gt;&amp; pin_group_cache)</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;            {</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                <span class="keyword">const</span> <a class="code" href="net__layout__point_8h.html#aa7fe0c70576e86ca2c5f641bb47ccc9d">u32</a> module_id           = val[<span class="stringliteral">&quot;id&quot;</span>].GetUint();</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                <span class="keyword">const</span> std::string module_name = val[<span class="stringliteral">&quot;name&quot;</span>].GetString();</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                <span class="keyword">const</span> <a class="code" href="net__layout__point_8h.html#aa7fe0c70576e86ca2c5f641bb47ccc9d">u32</a> parent_id           = val[<span class="stringliteral">&quot;parent&quot;</span>].GetUint();</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                <a class="code" href="group__gui.html#ggaab0cd38a41c1215ae70822b1d501daa1ae55f75a29310d7b60f7ac1d390c8ae42">Module</a>* sm                    = nl-&gt;get_top_module();</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160; </div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                <span class="keywordflow">if</span> (parent_id == 0)</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                {</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                    <span class="comment">// top_module must not be created but might be renamed</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                    <span class="keyword">const</span> std::string top_module_name = val[<span class="stringliteral">&quot;name&quot;</span>].GetString();</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                    <span class="keywordflow">if</span> (top_module_name != sm-&gt;get_name())</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                    {</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                        sm-&gt;set_name(top_module_name);</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                    }</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                }</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                {</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                    sm = nl-&gt;create_module(module_id, module_name, nl-&gt;get_module_by_id(parent_id));</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                    <span class="keywordflow">if</span> (sm == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                    {</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                        <a class="code" href="group__utilities.html#ga522d6d0c8a408128993be37c86656280">log_error</a>(<span class="stringliteral">&quot;netlist_persistent&quot;</span>, <span class="stringliteral">&quot;could not deserialize module &#39;&quot;</span> + module_name + <span class="stringliteral">&quot;&#39; with ID &quot;</span> + std::to_string(module_id) + <span class="stringliteral">&quot;: failed to create module&quot;</span>);</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                    }</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                }</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160; </div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                <span class="keywordflow">if</span> (val.HasMember(<span class="stringliteral">&quot;type&quot;</span>))</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                {</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                    sm-&gt;set_type(val[<span class="stringliteral">&quot;type&quot;</span>].GetString());</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                }</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160; </div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                <span class="keywordflow">if</span> (val.HasMember(<span class="stringliteral">&quot;gates&quot;</span>))</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                {</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                    std::vector&lt;Gate*&gt; gates;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; gate_node : val[<span class="stringliteral">&quot;gates&quot;</span>].GetArray())</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                    {</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                        <span class="keywordflow">if</span> (!sm-&gt;is_top_module())</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                        {</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                            gates.push_back(nl-&gt;get_gate_by_id(gate_node.GetUint()));</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                        }</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                    }</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                    sm-&gt;assign_gates(gates);</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                }</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160; </div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                <span class="keywordflow">if</span> (val.HasMember(<span class="stringliteral">&quot;data&quot;</span>))</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                {</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                    deserialize_data(sm, val[<span class="stringliteral">&quot;data&quot;</span>]);</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                }</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160; </div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                <span class="keywordflow">if</span> (val.HasMember(<span class="stringliteral">&quot;pin_groups&quot;</span>))</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                {</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                    <span class="comment">// pins need to be cached until all modules have been instantiated</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; json_pin_group : val[<span class="stringliteral">&quot;pin_groups&quot;</span>].GetArray())</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                    {</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                        PinGroupInformation pin_group;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                        pin_group.id   = json_pin_group[<span class="stringliteral">&quot;id&quot;</span>].GetUint();</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                        pin_group.name = json_pin_group[<span class="stringliteral">&quot;name&quot;</span>].GetString();</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                        <span class="keywordflow">if</span> (json_pin_group.HasMember(<span class="stringliteral">&quot;direction&quot;</span>))</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                        {</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                            pin_group.direction = enum_from_string&lt;PinDirection&gt;(json_pin_group[<span class="stringliteral">&quot;direction&quot;</span>].GetString());</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                        }</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                        {</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                            pin_group.direction = <a class="code" href="namespacehal.html#a119eb4e25d047caa41d83e762cbed8eca334c4a4c42fdb79d7ebc3e73b517e6f8">PinDirection::none</a>;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                        }</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                        <span class="keywordflow">if</span> (json_pin_group.HasMember(<span class="stringliteral">&quot;type&quot;</span>))</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                        {</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                            pin_group.type = enum_from_string&lt;PinType&gt;(json_pin_group[<span class="stringliteral">&quot;type&quot;</span>].GetString());</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                        }</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                        {</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                            pin_group.type = <a class="code" href="namespacehal.html#ae062cd9848a7ac51bd0bb4d76f1fb94ba334c4a4c42fdb79d7ebc3e73b517e6f8">PinType::none</a>;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                        }</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                        <span class="keywordflow">if</span> (json_pin_group.HasMember(<span class="stringliteral">&quot;ordered&quot;</span>))</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                        {</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                            pin_group.ordered = json_pin_group[<span class="stringliteral">&quot;ordered&quot;</span>].GetBool();</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                        }</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                        {</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                            pin_group.type = <a class="code" href="namespacehal.html#ae062cd9848a7ac51bd0bb4d76f1fb94ba334c4a4c42fdb79d7ebc3e73b517e6f8">PinType::none</a>;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                        }</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                        pin_group.ascending   = json_pin_group[<span class="stringliteral">&quot;ascending&quot;</span>].GetBool();</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                        pin_group.start_index = json_pin_group[<span class="stringliteral">&quot;start_index&quot;</span>].GetUint();</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160; </div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; pin_node : json_pin_group[<span class="stringliteral">&quot;pins&quot;</span>].GetArray())</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                        {</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                            PinGroupInformation::PinInformation pin;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                            pin.id   = pin_node[<span class="stringliteral">&quot;id&quot;</span>].GetUint();</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                            pin.name = pin_node[<span class="stringliteral">&quot;name&quot;</span>].GetString();</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                            pin.net  = nl-&gt;get_net_by_id(pin_node[<span class="stringliteral">&quot;net_id&quot;</span>].GetUint());</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;                            pin.type = enum_from_string&lt;PinType&gt;(pin_node[<span class="stringliteral">&quot;type&quot;</span>].GetString());</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                            pin_group.pins.push_back(pin);</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                        }</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                        pin_group_cache[sm].push_back(pin_group);</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                    }</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                }</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160; </div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                <span class="comment">// legacy code below</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                <span class="keywordflow">if</span> (val.HasMember(<span class="stringliteral">&quot;input_ports&quot;</span>))</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                {</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; json_pin_legacy : val[<span class="stringliteral">&quot;input_ports&quot;</span>].GetArray())</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                    {</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                        PinGroupInformation pin_group;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                        pin_group.name = json_pin_legacy[<span class="stringliteral">&quot;port_name&quot;</span>].GetString();</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                        PinGroupInformation::PinInformation pin;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;                        pin.name = json_pin_legacy[<span class="stringliteral">&quot;port_name&quot;</span>].GetString();</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;                        pin.net  = nl-&gt;get_net_by_id(json_pin_legacy[<span class="stringliteral">&quot;net_id&quot;</span>].GetUint());</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                        pin_group.pins.push_back(pin);</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;                        pin_group_cache[sm].push_back(pin_group);</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                    }</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                }</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160; </div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                <span class="keywordflow">if</span> (val.HasMember(<span class="stringliteral">&quot;output_ports&quot;</span>))</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                {</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;                    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; json_pin_legacy : val[<span class="stringliteral">&quot;output_ports&quot;</span>].GetArray())</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;                    {</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                        PinGroupInformation pin_group;</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                        pin_group.name = json_pin_legacy[<span class="stringliteral">&quot;port_name&quot;</span>].GetString();</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                        PinGroupInformation::PinInformation pin;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                        pin.name = json_pin_legacy[<span class="stringliteral">&quot;port_name&quot;</span>].GetString();</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                        pin.net  = nl-&gt;get_net_by_id(json_pin_legacy[<span class="stringliteral">&quot;net_id&quot;</span>].GetUint());</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                        pin_group.pins.push_back(pin);</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                        pin_group_cache[sm].push_back(pin_group);</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                    }</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                }</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                <span class="comment">// legacy code above</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160; </div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;            }</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160; </div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;            <span class="keywordtype">bool</span> deserialize_module_pins(<span class="keyword">const</span> std::unordered_map&lt;Module*, std::vector&lt;PinGroupInformation&gt;&gt;&amp; pin_group_cache)</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;            {</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [sm, pin_groups] : pin_group_cache)</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                {</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                    <span class="keywordflow">for</span> (<span class="keyword">const</span> PinGroupInformation&amp; pg : pin_groups)</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                    {</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                        std::vector&lt;ModulePin*&gt; <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a1e273622affc5aefcd63c0036e5ce1b9">pins</a>;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                        <span class="keywordflow">for</span> (<span class="keyword">const</span> PinGroupInformation::PinInformation&amp; p : pg.pins)</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                        {</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                            <a class="code" href="net__layout__point_8h.html#aa7fe0c70576e86ca2c5f641bb47ccc9d">u32</a> pid = (p.id &gt; 0) ? (<a class="code" href="net__layout__point_8h.html#aa7fe0c70576e86ca2c5f641bb47ccc9d">u32</a>)p.id : sm-&gt;get_unique_pin_id();</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                            <span class="keywordflow">if</span> (<span class="keyword">auto</span> res = sm-&gt;create_pin(pid, p.name, p.net, p.type, <span class="keyword">false</span>); res.is_error())</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                            {</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                                <a class="code" href="group__utilities.html#ga522d6d0c8a408128993be37c86656280">log_error</a>(<span class="stringliteral">&quot;netlist_persistent&quot;</span>,</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                                          <span class="stringliteral">&quot;could not deserialize pin &#39;&quot;</span> + p.name + <span class="stringliteral">&quot;&#39; of module &#39;&quot;</span> + sm-&gt;get_name() + <span class="stringliteral">&quot;&#39; with ID &quot;</span> + std::to_string(sm-&gt;get_id()) + <span class="stringliteral">&quot;: failed to create pin\n{}&quot;</span>,</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                                          res.get_error().get());</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                            }</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                            {</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                                <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a1e273622affc5aefcd63c0036e5ce1b9">pins</a>.push_back(res.get());</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                            }</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                        }</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                        <a class="code" href="net__layout__point_8h.html#aa7fe0c70576e86ca2c5f641bb47ccc9d">u32</a> pgid = (pg.id &gt; 0) ? (<a class="code" href="net__layout__point_8h.html#aa7fe0c70576e86ca2c5f641bb47ccc9d">u32</a>)pg.id : sm-&gt;get_unique_pin_group_id();</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                        <span class="keywordflow">if</span> (<span class="keyword">auto</span> res = sm-&gt;create_pin_group(pgid, pg.name, <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a1e273622affc5aefcd63c0036e5ce1b9">pins</a>, pg.direction, pg.type, pg.ascending, pg.start_index, pg.ordered); res.is_error())</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                        {</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                            <a class="code" href="group__utilities.html#ga522d6d0c8a408128993be37c86656280">log_error</a>(<span class="stringliteral">&quot;netlist_persistent&quot;</span>,</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                                      <span class="stringliteral">&quot;could not deserialize pin group &#39;&quot;</span> + pg.name + <span class="stringliteral">&quot;&#39; of module &#39;&quot;</span> + sm-&gt;get_name() + <span class="stringliteral">&quot;&#39; with ID &quot;</span> + std::to_string(sm-&gt;get_id())</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                                          + <span class="stringliteral">&quot;: failed to create pin group\n{}&quot;</span>,</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                                      res.get_error().get());</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                        }</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                    }</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                }</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;            }</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160; </div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;            <span class="comment">// serialize netlist</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;            <span class="keywordtype">void</span> serialize(<span class="keyword">const</span> Netlist* nl, rapidjson::Document&amp; document)</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;            {</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                rapidjson::Document::AllocatorType&amp; allocator = document.GetAllocator();</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                rapidjson::Value root(rapidjson::kObjectType);</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160; </div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                root.AddMember(<span class="stringliteral">&quot;gate_library&quot;</span>, nl-&gt;get_gate_library()-&gt;get_path().string(), allocator);</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                root.AddMember(<span class="stringliteral">&quot;id&quot;</span>, nl-&gt;get_id(), allocator);</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                root.AddMember(<span class="stringliteral">&quot;input_file&quot;</span>, nl-&gt;get_input_filename().string(), allocator);</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                root.AddMember(<span class="stringliteral">&quot;design_name&quot;</span>, nl-&gt;get_design_name(), allocator);</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                root.AddMember(<span class="stringliteral">&quot;device_name&quot;</span>, nl-&gt;get_device_name(), allocator);</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160; </div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                {</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                    rapidjson::Value gates(rapidjson::kArrayType);</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                    rapidjson::Value global_vccs(rapidjson::kArrayType);</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                    rapidjson::Value global_gnds(rapidjson::kArrayType);</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                    std::vector&lt;Gate*&gt; sorted = nl-&gt;get_gates();</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                    std::sort(sorted.begin(), sorted.end(), [](Gate* lhs, Gate* rhs) { return lhs-&gt;get_id() &lt; rhs-&gt;get_id(); });</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                    <span class="keywordflow">for</span> (<span class="keyword">const</span> Gate* gate : sorted)</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                    {</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                        gates.PushBack(serialize(gate, allocator), allocator);</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160; </div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                        <span class="keywordflow">if</span> (nl-&gt;is_gnd_gate(gate))</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                        {</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                            global_gnds.PushBack(gate-&gt;get_id(), allocator);</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                        }</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160; </div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                        <span class="keywordflow">if</span> (nl-&gt;is_vcc_gate(gate))</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                        {</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                            global_vccs.PushBack(gate-&gt;get_id(), allocator);</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                        }</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                    }</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                    root.AddMember(<span class="stringliteral">&quot;gates&quot;</span>, gates, allocator);</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                    root.AddMember(<span class="stringliteral">&quot;global_vcc&quot;</span>, global_vccs, allocator);</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                    root.AddMember(<span class="stringliteral">&quot;global_gnd&quot;</span>, global_gnds, allocator);</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                }</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                {</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                    rapidjson::Value nets(rapidjson::kArrayType);</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                    rapidjson::Value global_in(rapidjson::kArrayType);</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                    rapidjson::Value global_out(rapidjson::kArrayType);</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                    std::vector&lt;Net*&gt; sorted = nl-&gt;get_nets();</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                    std::sort(sorted.begin(), sorted.end(), [](Net* lhs, Net* rhs) { return lhs-&gt;get_id() &lt; rhs-&gt;get_id(); });</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                    <span class="keywordflow">for</span> (<span class="keyword">const</span> Net* <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a504c73ff1a68c50e5435dece66bc2772">net</a> : sorted)</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                    {</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                        nets.PushBack(serialize(<a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a504c73ff1a68c50e5435dece66bc2772">net</a>, allocator), allocator);</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160; </div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                        <span class="keywordflow">if</span> (nl-&gt;is_global_input_net(<a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a504c73ff1a68c50e5435dece66bc2772">net</a>))</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                        {</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                            global_in.PushBack(<a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a504c73ff1a68c50e5435dece66bc2772">net</a>-&gt;get_id(), allocator);</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                        }</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160; </div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                        <span class="keywordflow">if</span> (nl-&gt;is_global_output_net(<a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a504c73ff1a68c50e5435dece66bc2772">net</a>))</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                        {</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                            global_out.PushBack(<a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a504c73ff1a68c50e5435dece66bc2772">net</a>-&gt;get_id(), allocator);</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                        }</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                    }</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                    root.AddMember(<span class="stringliteral">&quot;nets&quot;</span>, nets, allocator);</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                    root.AddMember(<span class="stringliteral">&quot;global_in&quot;</span>, global_in, allocator);</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                    root.AddMember(<span class="stringliteral">&quot;global_out&quot;</span>, global_out, allocator);</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                }</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;                {</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                    rapidjson::Value modules(rapidjson::kArrayType);</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160; </div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                    <span class="comment">// module ids are not sorted to preserve hierarchy</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                    std::queue&lt;const Module*&gt; q;</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                    q.push(nl-&gt;get_top_module());</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                    <span class="keywordflow">while</span> (!q.empty())</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                    {</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;                        <span class="keyword">const</span> <a class="code" href="group__gui.html#ggaab0cd38a41c1215ae70822b1d501daa1ae55f75a29310d7b60f7ac1d390c8ae42">Module</a>* <a class="code" href="namespacehal_1_1_shortest_path.html#a6f60f4bfa62d51227fa5fcc3e7d838a9">module</a> = q.front();</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                        q.pop();</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160; </div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                        modules.PushBack(serialize(<a class="code" href="namespacehal_1_1_shortest_path.html#a6f60f4bfa62d51227fa5fcc3e7d838a9">module</a>, allocator), allocator);</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160; </div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                        <span class="keywordflow">for</span> (<span class="keyword">const</span> Module* sm : <a class="code" href="namespacehal_1_1_shortest_path.html#a6f60f4bfa62d51227fa5fcc3e7d838a9">module</a>-&gt;<a class="code" href="classhal_1_1_module.html#af1256fe9a3080693b07d7e657d9a31ba">get_submodules</a>())</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                        {</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                            q.push(sm);</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                        }</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                    }</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                    root.AddMember(<span class="stringliteral">&quot;modules&quot;</span>, modules, allocator);</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                }</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160; </div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                document.AddMember(<span class="stringliteral">&quot;netlist&quot;</span>, root, document.GetAllocator());</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;            }</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160; </div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;            std::unique_ptr&lt;Netlist&gt; deserialize(<span class="keyword">const</span> rapidjson::Document&amp; document, GateLibrary* gatelib)</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;            {</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                <span class="keywordflow">if</span> (!document.HasMember(<span class="stringliteral">&quot;netlist&quot;</span>))</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                {</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                    <a class="code" href="group__utilities.html#ga522d6d0c8a408128993be37c86656280">log_error</a>(<span class="stringliteral">&quot;netlist_persistent&quot;</span>, <span class="stringliteral">&quot;could not deserialize netlist: file has no &#39;netlist&#39; node&quot;</span>);</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                }</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                <span class="keyword">auto</span> root = document[<span class="stringliteral">&quot;netlist&quot;</span>].GetObject();</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160; </div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                <span class="keywordflow">if</span> (!gatelib)</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                {</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                    <span class="comment">// no preferred gate library explicitly given</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                    <span class="keywordflow">if</span> (!root.HasMember(<span class="stringliteral">&quot;gate_library&quot;</span>))</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                    {</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                        <a class="code" href="group__utilities.html#ga522d6d0c8a408128993be37c86656280">log_error</a>(<span class="stringliteral">&quot;netlist_persistent&quot;</span>, <span class="stringliteral">&quot;could not deserialize netlist: node &#39;netlist&#39; has no node &#39;gate_library&#39;&quot;</span>);</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                    }</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160; </div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                    std::filesystem::path glib_path(root[<span class="stringliteral">&quot;gate_library&quot;</span>].GetString());</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160; </div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;                    <span class="keywordflow">if</span> (glib_path.is_relative())</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                    {</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                        ProjectManager* pm = <a class="code" href="classhal_1_1_project_manager.html#a07a891ec8dc22c3657274aefcd0248ca">ProjectManager::instance</a>();</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;                        <span class="keywordflow">if</span> (pm)</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                            glib_path = pm-&gt;get_project_directory() / glib_path;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                    }</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                    gatelib = <a class="code" href="namespacehal_1_1gate__library__manager.html#a99efc94447f62ce59b3aea6409c46d14">gate_library_manager::get_gate_library</a>(glib_path.string());</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160; </div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                    <span class="keywordflow">if</span> (gatelib == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                    {</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                        <span class="comment">// not found : try the other possible gate library extension</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                        <span class="keywordflow">if</span> (glib_path.extension() == <span class="stringliteral">&quot;.hgl&quot;</span>)</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                        {</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                            glib_path.replace_extension(<span class="stringliteral">&quot;.lib&quot;</span>);</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                        }</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                        {</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                            glib_path.replace_extension(<span class="stringliteral">&quot;.hgl&quot;</span>);</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                        }</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160; </div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                        gatelib = <a class="code" href="namespacehal_1_1gate__library__manager.html#a99efc94447f62ce59b3aea6409c46d14">gate_library_manager::get_gate_library</a>(glib_path.string());</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                        <span class="keywordflow">if</span> (gatelib == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                        {</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                            <a class="code" href="group__utilities.html#ga9f09e61a5832ae08b39fde17dc9e04ce">log_critical</a>(<span class="stringliteral">&quot;netlist_persistent&quot;</span>, <span class="stringliteral">&quot;could not deserialize netlist: failed to load gate library &#39;&quot;</span> + std::string(root[<span class="stringliteral">&quot;gate_library&quot;</span>].GetString()) + <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                            <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                        }</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                        {</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                            <a class="code" href="group__utilities.html#ga5a10e8bbe0ebf932e114b116b32d7ed2">log_info</a>(<span class="stringliteral">&quot;netlist_persistent&quot;</span>, <span class="stringliteral">&quot;gate library &#39;{}&#39; required but using &#39;{}&#39; instead.&quot;</span>, root[<span class="stringliteral">&quot;gate_library&quot;</span>].GetString(), glib_path.string());</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                        }</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                    }</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                }</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160; </div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                <span class="keyword">auto</span> nl = std::make_unique&lt;Netlist&gt;(gatelib);</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160; </div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                <span class="comment">// disable automatically checking module nets</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                nl-&gt;enable_automatic_net_checks(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160; </div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                <span class="keywordflow">if</span> (!root.HasMember(<span class="stringliteral">&quot;id&quot;</span>))</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                {</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                    <a class="code" href="group__utilities.html#ga522d6d0c8a408128993be37c86656280">log_error</a>(<span class="stringliteral">&quot;netlist_persistent&quot;</span>, <span class="stringliteral">&quot;could not deserialize netlist: node &#39;netlist&#39; has no node &#39;id&#39;&quot;</span>);</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                }</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                nl-&gt;set_id(root[<span class="stringliteral">&quot;id&quot;</span>].GetUint());</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160; </div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                <span class="keywordflow">if</span> (!root.HasMember(<span class="stringliteral">&quot;input_file&quot;</span>))</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                {</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                    <a class="code" href="group__utilities.html#ga522d6d0c8a408128993be37c86656280">log_error</a>(<span class="stringliteral">&quot;netlist_persistent&quot;</span>, <span class="stringliteral">&quot;could not deserialize netlist: node &#39;netlist&#39; has no node &#39;input_file&#39;&quot;</span>);</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                }</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                nl-&gt;set_input_filename(root[<span class="stringliteral">&quot;input_file&quot;</span>].GetString());</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160; </div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                <span class="keywordflow">if</span> (!root.HasMember(<span class="stringliteral">&quot;design_name&quot;</span>))</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                {</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                    <a class="code" href="group__utilities.html#ga522d6d0c8a408128993be37c86656280">log_error</a>(<span class="stringliteral">&quot;netlist_persistent&quot;</span>, <span class="stringliteral">&quot;could not deserialize netlist: node &#39;netlist&#39; has no node &#39;design_name&#39;&quot;</span>);</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                }</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                nl-&gt;set_design_name(root[<span class="stringliteral">&quot;design_name&quot;</span>].GetString());</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160; </div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                <span class="keywordflow">if</span> (!root.HasMember(<span class="stringliteral">&quot;device_name&quot;</span>))</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;                {</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;                    <a class="code" href="group__utilities.html#ga522d6d0c8a408128993be37c86656280">log_error</a>(<span class="stringliteral">&quot;netlist_persistent&quot;</span>, <span class="stringliteral">&quot;could not deserialize netlist: node &#39;netlist&#39; has no node &#39;device_name&#39;&quot;</span>);</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;                }</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;                nl-&gt;set_device_name(root[<span class="stringliteral">&quot;device_name&quot;</span>].GetString());</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160; </div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                <span class="keywordflow">if</span> (!root.HasMember(<span class="stringliteral">&quot;gates&quot;</span>))</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                {</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;                    <a class="code" href="group__utilities.html#ga522d6d0c8a408128993be37c86656280">log_error</a>(<span class="stringliteral">&quot;netlist_persistent&quot;</span>, <span class="stringliteral">&quot;could not deserialize netlist: node &#39;netlist&#39; has no node &#39;gates&#39;&quot;</span>);</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;                }</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                <span class="keyword">auto</span> gate_types = nl-&gt;get_gate_library()-&gt;get_gate_types();</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; gate_node : root[<span class="stringliteral">&quot;gates&quot;</span>].GetArray())</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                {</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                    <span class="keywordflow">if</span> (!deserialize_gate(nl.get(), gate_node, gate_types))</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                    {</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                        <a class="code" href="group__utilities.html#ga522d6d0c8a408128993be37c86656280">log_error</a>(<span class="stringliteral">&quot;netlist_persistent&quot;</span>, <span class="stringliteral">&quot;could not deserialize netlist: failed to deserialize gate&quot;</span>);</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;                        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;                    }</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;                }</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160; </div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;                <span class="keywordflow">if</span> (!root.HasMember(<span class="stringliteral">&quot;global_vcc&quot;</span>))</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                {</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;                    <a class="code" href="group__utilities.html#ga522d6d0c8a408128993be37c86656280">log_error</a>(<span class="stringliteral">&quot;netlist_persistent&quot;</span>, <span class="stringliteral">&quot;could not deserialize netlist: node &#39;netlist&#39; has no node &#39;global_vcc&#39;&quot;</span>);</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;                }</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; gate_node : root[<span class="stringliteral">&quot;global_vcc&quot;</span>].GetArray())</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;                {</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;                    <span class="keywordflow">if</span> (!nl-&gt;mark_vcc_gate(nl-&gt;get_gate_by_id(gate_node.GetUint())))</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;                    {</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;                        <a class="code" href="group__utilities.html#ga522d6d0c8a408128993be37c86656280">log_error</a>(<span class="stringliteral">&quot;netlist_persistent&quot;</span>, <span class="stringliteral">&quot;could not deserialize netlist: failed to mark VCC gate&quot;</span>);</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;                        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;                    }</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;                }</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160; </div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                <span class="keywordflow">if</span> (!root.HasMember(<span class="stringliteral">&quot;global_gnd&quot;</span>))</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                {</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                    <a class="code" href="group__utilities.html#ga522d6d0c8a408128993be37c86656280">log_error</a>(<span class="stringliteral">&quot;netlist_persistent&quot;</span>, <span class="stringliteral">&quot;could not deserialize netlist: node &#39;netlist&#39; has no node &#39;global_gnd&#39;&quot;</span>);</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                }</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; gate_node : root[<span class="stringliteral">&quot;global_gnd&quot;</span>].GetArray())</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;                {</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;                    <span class="keywordflow">if</span> (!nl-&gt;mark_gnd_gate(nl-&gt;get_gate_by_id(gate_node.GetUint())))</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                    {</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                        <a class="code" href="group__utilities.html#ga522d6d0c8a408128993be37c86656280">log_error</a>(<span class="stringliteral">&quot;netlist_persistent&quot;</span>, <span class="stringliteral">&quot;could not deserialize netlist: failed to mark GND gate&quot;</span>);</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;                        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                    }</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                }</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160; </div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;                <span class="keywordflow">if</span> (!root.HasMember(<span class="stringliteral">&quot;nets&quot;</span>))</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                {</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                    <a class="code" href="group__utilities.html#ga522d6d0c8a408128993be37c86656280">log_error</a>(<span class="stringliteral">&quot;netlist_persistent&quot;</span>, <span class="stringliteral">&quot;could not deserialize netlist: node &#39;netlist&#39; has no node &#39;nets&#39;&quot;</span>);</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;                }</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; net_node : root[<span class="stringliteral">&quot;nets&quot;</span>].GetArray())</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;                {</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                    <span class="keywordflow">if</span> (!deserialize_net(nl.get(), net_node))</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                    {</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                        <a class="code" href="group__utilities.html#ga522d6d0c8a408128993be37c86656280">log_error</a>(<span class="stringliteral">&quot;netlist_persistent&quot;</span>, <span class="stringliteral">&quot;could not deserialize netlist: failed to deserialize net&quot;</span>);</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                    }</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;                }</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160; </div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                <span class="keywordflow">if</span> (!root.HasMember(<span class="stringliteral">&quot;global_in&quot;</span>))</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;                {</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;                    <a class="code" href="group__utilities.html#ga522d6d0c8a408128993be37c86656280">log_error</a>(<span class="stringliteral">&quot;netlist_persistent&quot;</span>, <span class="stringliteral">&quot;could not deserialize netlist: node &#39;netlist&#39; has no node &#39;global_in&#39;&quot;</span>);</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                }</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; net_node : root[<span class="stringliteral">&quot;global_in&quot;</span>].GetArray())</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                {</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;                    <span class="keywordflow">if</span> (!nl-&gt;mark_global_input_net(nl-&gt;get_net_by_id(net_node.GetUint())))</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;                    {</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;                        <a class="code" href="group__utilities.html#ga522d6d0c8a408128993be37c86656280">log_error</a>(<span class="stringliteral">&quot;netlist_persistent&quot;</span>, <span class="stringliteral">&quot;could not deserialize netlist: failed to mark global input net&quot;</span>);</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;                        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;                    }</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;                }</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160; </div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;                <span class="keywordflow">if</span> (!root.HasMember(<span class="stringliteral">&quot;global_out&quot;</span>))</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;                {</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;                    <a class="code" href="group__utilities.html#ga522d6d0c8a408128993be37c86656280">log_error</a>(<span class="stringliteral">&quot;netlist_persistent&quot;</span>, <span class="stringliteral">&quot;could not deserialize netlist: node &#39;netlist&#39; has no node &#39;global_out&#39;&quot;</span>);</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;                }</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; net_node : root[<span class="stringliteral">&quot;global_out&quot;</span>].GetArray())</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;                {</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;                    <span class="keywordflow">if</span> (!nl-&gt;mark_global_output_net(nl-&gt;get_net_by_id(net_node.GetUint())))</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;                    {</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;                        <a class="code" href="group__utilities.html#ga522d6d0c8a408128993be37c86656280">log_error</a>(<span class="stringliteral">&quot;netlist_persistent&quot;</span>, <span class="stringliteral">&quot;could not deserialize netlist: failed to mark global output net&quot;</span>);</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;                        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;                    }</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;                }</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160; </div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;                <span class="keywordflow">if</span> (!root.HasMember(<span class="stringliteral">&quot;modules&quot;</span>))</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;                {</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;                    <a class="code" href="group__utilities.html#ga522d6d0c8a408128993be37c86656280">log_error</a>(<span class="stringliteral">&quot;netlist_persistent&quot;</span>, <span class="stringliteral">&quot;could not deserialize netlist: node &#39;netlist&#39; has no node &#39;modules&#39;&quot;</span>);</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;                }</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                std::unordered_map&lt;Module*, std::vector&lt;PinGroupInformation&gt;&gt; pin_group_cache;</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; module_node : root[<span class="stringliteral">&quot;modules&quot;</span>].GetArray())</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;                {</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                    <span class="keywordflow">if</span> (!deserialize_module(nl.get(), module_node, pin_group_cache))</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                    {</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                        <a class="code" href="group__utilities.html#ga522d6d0c8a408128993be37c86656280">log_error</a>(<span class="stringliteral">&quot;netlist_persistent&quot;</span>, <span class="stringliteral">&quot;could not deserialize netlist: failed to deserialize module&quot;</span>);</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                    }</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                }</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160; </div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                <span class="comment">// update module nets, internal nets, input nets, and output nets</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                <span class="keywordflow">for</span> (Module* mod : nl-&gt;get_modules())</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                {</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                    mod-&gt;update_nets();</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                }</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160; </div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;                <span class="comment">// load module pins (nets must have been updated beforehand)</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;                <span class="keywordflow">if</span> (!deserialize_module_pins(pin_group_cache))</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;                {</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;                    <a class="code" href="group__utilities.html#ga522d6d0c8a408128993be37c86656280">log_error</a>(<span class="stringliteral">&quot;netlist_persistent&quot;</span>, <span class="stringliteral">&quot;could not deserialize netlist: failed to deserialize module pins&quot;</span>);</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;                }</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160; </div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;                <span class="comment">// re-enable automatically checking module nets</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;                nl-&gt;enable_automatic_net_checks(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160; </div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;                <span class="keywordflow">return</span> nl;</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;            }</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160; </div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;            std::unique_ptr&lt;Netlist&gt; deserialize_document(rapidjson::Document&amp; document, GateLibrary* gatelib, std::string <a class="code" href="_apache_01_license_8txt.html#a40e859b9aaa2d8657227ee008c8a6c7b">source</a>,</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                                                          std::chrono::time_point&lt;std::chrono::high_resolution_clock&gt;&amp; begin_time)</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;            {</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;                <span class="keywordflow">if</span> (document.HasParseError())</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;                {</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                    <a class="code" href="group__utilities.html#ga522d6d0c8a408128993be37c86656280">log_error</a>(<span class="stringliteral">&quot;netlist_persistent&quot;</span>, <span class="stringliteral">&quot;invalid json string for deserialization&quot;</span>);</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;                }</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160; </div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                <span class="keywordflow">if</span> (document.HasMember(<span class="stringliteral">&quot;serialization_format_version&quot;</span>))</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                {</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                    encoded_format_version = document[<span class="stringliteral">&quot;serialization_format_version&quot;</span>].GetUint();</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;                    <span class="keywordflow">if</span> (encoded_format_version &lt; <a class="code" href="netlist_2project__manager_8cpp.html#a81307d7817962d3671d54e8e63c37c78">SERIALIZATION_FORMAT_VERSION</a>)</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;                    {</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;                        <a class="code" href="group__utilities.html#gaccc921ec8323d53efb57a21a8d4be735">log_warning</a>(<span class="stringliteral">&quot;netlist_persistent&quot;</span>, <span class="stringliteral">&quot;the netlist was serialized with an older version of the serializer, deserialization may contain errors.&quot;</span>);</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                    }</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (encoded_format_version &gt; <a class="code" href="netlist_2project__manager_8cpp.html#a81307d7817962d3671d54e8e63c37c78">SERIALIZATION_FORMAT_VERSION</a>)</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;                    {</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;                        <a class="code" href="group__utilities.html#gaccc921ec8323d53efb57a21a8d4be735">log_warning</a>(<span class="stringliteral">&quot;netlist_persistent&quot;</span>, <span class="stringliteral">&quot;the netlist was serialized with a newer version of the serializer, deserialization may contain errors.&quot;</span>);</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;                    }</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;                }</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;                {</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;                    <a class="code" href="group__utilities.html#gaccc921ec8323d53efb57a21a8d4be735">log_warning</a>(<span class="stringliteral">&quot;netlist_persistent&quot;</span>, <span class="stringliteral">&quot;the netlist was serialized with an older version of the serializer, deserialization may contain errors.&quot;</span>);</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;                }</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160; </div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;                <span class="keyword">auto</span> <a class="code" href="namespacetest__multiple.html#aca3deff7ab8749c592308be75680f1e1">netlist</a> = deserialize(document, gatelib);</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160; </div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="namespacetest__multiple.html#aca3deff7ab8749c592308be75680f1e1">netlist</a>)</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;                {</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                    <a class="code" href="group__utilities.html#ga5a10e8bbe0ebf932e114b116b32d7ed2">log_info</a>(<span class="stringliteral">&quot;netlist_persistent&quot;</span>, <span class="stringliteral">&quot;deserialized &#39;{}&#39; in {:2.2f} seconds&quot;</span>, <a class="code" href="_apache_01_license_8txt.html#a40e859b9aaa2d8657227ee008c8a6c7b">source</a>, <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a2abf3f6130ba2e37b47ff418fe01ec3e">DURATION</a>(begin_time));</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;                }</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160; </div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;                <span class="comment">// event_controls::enable_all(true);</span></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="namespacetest__multiple.html#aca3deff7ab8749c592308be75680f1e1">netlist</a>;</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;            }</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160; </div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;        }    <span class="comment">// namespace</span></div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160; </div>
<div class="line"><a name="l00970"></a><span class="lineno"><a class="line" href="namespacehal_1_1netlist__serializer.html#a71a6e82f53ef9ed518f35c56f396e838">  970</a></span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="namespacehal_1_1netlist__serializer.html#a71a6e82f53ef9ed518f35c56f396e838">serialize_to_file</a>(<span class="keyword">const</span> <a class="code" href="classhal_1_1_netlist.html">Netlist</a>* nl, <span class="keyword">const</span> std::filesystem::path&amp; hal_file)</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;        {</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;            <span class="keywordflow">if</span> (nl == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;            {</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;            }</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160; </div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;            <span class="keyword">auto</span> begin_time = std::chrono::high_resolution_clock::now();</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160; </div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;            std::filesystem::path serialize_to_dir = hal_file.parent_path();</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;            <span class="keywordflow">if</span> (serialize_to_dir.empty())</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160; </div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;            <span class="keywordflow">if</span> (serialize_to_dir.is_relative())</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;                serialize_to_dir = <a class="code" href="classhal_1_1_project_manager.html#a07a891ec8dc22c3657274aefcd0248ca">ProjectManager::instance</a>()-&gt;<a class="code" href="classhal_1_1_project_manager.html#aa0b4d568444acf0e8ede1bfc5b7175a5">get_project_directory</a>() / serialize_to_dir;</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160; </div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;            <span class="comment">// create directory if it got erased in the meantime</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;            <span class="keywordflow">if</span> (!std::filesystem::exists(serialize_to_dir))</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;            {</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;                <a class="code" href="namespacehal.html#a12b4c436625fa7f009bc4e5015e5e01c">std::error_code</a> err;</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;                <span class="keywordflow">if</span> (!std::filesystem::create_directories(serialize_to_dir, err))</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;                {</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;                    <a class="code" href="group__utilities.html#ga522d6d0c8a408128993be37c86656280">log_error</a>(<span class="stringliteral">&quot;netlist_persistent&quot;</span>, <span class="stringliteral">&quot;Could not create directory &#39;{}&#39;, error was &#39;{}&#39;.&quot;</span>, serialize_to_dir.string(), err.message());</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;                }</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;            }</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160; </div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;            std::ofstream hal_file_stream;</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;            hal_file_stream.open(hal_file.string());</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;            <span class="keywordflow">if</span> (hal_file_stream.fail())</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;            {</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;                <a class="code" href="group__utilities.html#ga522d6d0c8a408128993be37c86656280">log_error</a>(<span class="stringliteral">&quot;netlist_persistent&quot;</span>, <span class="stringliteral">&quot;could not open or create file {}: please verify that the file and the containing directory is writable&quot;</span>, hal_file.string());</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;            }</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160; </div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;            rapidjson::Document document;</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;            document.SetObject();</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160; </div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;            document.AddMember(<span class="stringliteral">&quot;serialization_format_version&quot;</span>, <a class="code" href="netlist_2project__manager_8cpp.html#a81307d7817962d3671d54e8e63c37c78">SERIALIZATION_FORMAT_VERSION</a>, document.GetAllocator());</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160; </div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;            serialize(nl, document);</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160; </div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;            rapidjson::StringBuffer strbuf;</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="preprocessor">#if PRETTY_JSON_OUTPUT == 1</span></div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;            rapidjson::PrettyWriter&lt;rapidjson::StringBuffer&gt; writer(strbuf);</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;            rapidjson::Writer&lt;rapidjson::StringBuffer&gt; writer(strbuf);</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;            document.Accept(writer);</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160; </div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;            hal_file_stream &lt;&lt; strbuf.GetString();</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160; </div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;            hal_file_stream.close();</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160; </div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;            <a class="code" href="group__utilities.html#ga5a10e8bbe0ebf932e114b116b32d7ed2">log_info</a>(<span class="stringliteral">&quot;netlist_persistent&quot;</span>, <span class="stringliteral">&quot;serialized netlist in {:2.2f} seconds&quot;</span>, <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a2abf3f6130ba2e37b47ff418fe01ec3e">DURATION</a>(begin_time));</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160; </div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;        }</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160; </div>
<div class="line"><a name="l01029"></a><span class="lineno"><a class="line" href="namespacehal_1_1netlist__serializer.html#af3335bf7ed9163c5fd585811fa213ab2"> 1029</a></span>&#160;        std::unique_ptr&lt;Netlist&gt; <a class="code" href="namespacehal_1_1netlist__serializer.html#af3335bf7ed9163c5fd585811fa213ab2">deserialize_from_file</a>(<span class="keyword">const</span> std::filesystem::path&amp; hal_file, <a class="code" href="classhal_1_1_gate_library.html">GateLibrary</a>* gatelib)</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;        {</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;            <span class="keyword">auto</span> begin_time = std::chrono::high_resolution_clock::now();</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160; </div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;            <span class="comment">// event_controls::enable_all(false);</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160; </div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;            FILE* pFile = fopen(hal_file.string().c_str(), <span class="stringliteral">&quot;rb&quot;</span>);</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;            <span class="keywordflow">if</span> (pFile == NULL)</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;            {</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;                <a class="code" href="group__utilities.html#ga522d6d0c8a408128993be37c86656280">log_error</a>(<span class="stringliteral">&quot;netlist_persistent&quot;</span>, <span class="stringliteral">&quot;unable to open &#39;{}&#39;.&quot;</span>, hal_file.string());</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;            }</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160; </div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;            <span class="keywordtype">char</span> buffer[65536];</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;            rapidjson::FileReadStream is(pFile, buffer, <span class="keyword">sizeof</span>(buffer));</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;            rapidjson::Document document;</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;            document.ParseStream&lt;0, rapidjson::UTF8&lt;&gt;, rapidjson::FileReadStream&gt;(is);</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;            fclose(pFile);</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160; </div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;            <span class="keywordflow">return</span> deserialize_document(document, gatelib, hal_file.string(), begin_time);</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;        }</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160; </div>
<div class="line"><a name="l01051"></a><span class="lineno"><a class="line" href="namespacehal_1_1netlist__serializer.html#adab393c4f4d35b9a8d00ab719239a377"> 1051</a></span>&#160;        std::unique_ptr&lt;Netlist&gt; <a class="code" href="namespacehal_1_1netlist__serializer.html#adab393c4f4d35b9a8d00ab719239a377">deserialize_from_string</a>(<span class="keyword">const</span> std::string&amp; hal_string, <a class="code" href="classhal_1_1_gate_library.html">GateLibrary</a>* gatelib)</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;        {</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;            <span class="keyword">auto</span> begin_time = std::chrono::high_resolution_clock::now();</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160; </div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;            <span class="comment">// event_controls::enable_all(false);</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160; </div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;            rapidjson::Document document;</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;            document.Parse&lt;0, rapidjson::UTF8&lt;&gt; &gt;(hal_string.c_str());</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160; </div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;            <span class="keywordflow">return</span> deserialize_document(document, gatelib, <span class="stringliteral">&quot;source string&quot;</span>, begin_time);</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;        }</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;    }    <span class="comment">// namespace netlist_serializer</span></div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;}    <span class="comment">// namespace hal</span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160; </div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;<span class="preprocessor">#undef DURATION</span></div>
<div class="ttc" id="a_apache_01_license_8txt_html_a40e859b9aaa2d8657227ee008c8a6c7b"><div class="ttname"><a href="_apache_01_license_8txt.html#a40e859b9aaa2d8657227ee008c8a6c7b">source</a></div><div class="ttdeci">Apache License January AND DISTRIBUTION Definitions License shall mean the terms and conditions for and distribution as defined by Sections through of this document Licensor shall mean the copyright owner or entity authorized by the copyright owner that is granting the License Legal Entity shall mean the union of the acting entity and all other entities that control are controlled by or are under common control with that entity For the purposes of this definition control direct or to cause the direction or management of such whether by contract or including but not limited to software source documentation source</div><div class="ttdef"><b>Definition:</b> <a href="_apache_01_license_8txt_source.html#l00028">Apache License.txt:28</a></div></div>
<div class="ttc" id="aboolean__function_8h_html"><div class="ttname"><a href="boolean__function_8h.html">boolean_function.h</a></div></div>
<div class="ttc" id="aclasshal_1_1_boolean_function_html_a9c83dda09f69fb886f33d792cfb8fa6f"><div class="ttname"><a href="classhal_1_1_boolean_function.html#a9c83dda09f69fb886f33d792cfb8fa6f">hal::BooleanFunction::from_string</a></div><div class="ttdeci">static Result&lt; BooleanFunction &gt; from_string(const std::string &amp;expression)</div><div class="ttdef"><b>Definition:</b> <a href="netlist_2boolean__function_8cpp_source.html#l01047">boolean_function.cpp:1047</a></div></div>
<div class="ttc" id="aclasshal_1_1_data_container_html_a1067630aa486e2a76391c0572d263a24"><div class="ttname"><a href="classhal_1_1_data_container.html#a1067630aa486e2a76391c0572d263a24">hal::DataContainer::get_data_map</a></div><div class="ttdeci">const std::map&lt; std::tuple&lt; std::string, std::string &gt;, std::tuple&lt; std::string, std::string &gt; &gt; &amp; get_data_map() const</div><div class="ttdef"><b>Definition:</b> <a href="netlist_2data__container_8cpp_source.html#l00072">data_container.cpp:72</a></div></div>
<div class="ttc" id="aclasshal_1_1_gate_library_html"><div class="ttname"><a href="classhal_1_1_gate_library.html">hal::GateLibrary</a></div><div class="ttdef"><b>Definition:</b> <a href="gate__library_8h_source.html#l00043">gate_library.h:44</a></div></div>
<div class="ttc" id="aclasshal_1_1_module_html_a1af5f0f3f5ea75b8762d65d5fcfab3e3"><div class="ttname"><a href="classhal_1_1_module.html#a1af5f0f3f5ea75b8762d65d5fcfab3e3">hal::Module::get_parent_module</a></div><div class="ttdeci">Module * get_parent_module() const</div><div class="ttdef"><b>Definition:</b> <a href="netlist_2module_8cpp_source.html#l00125">module.cpp:125</a></div></div>
<div class="ttc" id="aclasshal_1_1_module_html_a7a969d9d27d1d5f9ab6b6826b0745085"><div class="ttname"><a href="classhal_1_1_module.html#a7a969d9d27d1d5f9ab6b6826b0745085">hal::Module::get_gates</a></div><div class="ttdeci">const std::vector&lt; Gate * &gt; &amp; get_gates() const</div><div class="ttdef"><b>Definition:</b> <a href="netlist_2module_8cpp_source.html#l00391">module.cpp:391</a></div></div>
<div class="ttc" id="aclasshal_1_1_module_html_a87cf9f30579e5e461f525ab78274e1df"><div class="ttname"><a href="classhal_1_1_module.html#a87cf9f30579e5e461f525ab78274e1df">hal::Module::get_name</a></div><div class="ttdeci">std::string get_name() const</div><div class="ttdef"><b>Definition:</b> <a href="netlist_2module_8cpp_source.html#l00087">module.cpp:87</a></div></div>
<div class="ttc" id="aclasshal_1_1_module_html_acf36f1449ccad8eadd31678f7edcb41a"><div class="ttname"><a href="classhal_1_1_module.html#acf36f1449ccad8eadd31678f7edcb41a">hal::Module::get_pin_groups</a></div><div class="ttdeci">std::vector&lt; PinGroup&lt; ModulePin &gt; * &gt; get_pin_groups(const std::function&lt; bool(PinGroup&lt; ModulePin &gt; *)&gt; &amp;filter=nullptr) const</div><div class="ttdef"><b>Definition:</b> <a href="netlist_2module_8cpp_source.html#l00962">module.cpp:962</a></div></div>
<div class="ttc" id="aclasshal_1_1_module_html_af1256fe9a3080693b07d7e657d9a31ba"><div class="ttname"><a href="classhal_1_1_module.html#af1256fe9a3080693b07d7e657d9a31ba">hal::Module::get_submodules</a></div><div class="ttdeci">std::vector&lt; Module * &gt; get_submodules(const std::function&lt; bool(Module *)&gt; &amp;filter=nullptr, bool recursive=false) const</div><div class="ttdef"><b>Definition:</b> <a href="netlist_2module_8cpp_source.html#l00259">module.cpp:259</a></div></div>
<div class="ttc" id="aclasshal_1_1_module_html_af2e1a399775172613cc78fcb2d493e3e"><div class="ttname"><a href="classhal_1_1_module.html#af2e1a399775172613cc78fcb2d493e3e">hal::Module::get_type</a></div><div class="ttdeci">std::string get_type() const</div><div class="ttdef"><b>Definition:</b> <a href="netlist_2module_8cpp_source.html#l00106">module.cpp:106</a></div></div>
<div class="ttc" id="aclasshal_1_1_module_html_af771e486709f93e4abab9f0fe092010b"><div class="ttname"><a href="classhal_1_1_module.html#af771e486709f93e4abab9f0fe092010b">hal::Module::get_id</a></div><div class="ttdeci">u32 get_id() const</div><div class="ttdef"><b>Definition:</b> <a href="netlist_2module_8cpp_source.html#l00082">module.cpp:82</a></div></div>
<div class="ttc" id="aclasshal_1_1_netlist_html"><div class="ttname"><a href="classhal_1_1_netlist.html">hal::Netlist</a></div><div class="ttdef"><b>Definition:</b> <a href="include_2hal__core_2netlist_2netlist_8h_source.html#l00055">netlist.h:56</a></div></div>
<div class="ttc" id="aclasshal_1_1_project_manager_html_a07a891ec8dc22c3657274aefcd0248ca"><div class="ttname"><a href="classhal_1_1_project_manager.html#a07a891ec8dc22c3657274aefcd0248ca">hal::ProjectManager::instance</a></div><div class="ttdeci">static ProjectManager * instance()</div><div class="ttdef"><b>Definition:</b> <a href="netlist_2project__manager_8cpp_source.html#l00037">project_manager.cpp:37</a></div></div>
<div class="ttc" id="aclasshal_1_1_project_manager_html_aa0b4d568444acf0e8ede1bfc5b7175a5"><div class="ttname"><a href="classhal_1_1_project_manager.html#aa0b4d568444acf0e8ede1bfc5b7175a5">hal::ProjectManager::get_project_directory</a></div><div class="ttdeci">const ProjectDirectory &amp; get_project_directory() const</div><div class="ttdef"><b>Definition:</b> <a href="netlist_2project__manager_8cpp_source.html#l00091">project_manager.cpp:91</a></div></div>
<div class="ttc" id="adefines_8h_html_aec41e5f8e4b7aef2540e84268692fa84"><div class="ttname"><a href="defines_8h.html#aec41e5f8e4b7aef2540e84268692fa84">i32</a></div><div class="ttdeci">int32_t i32</div><div class="ttdef"><b>Definition:</b> <a href="defines_8h_source.html#l00036">defines.h:36</a></div></div>
<div class="ttc" id="agate_8h_html"><div class="ttname"><a href="gate_8h.html">gate.h</a></div></div>
<div class="ttc" id="agate__library__manager_8h_html"><div class="ttname"><a href="gate__library__manager_8h.html">gate_library_manager.h</a></div></div>
<div class="ttc" id="agroup__gui_html_ggaab0cd38a41c1215ae70822b1d501daa1ad25b4bd4c72aa2c07ee87adb10b59f16"><div class="ttname"><a href="group__gui.html#ggaab0cd38a41c1215ae70822b1d501daa1ad25b4bd4c72aa2c07ee87adb10b59f16">hal::ItemType::Gate</a></div><div class="ttdeci">@ Gate</div></div>
<div class="ttc" id="agroup__gui_html_ggaab0cd38a41c1215ae70822b1d501daa1ae55f75a29310d7b60f7ac1d390c8ae42"><div class="ttname"><a href="group__gui.html#ggaab0cd38a41c1215ae70822b1d501daa1ae55f75a29310d7b60f7ac1d390c8ae42">hal::ItemType::Module</a></div><div class="ttdeci">@ Module</div></div>
<div class="ttc" id="agroup__utilities_html_ga522d6d0c8a408128993be37c86656280"><div class="ttname"><a href="group__utilities.html#ga522d6d0c8a408128993be37c86656280">log_error</a></div><div class="ttdeci">#define log_error(channel,...)</div><div class="ttdef"><b>Definition:</b> <a href="log_8h_source.html#l00078">log.h:78</a></div></div>
<div class="ttc" id="agroup__utilities_html_ga5a10e8bbe0ebf932e114b116b32d7ed2"><div class="ttname"><a href="group__utilities.html#ga5a10e8bbe0ebf932e114b116b32d7ed2">log_info</a></div><div class="ttdeci">#define log_info(channel,...)</div><div class="ttdef"><b>Definition:</b> <a href="log_8h_source.html#l00070">log.h:70</a></div></div>
<div class="ttc" id="agroup__utilities_html_ga9f09e61a5832ae08b39fde17dc9e04ce"><div class="ttname"><a href="group__utilities.html#ga9f09e61a5832ae08b39fde17dc9e04ce">log_critical</a></div><div class="ttdeci">#define log_critical(channel,...)</div><div class="ttdef"><b>Definition:</b> <a href="log_8h_source.html#l00080">log.h:80</a></div></div>
<div class="ttc" id="agroup__utilities_html_gaccc921ec8323d53efb57a21a8d4be735"><div class="ttname"><a href="group__utilities.html#gaccc921ec8323d53efb57a21a8d4be735">log_warning</a></div><div class="ttdeci">#define log_warning(channel,...)</div><div class="ttdef"><b>Definition:</b> <a href="log_8h_source.html#l00076">log.h:76</a></div></div>
<div class="ttc" id="ainclude_2hal__core_2netlist_2netlist_8h_html"><div class="ttname"><a href="include_2hal__core_2netlist_2netlist_8h.html">netlist.h</a></div></div>
<div class="ttc" id="alog_8h_html"><div class="ttname"><a href="log_8h.html">log.h</a></div></div>
<div class="ttc" id="amodule_8h_html"><div class="ttname"><a href="module_8h.html">module.h</a></div></div>
<div class="ttc" id="anamespacehal_1_1_shortest_path_html_a6f60f4bfa62d51227fa5fcc3e7d838a9"><div class="ttname"><a href="namespacehal_1_1_shortest_path.html#a6f60f4bfa62d51227fa5fcc3e7d838a9">hal::ShortestPath::module</a></div><div class="ttdeci">const Module * module(const Gate *g, const NodeBoxes &amp;boxes)</div><div class="ttdef"><b>Definition:</b> <a href="graph__graphics__view_8cpp_source.html#l00747">graph_graphics_view.cpp:747</a></div></div>
<div class="ttc" id="anamespacehal_1_1gate__library__manager_html_a99efc94447f62ce59b3aea6409c46d14"><div class="ttname"><a href="namespacehal_1_1gate__library__manager.html#a99efc94447f62ce59b3aea6409c46d14">hal::gate_library_manager::get_gate_library</a></div><div class="ttdeci">GateLibrary * get_gate_library(const std::string &amp;file_path)</div><div class="ttdef"><b>Definition:</b> <a href="netlist_2gate__library_2gate__library__manager_8cpp_source.html#l00175">gate_library_manager.cpp:175</a></div></div>
<div class="ttc" id="anamespacehal_1_1netlist__serializer_html_a71a6e82f53ef9ed518f35c56f396e838"><div class="ttname"><a href="namespacehal_1_1netlist__serializer.html#a71a6e82f53ef9ed518f35c56f396e838">hal::netlist_serializer::serialize_to_file</a></div><div class="ttdeci">bool serialize_to_file(const Netlist *nl, const std::filesystem::path &amp;hal_file)</div><div class="ttdef"><b>Definition:</b> <a href="netlist_2persistent_2netlist__serializer_8cpp_source.html#l00970">netlist_serializer.cpp:970</a></div></div>
<div class="ttc" id="anamespacehal_1_1netlist__serializer_html_adab393c4f4d35b9a8d00ab719239a377"><div class="ttname"><a href="namespacehal_1_1netlist__serializer.html#adab393c4f4d35b9a8d00ab719239a377">hal::netlist_serializer::deserialize_from_string</a></div><div class="ttdeci">std::unique_ptr&lt; Netlist &gt; deserialize_from_string(const std::string &amp;hal_string, GateLibrary *gatelib)</div><div class="ttdef"><b>Definition:</b> <a href="netlist_2persistent_2netlist__serializer_8cpp_source.html#l01051">netlist_serializer.cpp:1051</a></div></div>
<div class="ttc" id="anamespacehal_1_1netlist__serializer_html_af3335bf7ed9163c5fd585811fa213ab2"><div class="ttname"><a href="namespacehal_1_1netlist__serializer.html#af3335bf7ed9163c5fd585811fa213ab2">hal::netlist_serializer::deserialize_from_file</a></div><div class="ttdeci">std::unique_ptr&lt; Netlist &gt; deserialize_from_file(const std::filesystem::path &amp;hal_file, GateLibrary *gatelib)</div><div class="ttdef"><b>Definition:</b> <a href="netlist_2persistent_2netlist__serializer_8cpp_source.html#l01029">netlist_serializer.cpp:1029</a></div></div>
<div class="ttc" id="anamespacehal_html"><div class="ttname"><a href="namespacehal.html">hal</a></div><div class="ttdef"><b>Definition:</b> <a href="parser__liberty_8cpp_source.html#l00009">parser_liberty.cpp:10</a></div></div>
<div class="ttc" id="anamespacehal_html_a119eb4e25d047caa41d83e762cbed8ec"><div class="ttname"><a href="namespacehal.html#a119eb4e25d047caa41d83e762cbed8ec">hal::PinDirection</a></div><div class="ttdeci">PinDirection</div><div class="ttdef"><b>Definition:</b> <a href="pin__direction_8h_source.html#l00035">pin_direction.h:36</a></div></div>
<div class="ttc" id="anamespacehal_html_a119eb4e25d047caa41d83e762cbed8eca334c4a4c42fdb79d7ebc3e73b517e6f8"><div class="ttname"><a href="namespacehal.html#a119eb4e25d047caa41d83e762cbed8eca334c4a4c42fdb79d7ebc3e73b517e6f8">hal::PinDirection::none</a></div><div class="ttdeci">@ none</div></div>
<div class="ttc" id="anamespacehal_html_a12b4c436625fa7f009bc4e5015e5e01c"><div class="ttname"><a href="namespacehal.html#a12b4c436625fa7f009bc4e5015e5e01c">hal::error_code</a></div><div class="ttdeci">std::error_code error_code</div><div class="ttdef"><b>Definition:</b> <a href="defines_8h_source.html#l00046">defines.h:46</a></div></div>
<div class="ttc" id="anamespacehal_html_ae062cd9848a7ac51bd0bb4d76f1fb94b"><div class="ttname"><a href="namespacehal.html#ae062cd9848a7ac51bd0bb4d76f1fb94b">hal::PinType</a></div><div class="ttdeci">PinType</div><div class="ttdef"><b>Definition:</b> <a href="pin__type_8h_source.html#l00035">pin_type.h:36</a></div></div>
<div class="ttc" id="anamespacehal_html_ae062cd9848a7ac51bd0bb4d76f1fb94ba334c4a4c42fdb79d7ebc3e73b517e6f8"><div class="ttname"><a href="namespacehal.html#ae062cd9848a7ac51bd0bb4d76f1fb94ba334c4a4c42fdb79d7ebc3e73b517e6f8">hal::PinType::none</a></div><div class="ttdeci">@ none</div></div>
<div class="ttc" id="anamespacehal_html_ae062cd9848a7ac51bd0bb4d76f1fb94ba8d777f385d3dfec8815d20f7496026dc"><div class="ttname"><a href="namespacehal.html#ae062cd9848a7ac51bd0bb4d76f1fb94ba8d777f385d3dfec8815d20f7496026dc">hal::PinType::data</a></div><div class="ttdeci">@ data</div></div>
<div class="ttc" id="anamespacehal_html_afe11c53f9f94ae23527944574e1f5df3"><div class="ttname"><a href="namespacehal.html#afe11c53f9f94ae23527944574e1f5df3">hal::enum_to_string</a></div><div class="ttdeci">std::string enum_to_string(T e)</div><div class="ttdef"><b>Definition:</b> <a href="enums_8h_source.html#l00052">enums.h:52</a></div></div>
<div class="ttc" id="anamespacenetlist__serializer_html"><div class="ttname"><a href="namespacenetlist__serializer.html">netlist_serializer</a></div></div>
<div class="ttc" id="anamespacetest__multiple_html_aca3deff7ab8749c592308be75680f1e1"><div class="ttname"><a href="namespacetest__multiple.html#aca3deff7ab8749c592308be75680f1e1">test_multiple.netlist</a></div><div class="ttdeci">netlist</div><div class="ttdef"><b>Definition:</b> <a href="test__multiple_8py_source.html#l00027">test_multiple.py:27</a></div></div>
<div class="ttc" id="anamespacetest__plugin_html_abd3083aec6bd8d3b9851214d6d355740"><div class="ttname"><a href="namespacetest__plugin.html#abd3083aec6bd8d3b9851214d6d355740">test_plugin.g</a></div><div class="ttdeci">g</div><div class="ttdef"><b>Definition:</b> <a href="test__plugin_8py_source.html#l00032">test_plugin.py:32</a></div></div>
<div class="ttc" id="anet_8h_html"><div class="ttname"><a href="net_8h.html">net.h</a></div></div>
<div class="ttc" id="anet__layout__point_8h_html_aa7fe0c70576e86ca2c5f641bb47ccc9d"><div class="ttname"><a href="net__layout__point_8h.html#aa7fe0c70576e86ca2c5f641bb47ccc9d">u32</a></div><div class="ttdeci">quint32 u32</div><div class="ttdef"><b>Definition:</b> <a href="net__layout__point_8h_source.html#l00040">net_layout_point.h:40</a></div></div>
<div class="ttc" id="anetlist_2persistent_2netlist__serializer_8cpp_html_a05e5f99d786b527ca4a260c21170c5e7"><div class="ttname"><a href="netlist_2persistent_2netlist__serializer_8cpp.html#a05e5f99d786b527ca4a260c21170c5e7">type</a></div><div class="ttdeci">PinType type</div><div class="ttdef"><b>Definition:</b> <a href="netlist_2persistent_2netlist__serializer_8cpp_source.html#l00059">netlist_serializer.cpp:59</a></div></div>
<div class="ttc" id="anetlist_2persistent_2netlist__serializer_8cpp_html_a1e273622affc5aefcd63c0036e5ce1b9"><div class="ttname"><a href="netlist_2persistent_2netlist__serializer_8cpp.html#a1e273622affc5aefcd63c0036e5ce1b9">pins</a></div><div class="ttdeci">std::vector&lt; PinInformation &gt; pins</div><div class="ttdef"><b>Definition:</b> <a href="netlist_2persistent_2netlist__serializer_8cpp_source.html#l00066">netlist_serializer.cpp:66</a></div></div>
<div class="ttc" id="anetlist_2persistent_2netlist__serializer_8cpp_html_a2abf3f6130ba2e37b47ff418fe01ec3e"><div class="ttname"><a href="netlist_2persistent_2netlist__serializer_8cpp.html#a2abf3f6130ba2e37b47ff418fe01ec3e">DURATION</a></div><div class="ttdeci">#define DURATION(begin_time)</div><div class="ttdef"><b>Definition:</b> <a href="netlist_2persistent_2netlist__serializer_8cpp_source.html#l00027">netlist_serializer.cpp:27</a></div></div>
<div class="ttc" id="anetlist_2persistent_2netlist__serializer_8cpp_html_a40c532d6ba6706818b15b50db4a991fe"><div class="ttname"><a href="netlist_2persistent_2netlist__serializer_8cpp.html#a40c532d6ba6706818b15b50db4a991fe">ordered</a></div><div class="ttdeci">bool ordered</div><div class="ttdef"><b>Definition:</b> <a href="netlist_2persistent_2netlist__serializer_8cpp_source.html#l00069">netlist_serializer.cpp:69</a></div></div>
<div class="ttc" id="anetlist_2persistent_2netlist__serializer_8cpp_html_a504c73ff1a68c50e5435dece66bc2772"><div class="ttname"><a href="netlist_2persistent_2netlist__serializer_8cpp.html#a504c73ff1a68c50e5435dece66bc2772">net</a></div><div class="ttdeci">Net * net</div><div class="ttdef"><b>Definition:</b> <a href="netlist_2persistent_2netlist__serializer_8cpp_source.html#l00057">netlist_serializer.cpp:57</a></div></div>
<div class="ttc" id="anetlist_2persistent_2netlist__serializer_8cpp_html_a75c5aaa50f6193870be97c566b274281"><div class="ttname"><a href="netlist_2persistent_2netlist__serializer_8cpp.html#a75c5aaa50f6193870be97c566b274281">start_index</a></div><div class="ttdeci">u32 start_index</div><div class="ttdef"><b>Definition:</b> <a href="netlist_2persistent_2netlist__serializer_8cpp_source.html#l00068">netlist_serializer.cpp:68</a></div></div>
<div class="ttc" id="anetlist_2persistent_2netlist__serializer_8cpp_html_a8ea27602bf4d3ec3850549a2d313ad0c"><div class="ttname"><a href="netlist_2persistent_2netlist__serializer_8cpp.html#a8ea27602bf4d3ec3850549a2d313ad0c">ascending</a></div><div class="ttdeci">bool ascending</div><div class="ttdef"><b>Definition:</b> <a href="netlist_2persistent_2netlist__serializer_8cpp_source.html#l00067">netlist_serializer.cpp:67</a></div></div>
<div class="ttc" id="anetlist_2persistent_2netlist__serializer_8cpp_html_a924ab95925fc83b38cba3ac2d8d7e9aa"><div class="ttname"><a href="netlist_2persistent_2netlist__serializer_8cpp.html#a924ab95925fc83b38cba3ac2d8d7e9aa">direction</a></div><div class="ttdeci">PinDirection direction</div><div class="ttdef"><b>Definition:</b> <a href="netlist_2persistent_2netlist__serializer_8cpp_source.html#l00064">netlist_serializer.cpp:64</a></div></div>
<div class="ttc" id="anetlist_2persistent_2netlist__serializer_8cpp_html_a9b45b3e13bd9167aab02e17e08916231"><div class="ttname"><a href="netlist_2persistent_2netlist__serializer_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a></div><div class="ttdeci">std::string name</div><div class="ttdef"><b>Definition:</b> <a href="netlist_2persistent_2netlist__serializer_8cpp_source.html#l00058">netlist_serializer.cpp:58</a></div></div>
<div class="ttc" id="anetlist_2persistent_2netlist__serializer_8cpp_html_ad9bde63b1c828a1328bf592ad5325fa6"><div class="ttname"><a href="netlist_2persistent_2netlist__serializer_8cpp.html#ad9bde63b1c828a1328bf592ad5325fa6">JSON_STR_HELPER</a></div><div class="ttdeci">#define JSON_STR_HELPER(x)</div><div class="ttdef"><b>Definition:</b> <a href="netlist_2persistent_2netlist__serializer_8cpp_source.html#l00041">netlist_serializer.cpp:41</a></div></div>
<div class="ttc" id="anetlist_2project__manager_8cpp_html_a81307d7817962d3671d54e8e63c37c78"><div class="ttname"><a href="netlist_2project__manager_8cpp.html#a81307d7817962d3671d54e8e63c37c78">SERIALIZATION_FORMAT_VERSION</a></div><div class="ttdeci">const int SERIALIZATION_FORMAT_VERSION</div><div class="ttdef"><b>Definition:</b> <a href="netlist_2project__manager_8cpp_source.html#l00024">project_manager.cpp:24</a></div></div>
<div class="ttc" id="anetlist__serializer_8h_html"><div class="ttname"><a href="netlist__serializer_8h.html">netlist_serializer.h</a></div></div>
<div class="ttc" id="aproject__manager_8h_html"><div class="ttname"><a href="project__manager_8h.html">project_manager.h</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_2b1fe3a00210b132c6a6c3a6780f4f6e.html">netlist</a></li><li class="navelem"><a class="el" href="dir_f6f96dce44487d3d8542a38135ce2374.html">persistent</a></li><li class="navelem"><a class="el" href="netlist_2persistent_2netlist__serializer_8cpp.html">netlist_serializer.cpp</a></li>
    <li class="footer">Generated on Thu Jun 19 2025 21:47:36 for HAL by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
