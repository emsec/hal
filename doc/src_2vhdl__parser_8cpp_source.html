<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HAL: /home/runner/work/hal/hal/plugins/vhdl_parser/src/vhdl_parser.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="hal_icon.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">HAL
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('src_2vhdl__parser_8cpp_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">vhdl_parser.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="src_2vhdl__parser_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="vhdl__parser_8h.html">vhdl_parser/vhdl_parser.h</a>&quot;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160; </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="endpoint_8h.html">hal_core/netlist/endpoint.h</a>&quot;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="gate_8h.html">hal_core/netlist/gate.h</a>&quot;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="include_2hal__core_2netlist_2netlist_8h.html">hal_core/netlist/netlist.h</a>&quot;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="netlist__factory_8h.html">hal_core/netlist/netlist_factory.h</a>&quot;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="enums_8h.html">hal_core/utilities/enums.h</a>&quot;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="log_8h.html">hal_core/utilities/log.h</a>&quot;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="utils_8h.html">hal_core/utilities/utils.h</a>&quot;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160; </div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &lt;fstream&gt;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;iomanip&gt;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &lt;queue&gt;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160; </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacehal.html">hal</a></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;{</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    <span class="keyword">namespace</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    {</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160; </div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    }    <span class="comment">// namespace</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160; </div>
<div class="line"><a name="l00022"></a><span class="lineno"><a class="line" href="classhal_1_1_v_h_d_l_parser.html#a4f2a41871abc23e22badf76ded8169ae">   22</a></span>&#160;    <a class="code" href="classhal_1_1_result.html">Result&lt;std::monostate&gt;</a> <a class="code" href="classhal_1_1_v_h_d_l_parser.html#a4f2a41871abc23e22badf76ded8169ae">VHDLParser::parse</a>(<span class="keyword">const</span> std::filesystem::path&amp; file_path)</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    {</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;        m_path = file_path;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;        m_entities.clear();</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;        m_attribute_buffer.clear();</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        m_attribute_types.clear();</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        {</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;            std::ifstream ifs;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;            ifs.open(file_path.string(), std::ifstream::in);</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;            <span class="keywordflow">if</span> (!ifs.is_open())</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;            {</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;unable to open VHDL file &#39;&quot;</span> + file_path.string() + <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;            }</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;            m_fs &lt;&lt; ifs.rdbuf();</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;            ifs.close();</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        }</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        <span class="comment">// tokenize file</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        tokenize();</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        <span class="comment">// parse tokens into intermediate format</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        <span class="keywordflow">try</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        {</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;            <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> res = parse_tokens(); res.is_error())</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;            {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#af20e293cf442ddedc129f87bbb6a69e9">ERR_APPEND</a>(res.get_error(), <span class="stringliteral">&quot;could not parse VHDL file &#39;&quot;</span> + m_path.string() + <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;            }</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        }</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        <span class="keywordflow">catch</span> (<a class="code" href="classhal_1_1_token_stream.html">TokenStream&lt;ci_string&gt;::TokenStreamException</a>&amp; e)</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;            <span class="keywordflow">if</span> (e.line_number != (<a class="code" href="net__layout__point_8h.html#aa7fe0c70576e86ca2c5f641bb47ccc9d">u32</a>)-1)</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;            {</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not parse VHDL file &#39;&quot;</span> + m_path.string() + <span class="stringliteral">&quot;&#39;: &quot;</span> + core_strings::to&lt;std::string&gt;(e.message) + <span class="stringliteral">&quot; near line &quot;</span> + std::to_string(e.line_number));</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;            }</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;            {</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not parse VHDL file &#39;&quot;</span> + m_path.string() + <span class="stringliteral">&quot;&#39;: &quot;</span> + core_strings::to&lt;std::string&gt;(e.message));</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;            }</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        }</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <span class="keywordflow">if</span> (m_entities.empty())</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not parse VHDL file &#39;&quot;</span> + m_path.string() + <span class="stringliteral">&quot;&#39;: it does not contain any entities&quot;</span>);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        }</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <span class="comment">// expand module port identifiers, signals, and assignments</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; [entity_name, vhdl_entity] : m_entities_by_name)</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        {</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            <span class="comment">// expand port identifiers</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; port : vhdl_entity-&gt;m_ports)</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            {</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                <span class="keywordflow">if</span> (!port-&gt;m_ranges.empty())</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                    port-&gt;m_expanded_identifiers = expand_ranges(port-&gt;m_identifier, port-&gt;m_ranges);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                    vhdl_entity-&gt;m_expanded_port_identifiers.insert(port-&gt;m_expanded_identifiers.begin(), port-&gt;m_expanded_identifiers.end());</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                    port-&gt;m_expanded_identifiers = {port-&gt;m_identifier};</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                    vhdl_entity-&gt;m_expanded_port_identifiers.insert(port-&gt;m_identifier);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                }</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;            }</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;            <span class="comment">// expand signals</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; signal : vhdl_entity-&gt;m_signals)</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                <span class="keywordflow">if</span> (!signal-&gt;m_ranges.empty())</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                {</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                    signal-&gt;m_expanded_names = expand_ranges(signal-&gt;m_name, signal-&gt;m_ranges);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                }</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                {</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                    signal-&gt;m_expanded_names = std::vector&lt;ci_string&gt;({signal-&gt;m_name});</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                }</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            }</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            <span class="comment">// expand assignments</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; assignment : vhdl_entity-&gt;m_assignments)</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;            {</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                <span class="keyword">auto</span> left_res = expand_assignment_expression(vhdl_entity, assignment.m_variable);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                <span class="keywordflow">if</span> (left_res.is_error())</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#af20e293cf442ddedc129f87bbb6a69e9">ERR_APPEND</a>(left_res.get_error(), <span class="stringliteral">&quot;could not parse VHDL file &#39;&quot;</span> + m_path.string() + <span class="stringliteral">&quot;&#39;: unable to expand signal assignment&quot;</span>);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                }</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                <span class="keyword">const</span> std::vector&lt;ci_string&gt; left_signals = left_res.get();</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                <span class="keyword">auto</span> right_res = expand_assignment_expression(vhdl_entity, assignment.m_assignment);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                <span class="keywordflow">if</span> (right_res.is_error())</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                {</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#af20e293cf442ddedc129f87bbb6a69e9">ERR_APPEND</a>(right_res.get_error(), <span class="stringliteral">&quot;could not parse VHDL file &#39;&quot;</span> + m_path.string() + <span class="stringliteral">&quot;&#39;: unable to expand signal assignment&quot;</span>);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                }</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                <span class="keyword">const</span> std::vector&lt;ci_string&gt; right_signals = right_res.get();</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                <a class="code" href="net__layout__point_8h.html#aa7fe0c70576e86ca2c5f641bb47ccc9d">u32</a> left_size  = left_signals.size();</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                <a class="code" href="net__layout__point_8h.html#aa7fe0c70576e86ca2c5f641bb47ccc9d">u32</a> right_size = right_signals.size();</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                <span class="keywordflow">if</span> (left_signals.empty() || right_signals.empty())</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not parse VHDL file &#39;&quot;</span> + m_path.string() + <span class="stringliteral">&quot;&#39;: failed to expand assignments within entity &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(entity_name) + <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                }</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (left_size != right_size)</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not parse VHDL file &#39;&quot;</span> + m_path.string() + <span class="stringliteral">&quot;&#39;: assignment width mismatch within entity &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(entity_name) + <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                    <span class="keywordflow">for</span> (<a class="code" href="net__layout__point_8h.html#aa7fe0c70576e86ca2c5f641bb47ccc9d">u32</a> i = 0; i &lt; right_size; i++)</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                    {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                        vhdl_entity-&gt;m_expanded_assignments.push_back(std::make_pair(left_signals.at(i), right_signals.at(i)));</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                    }</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                }</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            }</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        }</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="comment">// expand entity port assignments</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; [entity_name, vhdl_entity] : m_entities_by_name)</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; instance : vhdl_entity-&gt;m_instances)</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            {</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                <span class="keywordflow">if</span> (<span class="keyword">auto</span> entity_it = m_entities_by_name.find(instance-&gt;m_type); entity_it != m_entities_by_name.end())</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                {</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                    instance-&gt;m_is_entity = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                    <span class="keywordflow">if</span> (!instance-&gt;m_port_assignments.empty())</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                    {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                        <span class="comment">// all port assignments by name</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                        <span class="keywordflow">if</span> (instance-&gt;m_port_assignments.front().m_port.has_value())</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                        {</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; port_assignment : instance-&gt;m_port_assignments)</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                            {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                                <span class="keyword">auto</span> right_res = expand_assignment_expression(vhdl_entity, port_assignment.m_assignment);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                                <span class="keywordflow">if</span> (right_res.is_error())</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                                {</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                                    <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#af20e293cf442ddedc129f87bbb6a69e9">ERR_APPEND</a>(right_res.get_error(), <span class="stringliteral">&quot;could not parse VHDL file &#39;&quot;</span> + m_path.string() + <span class="stringliteral">&quot;&#39;: unable to expand entity port assignment&quot;</span>);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                                }</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                                <span class="keyword">const</span> std::vector&lt;ci_string&gt; right_port = right_res.get();</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                                <span class="keywordflow">if</span> (!right_port.empty())</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                                {</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                                    std::vector&lt;ci_string&gt; left_port;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                                    <span class="keywordflow">if</span> (<span class="keyword">const</span> identifier_t* identifier = std::get_if&lt;identifier_t&gt;(&amp;(port_assignment.m_port.value())); identifier != <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                                    {</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                                        <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> it = entity_it-&gt;second-&gt;m_ports_by_identifier.find(*identifier); it != entity_it-&gt;second-&gt;m_ports_by_identifier.end())</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                                        {</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                                            left_port = it-&gt;second-&gt;m_expanded_identifiers;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                                        }</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                                        {</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                                            <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not parse VHDL file &#39;&quot;</span> + m_path.string() + <span class="stringliteral">&quot;&#39;: unable to assign signal to port &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(*identifier)</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                                                       + <span class="stringliteral">&quot;&#39; as it is not a port of entity &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(entity_it-&gt;first) + <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                                        }</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                                    }</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">const</span> ranged_identifier_t* ranged_identifier = std::get_if&lt;ranged_identifier_t&gt;(&amp;(port_assignment.m_port.value())); ranged_identifier != <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                                    {</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                                        left_port = expand_ranges(ranged_identifier-&gt;first, ranged_identifier-&gt;second);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                                    }</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                                    {</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                                        <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not parse VHDL file &#39;&quot;</span> + m_path.string() + <span class="stringliteral">&quot;&#39;: unable to expand entity port assignment&quot;</span>);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                                    }</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                                    <span class="keywordflow">if</span> (left_port.empty())</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                                    {</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                                        <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not parse VHDL file &#39;&quot;</span> + m_path.string() + <span class="stringliteral">&quot;&#39;: unable to expand entity port assignment&quot;</span>);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                                    }</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                                    <a class="code" href="net__layout__point_8h.html#aa7fe0c70576e86ca2c5f641bb47ccc9d">u32</a> max_size = right_port.size() &lt;= left_port.size() ? right_port.size() : left_port.size();</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                                    <span class="keywordflow">for</span> (<a class="code" href="net__layout__point_8h.html#aa7fe0c70576e86ca2c5f641bb47ccc9d">u32</a> i = 0; i &lt; max_size; i++)</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                                    {</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                                        instance-&gt;m_expanded_port_assignments.push_back(std::make_pair(left_port.at(i), right_port.at(i)));</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                                    }</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                                }</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                            }</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                        }</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                        <span class="comment">// all port assignments by order</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                        {</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                            std::vector&lt;ci_string&gt; ports;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; port : m_entities_by_name.at(instance-&gt;m_type)-&gt;m_ports)</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                            {</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                                ports.insert(ports.end(), port-&gt;m_expanded_identifiers.begin(), port-&gt;m_expanded_identifiers.end());</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                            }</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                            <span class="keyword">auto</span> port_it = ports.begin();</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; port_assignment : instance-&gt;m_port_assignments)</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                            {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                                <span class="keyword">auto</span> right_res = expand_assignment_expression(vhdl_entity, port_assignment.m_assignment);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                                <span class="keywordflow">if</span> (right_res.is_error())</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                                {</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                                    <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#af20e293cf442ddedc129f87bbb6a69e9">ERR_APPEND</a>(right_res.get_error(), <span class="stringliteral">&quot;could not parse VHDL file &#39;&quot;</span> + m_path.string() + <span class="stringliteral">&quot;&#39;: unable to expand entity port assignment&quot;</span>);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                                }</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                                <span class="keyword">const</span> std::vector&lt;ci_string&gt; right_port = right_res.get();</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                                <span class="keywordflow">if</span> (!right_port.empty())</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                                {</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                                    std::vector&lt;ci_string&gt; left_port;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160; </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                                    <span class="keywordflow">for</span> (<a class="code" href="net__layout__point_8h.html#aa7fe0c70576e86ca2c5f641bb47ccc9d">u32</a> i = 0; i &lt; right_port.size() &amp;&amp; port_it != ports.end(); i++)</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                                    {</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                                        left_port.push_back(*port_it++);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                                    }</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                                    <a class="code" href="net__layout__point_8h.html#aa7fe0c70576e86ca2c5f641bb47ccc9d">u32</a> max_size = right_port.size() &lt;= left_port.size() ? right_port.size() : left_port.size();</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                                    <span class="keywordflow">for</span> (<a class="code" href="net__layout__point_8h.html#aa7fe0c70576e86ca2c5f641bb47ccc9d">u32</a> i = 0; i &lt; max_size; i++)</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                                    {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                                        instance-&gt;m_expanded_port_assignments.push_back(std::make_pair(left_port.at(i), right_port.at(i)));</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                                    }</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                                }</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                            }</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                        }</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                    }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                }</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            }</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        }</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a5ad667153a89697b109f5b8e64da7fe7">OK</a>({});</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    }</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
<div class="line"><a name="l00241"></a><span class="lineno"><a class="line" href="classhal_1_1_v_h_d_l_parser.html#afef7ad24385cdb4a5219bb96c6e55898">  241</a></span>&#160;    <a class="code" href="classhal_1_1_result.html">Result&lt;std::unique_ptr&lt;Netlist&gt;</a>&gt; <a class="code" href="classhal_1_1_v_h_d_l_parser.html#afef7ad24385cdb4a5219bb96c6e55898">VHDLParser::instantiate</a>(<span class="keyword">const</span> <a class="code" href="classhal_1_1_gate_library.html">GateLibrary</a>* gate_library)</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    {</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <span class="comment">// create empty netlist</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        std::unique_ptr&lt;Netlist&gt; result = <a class="code" href="namespacehal_1_1netlist__factory.html#a02885346f0ee983f70af158fdb0f3968">netlist_factory::create_netlist</a>(gate_library);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        m_netlist                       = result.get();</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        <span class="keywordflow">if</span> (m_netlist == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        {</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not instantiate VHDL netlist &#39;&quot;</span> + m_path.string() + <span class="stringliteral">&quot;&#39; with gate library &#39;&quot;</span> + gate_library-&gt;<a class="code" href="classhal_1_1_gate_library.html#aef64b8371779e27c778227552deb3a6d">get_name</a>() + <span class="stringliteral">&quot;&#39;: failed to create empty netlist&quot;</span>);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        }</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        m_gate_types.clear();</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        m_gnd_gate_types.clear();</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        m_vcc_gate_types.clear();</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        m_instance_name_occurrences.clear();</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        m_signal_name_occurrences.clear();</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        m_net_by_name.clear();</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        m_nets_to_merge.clear();</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        m_module_ports.clear();</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        m_module_port_by_net.clear();</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; vhdl_entity : m_entities)</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        {</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; instance : vhdl_entity-&gt;m_instances)</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;            {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                <span class="keywordflow">if</span> (!instance-&gt;m_is_entity)</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                {</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                    instance-&gt;m_expanded_port_assignments.clear();</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                }</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            }</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        }</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160; </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <span class="comment">// buffer gate types</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [gt_name, gt] : gate_library-&gt;<a class="code" href="classhal_1_1_gate_library.html#a4af85f352307e0cead8336be95cf2fea">get_gate_types</a>())</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        {</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            m_gate_types[core_strings::to&lt;ci_string&gt;(gt_name)] = gt;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        }</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [gt_name, gt] : gate_library-&gt;<a class="code" href="classhal_1_1_gate_library.html#abc606af53f4d9c1fc42e029851410e1e">get_gnd_gate_types</a>())</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        {</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            m_gnd_gate_types[core_strings::to&lt;ci_string&gt;(gt_name)] = gt;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        }</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [gt_name, gt] : gate_library-&gt;<a class="code" href="classhal_1_1_gate_library.html#a4f3f32d464c6cc8bc93704d317e86428">get_vcc_gate_types</a>())</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        {</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            m_vcc_gate_types[core_strings::to&lt;ci_string&gt;(gt_name)] = gt;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        }</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160; </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <span class="comment">// create const 0 and const 1 net, will be removed if unused</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        m_zero_net = m_netlist-&gt;<a class="code" href="classhal_1_1_netlist.html#a4735650221335f256fa7ce8d88c6f551">create_net</a>(<span class="stringliteral">&quot;&#39;0&#39;&quot;</span>);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <span class="keywordflow">if</span> (m_zero_net == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        {</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not instantiate VHDL netlist &#39;&quot;</span> + m_path.string() + <span class="stringliteral">&quot;&#39; with gate library &#39;&quot;</span> + gate_library-&gt;<a class="code" href="classhal_1_1_gate_library.html#aef64b8371779e27c778227552deb3a6d">get_name</a>() + <span class="stringliteral">&quot;&#39;: failed to create zero net&quot;</span>);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        }</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        m_net_by_name[core_strings::to&lt;ci_string&gt;(m_zero_net-&gt;<a class="code" href="classhal_1_1_net.html#a4627e0be693c99fece29559be12898bd">get_name</a>())] = m_zero_net;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160; </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        m_one_net = m_netlist-&gt;<a class="code" href="classhal_1_1_netlist.html#a4735650221335f256fa7ce8d88c6f551">create_net</a>(<span class="stringliteral">&quot;&#39;1&#39;&quot;</span>);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        <span class="keywordflow">if</span> (m_one_net == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        {</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not instantiate VHDL netlist &#39;&quot;</span> + m_path.string() + <span class="stringliteral">&quot;&#39; with gate library &#39;&quot;</span> + gate_library-&gt;<a class="code" href="classhal_1_1_gate_library.html#aef64b8371779e27c778227552deb3a6d">get_name</a>() + <span class="stringliteral">&quot;&#39;: failed to create one net&quot;</span>);</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        }</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        m_net_by_name[core_strings::to&lt;ci_string&gt;(m_one_net-&gt;<a class="code" href="classhal_1_1_net.html#a4627e0be693c99fece29559be12898bd">get_name</a>())] = m_one_net;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <span class="comment">// construct the netlist with the last module being considered the top module</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        std::map&lt;ci_string, u32&gt; entity_name_to_refereneces;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [_name, vhdl_entity] : m_entities_by_name)</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        {</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; instance : vhdl_entity-&gt;m_instances)</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;            {</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> it = m_entities_by_name.find(instance-&gt;m_type); it != m_entities_by_name.end())</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                {</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                    entity_name_to_refereneces[it-&gt;first]++;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                }</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            }</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        }</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        std::vector&lt;ci_string&gt; top_module_candidates;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [<a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a>, _entity] : m_entities_by_name)</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        {</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            <span class="keywordflow">if</span> (entity_name_to_refereneces.find(<a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a>) == entity_name_to_refereneces.end())</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;            {</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                top_module_candidates.push_back(<a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a>);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            }</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        }</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160; </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <span class="keywordflow">if</span> (top_module_candidates.empty())</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        {</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not instantiate VHDL netlist &#39;&quot;</span> + m_path.string() + <span class="stringliteral">&quot;&#39; with gate library &#39;&quot;</span> + gate_library-&gt;<a class="code" href="classhal_1_1_gate_library.html#aef64b8371779e27c778227552deb3a6d">get_name</a>() + <span class="stringliteral">&quot;&#39;: unable to find any top module candidates&quot;</span>);</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        }</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160; </div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <span class="keywordflow">if</span> (top_module_candidates.size() &gt; 1)</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        {</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not instantiate VHDL netlist &#39;&quot;</span> + m_path.string() + <span class="stringliteral">&quot;&#39; with gate library &#39;&quot;</span> + gate_library-&gt;<a class="code" href="classhal_1_1_gate_library.html#aef64b8371779e27c778227552deb3a6d">get_name</a>() + <span class="stringliteral">&quot;&#39;: found multiple entities as candidates for the top module&quot;</span>);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        }</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160; </div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        <span class="comment">// construct the netlist with the the top module</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        VhdlEntity* top_entity = m_entities_by_name.at(top_module_candidates.front());</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160; </div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> res = construct_netlist(top_entity); res.is_error())</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        {</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#af20e293cf442ddedc129f87bbb6a69e9">ERR_APPEND</a>(res.get_error(), <span class="stringliteral">&quot;could not instantiate VHDL netlist &#39;&quot;</span> + m_path.string() + <span class="stringliteral">&quot;&#39; with gate library &#39;&quot;</span> + gate_library-&gt;<a class="code" href="classhal_1_1_gate_library.html#aef64b8371779e27c778227552deb3a6d">get_name</a>() + <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        }</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160; </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        <span class="comment">// add global GND gate if required by any instance</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        <span class="keywordflow">if</span> (m_netlist-&gt;<a class="code" href="classhal_1_1_netlist.html#a5024423d773b9705545bf62f64c749a9">get_gnd_gates</a>().empty())</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        {</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            <span class="keywordflow">if</span> (m_zero_net-&gt;<a class="code" href="classhal_1_1_net.html#aa76dff7b223ce4676dfb8e4232ae2488">get_num_of_destinations</a>() &gt; 0)</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            {</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                <a class="code" href="classhal_1_1_gate_type.html">GateType</a>* gnd_type  = m_gnd_gate_types.begin()-&gt;second;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                <a class="code" href="classhal_1_1_gate_pin.html">GatePin</a>* output_pin = gnd_type-&gt;<a class="code" href="classhal_1_1_gate_type.html#a2ff8c787cda54ece95f10b399abb839a">get_output_pins</a>().front();</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                <a class="code" href="classhal_1_1_gate.html">Gate</a>* gnd           = m_netlist-&gt;<a class="code" href="classhal_1_1_netlist.html#aaeb832a880bee7804dd2bd7cfd6adfd4">create_gate</a>(m_netlist-&gt;<a class="code" href="classhal_1_1_netlist.html#a0e33d071f904e7538f927a6a92885057">get_unique_gate_id</a>(), gnd_type, <span class="stringliteral">&quot;global_gnd&quot;</span>);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160; </div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                <span class="keywordflow">if</span> (!m_netlist-&gt;<a class="code" href="classhal_1_1_netlist.html#a1600d7ec1cf6455657786174bc958589">mark_gnd_gate</a>(gnd))</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                {</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not instantiate VHDL netlist &#39;&quot;</span> + m_path.string() + <span class="stringliteral">&quot;&#39; with gate library &#39;&quot;</span> + gate_library-&gt;<a class="code" href="classhal_1_1_gate_library.html#aef64b8371779e27c778227552deb3a6d">get_name</a>() + <span class="stringliteral">&quot;&#39;: failed to mark GND gate&quot;</span>);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                }</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160; </div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                <span class="keywordflow">if</span> (!m_zero_net-&gt;<a class="code" href="classhal_1_1_net.html#a43001069500ebb42e6ac86b865d25947">add_source</a>(gnd, output_pin))</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                {</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not instantiate VHDL netlist &#39;&quot;</span> + m_path.string() + <span class="stringliteral">&quot;&#39; with gate library &#39;&quot;</span> + gate_library-&gt;<a class="code" href="classhal_1_1_gate_library.html#aef64b8371779e27c778227552deb3a6d">get_name</a>() + <span class="stringliteral">&quot;&#39;: could not add source to GND gate&quot;</span>);</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                }</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            }</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;            {</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                m_netlist-&gt;<a class="code" href="classhal_1_1_netlist.html#a3c2fbba09aa1857d44790bbd16c9df4e">delete_net</a>(m_zero_net);</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;            }</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        }</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        <span class="comment">// add global VCC gate if required by any instance</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        <span class="keywordflow">if</span> (m_netlist-&gt;<a class="code" href="classhal_1_1_netlist.html#a6b9524e351ab55d1b6cd6cb27dec707c">get_vcc_gates</a>().empty())</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        {</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            <span class="keywordflow">if</span> (m_one_net-&gt;<a class="code" href="classhal_1_1_net.html#aa76dff7b223ce4676dfb8e4232ae2488">get_num_of_destinations</a>() &gt; 0)</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;            {</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                <a class="code" href="classhal_1_1_gate_type.html">GateType</a>* vcc_type  = m_vcc_gate_types.begin()-&gt;second;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                <a class="code" href="classhal_1_1_gate_pin.html">GatePin</a>* output_pin = vcc_type-&gt;<a class="code" href="classhal_1_1_gate_type.html#a2ff8c787cda54ece95f10b399abb839a">get_output_pins</a>().front();</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                <a class="code" href="classhal_1_1_gate.html">Gate</a>* vcc           = m_netlist-&gt;<a class="code" href="classhal_1_1_netlist.html#aaeb832a880bee7804dd2bd7cfd6adfd4">create_gate</a>(m_netlist-&gt;<a class="code" href="classhal_1_1_netlist.html#a0e33d071f904e7538f927a6a92885057">get_unique_gate_id</a>(), vcc_type, <span class="stringliteral">&quot;global_vcc&quot;</span>);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160; </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                <span class="keywordflow">if</span> (!m_netlist-&gt;<a class="code" href="classhal_1_1_netlist.html#a13814c485dc7040d31820466b0a6883f">mark_vcc_gate</a>(vcc))</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                {</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not instantiate VHDL netlist &#39;&quot;</span> + m_path.string() + <span class="stringliteral">&quot;&#39; with gate library &#39;&quot;</span> + gate_library-&gt;<a class="code" href="classhal_1_1_gate_library.html#aef64b8371779e27c778227552deb3a6d">get_name</a>() + <span class="stringliteral">&quot;&#39;: failed to mark VCC gate&quot;</span>);</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                }</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160; </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                <span class="keywordflow">if</span> (!m_one_net-&gt;<a class="code" href="classhal_1_1_net.html#a43001069500ebb42e6ac86b865d25947">add_source</a>(vcc, output_pin))</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                {</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not instantiate VHDL netlist &#39;&quot;</span> + m_path.string() + <span class="stringliteral">&quot;&#39; with gate library &#39;&quot;</span> + gate_library-&gt;<a class="code" href="classhal_1_1_gate_library.html#aef64b8371779e27c778227552deb3a6d">get_name</a>() + <span class="stringliteral">&quot;&#39;: could not add source to VCC gate&quot;</span>);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                }</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;            }</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;            {</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                m_netlist-&gt;<a class="code" href="classhal_1_1_netlist.html#a3c2fbba09aa1857d44790bbd16c9df4e">delete_net</a>(m_one_net);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;            }</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        }</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160; </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <span class="comment">// delete unused nets</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        std::queue&lt;Net*&gt; nets_to_be_deleted;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160; </div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a504c73ff1a68c50e5435dece66bc2772">net</a> : m_netlist-&gt;<a class="code" href="classhal_1_1_netlist.html#ac787de6b52a38112735e3ff9bd2b6d17">get_nets</a>())</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        {</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            <span class="keyword">const</span> <a class="code" href="net__layout__point_8h.html#aa7fe0c70576e86ca2c5f641bb47ccc9d">u32</a> num_of_sources      = <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a504c73ff1a68c50e5435dece66bc2772">net</a>-&gt;get_num_of_sources();</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;            <span class="keyword">const</span> <a class="code" href="net__layout__point_8h.html#aa7fe0c70576e86ca2c5f641bb47ccc9d">u32</a> num_of_destinations = <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a504c73ff1a68c50e5435dece66bc2772">net</a>-&gt;get_num_of_destinations();</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">bool</span> no_source          = num_of_sources == 0 &amp;&amp; !(<a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a504c73ff1a68c50e5435dece66bc2772">net</a>-&gt;is_global_input_net() &amp;&amp; num_of_destinations != 0);</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">bool</span> no_destination     = num_of_destinations == 0 &amp;&amp; !(<a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a504c73ff1a68c50e5435dece66bc2772">net</a>-&gt;is_global_output_net() &amp;&amp; num_of_sources != 0);</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;            <span class="keywordflow">if</span> (no_source &amp;&amp; no_destination)</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;            {</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                m_netlist-&gt;<a class="code" href="classhal_1_1_netlist.html#a3c2fbba09aa1857d44790bbd16c9df4e">delete_net</a>(<a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a504c73ff1a68c50e5435dece66bc2772">net</a>);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;            }</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        }</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160; </div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        <span class="keywordflow">while</span> (!nets_to_be_deleted.empty())</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        {</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;            <a class="code" href="classhal_1_1_net.html">Net</a>* <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a504c73ff1a68c50e5435dece66bc2772">net</a> = nets_to_be_deleted.front();</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;            nets_to_be_deleted.pop();</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;            m_netlist-&gt;<a class="code" href="classhal_1_1_netlist.html#a3c2fbba09aa1857d44790bbd16c9df4e">delete_net</a>(<a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a504c73ff1a68c50e5435dece66bc2772">net</a>);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        }</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160; </div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        m_netlist-&gt;<a class="code" href="classhal_1_1_netlist.html#a2f4fbe600e19dc28c5bddf40b38ac0cf">load_gate_locations_from_data</a>();</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160; </div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a5ad667153a89697b109f5b8e64da7fe7">OK</a>(std::move(result));</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    }</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160; </div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="comment">// ###########################################################################</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="comment">// ###########          Parse HDL into Intermediate Format          ##########</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="comment">// ###########################################################################</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160; </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="keywordtype">void</span> VHDLParser::tokenize()</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    {</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        std::vector&lt;Token&lt;core_strings::CaseInsensitiveString&gt;&gt; parsed_tokens;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        <span class="keyword">const</span> std::string delimiters = <span class="stringliteral">&quot;,(): ;=&gt;&lt;&amp;&quot;</span>;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        <a class="code" href="namespacehal_1_1core__strings.html#a939599c80f140610abb0390b66acf8a6">core_strings::CaseInsensitiveString</a> current_token;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        <a class="code" href="net__layout__point_8h.html#aa7fe0c70576e86ca2c5f641bb47ccc9d">u32</a> line_number = 0;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160; </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        std::string line;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <span class="keywordtype">bool</span> in_string = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        <span class="keywordtype">bool</span> escaped   = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160; </div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        <span class="keywordflow">while</span> (std::getline(m_fs, line))</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        {</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;            line_number++;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;            <span class="keywordflow">if</span> (line.find(<span class="stringliteral">&quot;--&quot;</span>) != std::string::npos)</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;            {</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                line = line.substr(0, line.find(<span class="stringliteral">&quot;--&quot;</span>));</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;            }</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">char</span> c : <a class="code" href="namespacehal_1_1utils.html#a3b3244bd8945cb61cfa299c32686a601">utils::trim</a>(line))</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;            {</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                <span class="keywordflow">if</span> (in_string == <span class="keyword">false</span> &amp;&amp; c == <span class="charliteral">&#39;\\&#39;</span>)</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                {</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                    escaped = !escaped;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                }</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (escaped &amp;&amp; std::isspace(c))</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                {</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                    escaped = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                }</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!escaped &amp;&amp; c == <span class="charliteral">&#39;&quot;&#39;</span>)</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                {</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                    in_string = !in_string;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                }</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160; </div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                <span class="keywordflow">if</span> (delimiters.find(c) == std::string::npos || escaped || in_string)</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                {</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                    current_token += c;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                }</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                {</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                    <span class="keywordflow">if</span> (!current_token.empty())</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                    {</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                        <span class="keywordflow">if</span> (parsed_tokens.size() &gt; 1 &amp;&amp; <a class="code" href="namespacehal_1_1utils.html#a0fc4367e2b10cb8ed7c83998e231797d">utils::is_digits</a>(parsed_tokens.at(parsed_tokens.size() - 2).string) &amp;&amp; parsed_tokens.at(parsed_tokens.size() - 1) == <span class="stringliteral">&quot;.&quot;</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                            &amp;&amp; <a class="code" href="namespacehal_1_1utils.html#a0fc4367e2b10cb8ed7c83998e231797d">utils::is_digits</a>(current_token))</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                        {</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                            parsed_tokens.pop_back();</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                            parsed_tokens.back() += <span class="stringliteral">&quot;.&quot;</span> + current_token;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                        }</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                        {</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                            parsed_tokens.emplace_back(line_number, current_token);</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                        }</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                        current_token.clear();</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                    }</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160; </div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                    <span class="keywordflow">if</span> (!parsed_tokens.empty())</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                    {</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                        <span class="keywordflow">if</span> (c == <span class="charliteral">&#39;=&#39;</span> &amp;&amp; parsed_tokens.back() == <span class="stringliteral">&quot;&lt;&quot;</span>)</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                        {</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                            parsed_tokens.back() = <span class="stringliteral">&quot;&lt;=&quot;</span>;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                        }</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (c == <span class="charliteral">&#39;=&#39;</span> &amp;&amp; parsed_tokens.back() == <span class="stringliteral">&quot;:&quot;</span>)</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                        {</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                            parsed_tokens.back() = <span class="stringliteral">&quot;:=&quot;</span>;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                        }</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (c == <span class="charliteral">&#39;&gt;&#39;</span> &amp;&amp; parsed_tokens.back() == <span class="stringliteral">&quot;=&quot;</span>)</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                        {</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                            parsed_tokens.back() = <span class="stringliteral">&quot;=&gt;&quot;</span>;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                        }</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                    }</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160; </div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                    <span class="keywordflow">if</span> (!std::isspace(c))</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                    {</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                        parsed_tokens.emplace_back(line_number, <a class="code" href="namespacehal_1_1core__strings.html#a939599c80f140610abb0390b66acf8a6">core_strings::CaseInsensitiveString</a>(1, c));</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                    }</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                }</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;            }</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;            <span class="keywordflow">if</span> (!current_token.empty())</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;            {</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                parsed_tokens.emplace_back(line_number, current_token);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                current_token.clear();</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;            }</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        }</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        m_token_stream = TokenStream(parsed_tokens, {<span class="stringliteral">&quot;(&quot;</span>}, {<span class="stringliteral">&quot;)&quot;</span>});</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    }</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160; </div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    Result&lt;std::monostate&gt; VHDLParser::parse_tokens()</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    {</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        <span class="keywordflow">while</span> (m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#a0001aa8643e27c8a387420769982679a">remaining</a>() &gt; 0)</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        {</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;            <span class="keywordflow">if</span> (m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#a660cabea791d72b7980930d49e8f8ec9">peek</a>() == <span class="stringliteral">&quot;library&quot;</span> || m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#a660cabea791d72b7980930d49e8f8ec9">peek</a>() == <span class="stringliteral">&quot;use&quot;</span>)</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;            {</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                parse_library();</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;            }</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#a660cabea791d72b7980930d49e8f8ec9">peek</a>() == <span class="stringliteral">&quot;entity&quot;</span>)</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;            {</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> res = parse_entity(); res.is_error())</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                {</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#af20e293cf442ddedc129f87bbb6a69e9">ERR_APPEND</a>(res.get_error(), <span class="stringliteral">&quot;could not parse tokens&quot;</span>);</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                }</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;            }</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#a660cabea791d72b7980930d49e8f8ec9">peek</a>() == <span class="stringliteral">&quot;architecture&quot;</span>)</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;            {</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> res = parse_architecture(); res.is_error())</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                {</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#af20e293cf442ddedc129f87bbb6a69e9">ERR_APPEND</a>(res.get_error(), <span class="stringliteral">&quot;could not parse tokens&quot;</span>);</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                }</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;            }</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;            {</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not parse tokens: unexpected token &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#a660cabea791d72b7980930d49e8f8ec9">peek</a>().string) + <span class="stringliteral">&quot;&#39; in global scope (line &quot;</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                           + std::to_string(m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#a660cabea791d72b7980930d49e8f8ec9">peek</a>().number) + <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;            }</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        }</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160; </div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a5ad667153a89697b109f5b8e64da7fe7">OK</a>({});</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    }</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160; </div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="keywordtype">void</span> VHDLParser::parse_library()</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    {</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        <span class="keywordflow">if</span> (m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#a660cabea791d72b7980930d49e8f8ec9">peek</a>() == <span class="stringliteral">&quot;use&quot;</span>)</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        {</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;            m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>(<span class="stringliteral">&quot;use&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;            <span class="keyword">auto</span> lib = m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>().string;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;            m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>(<span class="stringliteral">&quot;;&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160; </div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;            <span class="comment">// remove specific import like &quot;.all&quot; but keep the &quot;.&quot;</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;            lib = <a class="code" href="namespacehal_1_1utils.html#a3b3244bd8945cb61cfa299c32686a601">utils::trim</a>(lib.substr(0, lib.rfind(<span class="stringliteral">&quot;.&quot;</span>) + 1));</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;            m_libraries.insert(lib);</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        }</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        {</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;            m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#a182e918c3841294d1e3faf71556c6c41">consume_until</a>(<span class="stringliteral">&quot;;&quot;</span>);</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;            m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>(<span class="stringliteral">&quot;;&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        }</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    }</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160; </div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    Result&lt;std::monostate&gt; VHDLParser::parse_entity()</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    {</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>(<span class="stringliteral">&quot;entity&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        <span class="keyword">const</span> <a class="code" href="net__layout__point_8h.html#aa7fe0c70576e86ca2c5f641bb47ccc9d">u32</a> line_number       = m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#a660cabea791d72b7980930d49e8f8ec9">peek</a>().number;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        <span class="keyword">const</span> ci_string entity_name = m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>().string;</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160; </div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        <span class="comment">// verify entity name</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> it = m_entities_by_name.find(entity_name); it != m_entities_by_name.end())</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        {</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not parse entity &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(entity_name) + <span class="stringliteral">&quot;&#39; (line &quot;</span> + std::to_string(line_number) + <span class="stringliteral">&quot;): an entity with name &#39;&quot;</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                       + core_strings::to&lt;std::string&gt;(entity_name) + <span class="stringliteral">&quot;&#39; does already exist (line &quot;</span> + std::to_string(it-&gt;second-&gt;m_line_number) + <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        }</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160; </div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>(<span class="stringliteral">&quot;is&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        <span class="keyword">auto</span> vhdl_entity               = std::make_unique&lt;VhdlEntity&gt;();</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        VhdlEntity* vhdl_entity_raw    = vhdl_entity.get();</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        vhdl_entity_raw-&gt;m_line_number = line_number;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        vhdl_entity_raw-&gt;m_name        = entity_name;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160; </div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        m_attribute_buffer.clear();</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160; </div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        Token&lt;ci_string&gt; next_token = m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#a660cabea791d72b7980930d49e8f8ec9">peek</a>();</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        <span class="keywordflow">while</span> (next_token != <span class="stringliteral">&quot;end&quot;</span>)</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        {</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;            <span class="keywordflow">if</span> (next_token == <span class="stringliteral">&quot;generic&quot;</span>)</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;            {</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#a182e918c3841294d1e3faf71556c6c41">consume_until</a>(<span class="stringliteral">&quot;;&quot;</span>);</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>(<span class="stringliteral">&quot;;&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;            }</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (next_token == <span class="stringliteral">&quot;port&quot;</span>)</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;            {</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> res = parse_port_definitons(vhdl_entity_raw); res.is_error())</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                {</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#af20e293cf442ddedc129f87bbb6a69e9">ERR_APPEND</a>(res.get_error(),</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                                      <span class="stringliteral">&quot;could not parse entity &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(entity_name) + <span class="stringliteral">&quot;&#39;: failed to parse port definition (line &quot;</span> + std::to_string(next_token.number) + <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                }</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;            }</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (next_token == <span class="stringliteral">&quot;attribute&quot;</span>)</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;            {</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> res = parse_attribute(); res.is_error())</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                {</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#af20e293cf442ddedc129f87bbb6a69e9">ERR_APPEND</a>(res.get_error(),</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                                      <span class="stringliteral">&quot;could not parse entity &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(entity_name) + <span class="stringliteral">&quot;&#39;: failed to parse attribute (line &quot;</span> + std::to_string(next_token.number) + <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                }</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;            }</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;            {</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not parse entity &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(entity_name) + <span class="stringliteral">&quot;&#39;: unexpected token &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(next_token.string)</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                           + <span class="stringliteral">&quot;&#39; in entity definition (line &quot;</span> + std::to_string(next_token.number) + <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;            }</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160; </div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;            next_token = m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#a660cabea791d72b7980930d49e8f8ec9">peek</a>();</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        }</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160; </div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>(<span class="stringliteral">&quot;end&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>();</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>(<span class="stringliteral">&quot;;&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160; </div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        <span class="comment">// add to collection of entities</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        m_entities.push_back(std::move(vhdl_entity));</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        m_entities_by_name[entity_name] = vhdl_entity_raw;</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        m_last_entity                   = entity_name;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160; </div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a5ad667153a89697b109f5b8e64da7fe7">OK</a>({});</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    }</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160; </div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    Result&lt;std::monostate&gt; VHDLParser::parse_port_definitons(VhdlEntity* vhdl_entity)</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    {</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;        <span class="comment">// default port assignments are not supported</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>(<span class="stringliteral">&quot;port&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>(<span class="stringliteral">&quot;(&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        <span class="keyword">auto</span> port_def_stream = m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#abeb97a5ae00e35a6ce00d4fa211de61a">extract_until</a>(<span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160; </div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        <span class="keywordflow">while</span> (port_def_stream.remaining() &gt; 0)</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        {</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;            std::vector&lt;core_strings::CaseInsensitiveString&gt; port_names;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;            <span class="comment">// std::set&lt;signal&gt; signals;</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160; </div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;            <span class="keyword">const</span> <span class="keyword">auto</span> line_number = port_def_stream.<a class="code" href="classhal_1_1_token_stream.html#a660cabea791d72b7980930d49e8f8ec9">peek</a>().number;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160; </div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;            <span class="comment">// extract names</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;            <span class="keywordflow">do</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;            {</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                port_names.push_back(port_def_stream.consume().string);</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;            } <span class="keywordflow">while</span> (port_def_stream.consume(<span class="stringliteral">&quot;,&quot;</span>, <span class="keyword">false</span>));</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160; </div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;            port_def_stream.consume(<span class="stringliteral">&quot;:&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160; </div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;            <span class="comment">// extract direction</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;            <a class="code" href="namespacehal.html#a119eb4e25d047caa41d83e762cbed8ec">PinDirection</a> <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a924ab95925fc83b38cba3ac2d8d7e9aa">direction</a>;</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;            <span class="keyword">const</span> ci_string direction_str = port_def_stream.consume().string;</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;            <span class="keywordflow">if</span> (direction_str == <span class="stringliteral">&quot;in&quot;</span>)</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;            {</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a924ab95925fc83b38cba3ac2d8d7e9aa">direction</a> = <a class="code" href="namespacehal.html#a119eb4e25d047caa41d83e762cbed8ecaa43c1b0aa53a0c908810c06ab1ff3967">PinDirection::input</a>;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;            }</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (direction_str == <span class="stringliteral">&quot;out&quot;</span>)</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;            {</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a924ab95925fc83b38cba3ac2d8d7e9aa">direction</a> = <a class="code" href="namespacehal.html#a119eb4e25d047caa41d83e762cbed8eca78e6221f6393d1356681db398f14ce6d">PinDirection::output</a>;</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;            }</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (direction_str == <span class="stringliteral">&quot;inout&quot;</span>)</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;            {</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a924ab95925fc83b38cba3ac2d8d7e9aa">direction</a> = <a class="code" href="namespacehal.html#a119eb4e25d047caa41d83e762cbed8eca54c9ccb45f5ee60133cca31fca024432">PinDirection::inout</a>;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;            }</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;            {</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not parse port definitions: invalid direction &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(direction_str) + <span class="stringliteral">&quot;&#39; for port declaration (line &quot;</span> + std::to_string(line_number)</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                           + <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;            }</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160; </div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;            <span class="comment">// extract ranges</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;            TokenStream&lt;ci_string&gt; port_stream = port_def_stream.extract_until(<span class="stringliteral">&quot;;&quot;</span>);</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;            std::vector&lt;std::vector&lt;u32&gt;&gt; ranges;</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;            <span class="keywordflow">if</span> (<span class="keyword">auto</span> res = parse_signal_ranges(port_stream); res.is_error())</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;            {</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#af20e293cf442ddedc129f87bbb6a69e9">ERR_APPEND</a>(res.get_error(), <span class="stringliteral">&quot;could not parse port definitions: unable to parse signal ranges (line &quot;</span> + std::to_string(line_number) + <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;            }</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;            {</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                ranges = res.get();</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;            }</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160; </div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;            port_def_stream.consume(<span class="stringliteral">&quot;;&quot;</span>, port_def_stream.remaining() &gt; 0);    <span class="comment">// last entry has no semicolon, so no throw in that case</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160; </div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">const</span> ci_string&amp; port_name : port_names)</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;            {</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                <span class="keyword">auto</span> port                                              = std::make_unique&lt;VhdlPort&gt;();</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                port-&gt;m_identifier                                     = port_name;</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                port-&gt;m_direction                                      = <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a924ab95925fc83b38cba3ac2d8d7e9aa">direction</a>;</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                port-&gt;m_ranges                                         = ranges;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                vhdl_entity-&gt;m_ports_by_identifier[port-&gt;m_identifier] = port.get();</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                vhdl_entity-&gt;m_ports.push_back(std::move(port));</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160; </div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                <span class="keywordflow">if</span> (vhdl_entity-&gt;m_signals_by_name.find(port_name) == vhdl_entity-&gt;m_signals_by_name.end())</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                {</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                    <span class="keyword">auto</span> signal    = std::make_unique&lt;VhdlSignal&gt;();</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                    signal-&gt;m_name = port_name;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                    <span class="keywordflow">if</span> (!ranges.empty())</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                    {</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                        signal-&gt;m_ranges = ranges;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                    }</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;                    vhdl_entity-&gt;m_signals_by_name[port_name] = signal.get();</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                    vhdl_entity-&gt;m_signals.push_back(std::move(signal));</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                }</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;            }</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        }</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160; </div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;        m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>(<span class="stringliteral">&quot;)&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;        m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>(<span class="stringliteral">&quot;;&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160; </div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a5ad667153a89697b109f5b8e64da7fe7">OK</a>({});</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    }</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160; </div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    Result&lt;std::monostate&gt; VHDLParser::parse_attribute()</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    {</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        <span class="keyword">const</span> <a class="code" href="net__layout__point_8h.html#aa7fe0c70576e86ca2c5f641bb47ccc9d">u32</a> line_number = m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#a660cabea791d72b7980930d49e8f8ec9">peek</a>().number;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160; </div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;        m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>(<span class="stringliteral">&quot;attribute&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;        <span class="keyword">const</span> ci_string attribute_name = m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>().string;</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160; </div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        <span class="keywordflow">if</span> (m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#a660cabea791d72b7980930d49e8f8ec9">peek</a>() == <span class="stringliteral">&quot;:&quot;</span>)</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        {</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;            m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>(<span class="stringliteral">&quot;:&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;            m_attribute_types[attribute_name] = m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#a8cd436414ae5483c8cb37b24fffd88e2">join_until</a>(<span class="stringliteral">&quot;;&quot;</span>, <span class="stringliteral">&quot; &quot;</span>);</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;            m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>(<span class="stringliteral">&quot;;&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        }</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#a660cabea791d72b7980930d49e8f8ec9">peek</a>() == <span class="stringliteral">&quot;of&quot;</span> &amp;&amp; m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#a660cabea791d72b7980930d49e8f8ec9">peek</a>(2) == <span class="stringliteral">&quot;:&quot;</span>)</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;        {</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;            AttributeTarget target_class;</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;            m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>(<span class="stringliteral">&quot;of&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;            <span class="keyword">const</span> ci_string attribute_target = m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>().string;</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;            m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>(<span class="stringliteral">&quot;:&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;            <span class="keyword">const</span> ci_string attribute_class = m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>().string;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;            m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>(<span class="stringliteral">&quot;is&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;            ci_string attribute_value = m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#a8cd436414ae5483c8cb37b24fffd88e2">join_until</a>(<span class="stringliteral">&quot;;&quot;</span>, <span class="stringliteral">&quot; &quot;</span>).string;</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;            m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>(<span class="stringliteral">&quot;;&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;            ci_string attribute_type;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160; </div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;            <span class="keywordflow">if</span> (attribute_value[0] == <span class="charliteral">&#39;\&quot;&#39;</span> &amp;&amp; attribute_value.back() == <span class="charliteral">&#39;\&quot;&#39;</span>)</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;            {</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                attribute_value = attribute_value.substr(1, attribute_value.size() - 2);</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;            }</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160; </div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;            <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> type_it = m_attribute_types.find(attribute_name); type_it == m_attribute_types.end())</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;            {</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;                <a class="code" href="group__utilities.html#gaccc921ec8323d53efb57a21a8d4be735">log_warning</a>(<span class="stringliteral">&quot;vhdl_parser&quot;</span>, <span class="stringliteral">&quot;attribute {} has unknown base type in line {}.&quot;</span>, attribute_name, line_number);</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                attribute_type = <span class="stringliteral">&quot;unknown&quot;</span>;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;            }</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;            {</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                attribute_type = type_it-&gt;second;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;            }</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160; </div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;            <span class="keywordflow">if</span> (attribute_class == <span class="stringliteral">&quot;entity&quot;</span>)</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;            {</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                target_class = AttributeTarget::ENTITY;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;            }</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (attribute_class == <span class="stringliteral">&quot;label&quot;</span>)</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;            {</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                target_class = AttributeTarget::INSTANCE;</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;            }</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (attribute_class == <span class="stringliteral">&quot;signal&quot;</span>)</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;            {</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                target_class = AttributeTarget::SIGNAL;</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;            }</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;            {</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                <a class="code" href="group__utilities.html#gaccc921ec8323d53efb57a21a8d4be735">log_warning</a>(<span class="stringliteral">&quot;vhdl_parser&quot;</span>, <span class="stringliteral">&quot;unsupported attribute class &#39;{}&#39; in line {}, ignoring attribute.&quot;</span>, attribute_class, line_number);</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a5ad667153a89697b109f5b8e64da7fe7">OK</a>({});</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;            }</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160; </div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;            VhdlDataEntry attribute;</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;            attribute.m_name  = core_strings::to&lt;std::string&gt;(attribute_name);</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;            attribute.m_type  = core_strings::to&lt;std::string&gt;(attribute_type);</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;            attribute.m_value = core_strings::to&lt;std::string&gt;(attribute_value);</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;            m_attribute_buffer[target_class].emplace(attribute_target, attribute);</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;        }</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;        {</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not parse attribute: malformed attribute definition (line &quot;</span> + std::to_string(line_number) + <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;        }</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160; </div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a5ad667153a89697b109f5b8e64da7fe7">OK</a>({});</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    }</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160; </div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    Result&lt;std::monostate&gt; VHDLParser::parse_architecture()</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    {</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;        m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>(<span class="stringliteral">&quot;architecture&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;        m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>();</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;        m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>(<span class="stringliteral">&quot;of&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160; </div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;        <a class="code" href="net__layout__point_8h.html#aa7fe0c70576e86ca2c5f641bb47ccc9d">u32</a> line_number              = m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#a660cabea791d72b7980930d49e8f8ec9">peek</a>().number;</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> entity_name_token = m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>();</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160; </div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> it = m_entities_by_name.find(entity_name_token.string); it == m_entities_by_name.end())</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;        {</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not parse architecture: architecture refers to non-existent entity &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(entity_name_token.string) + <span class="stringliteral">&quot;&#39; (line &quot;</span></div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                       + std::to_string(entity_name_token.number) + <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        }</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;        {</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;            VhdlEntity* vhdl_entity = it-&gt;second;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160; </div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;            m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>(<span class="stringliteral">&quot;is&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160; </div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;            <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> res = parse_architecture_header(vhdl_entity); res.is_error())</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;            {</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#af20e293cf442ddedc129f87bbb6a69e9">ERR_APPEND</a>(res.get_error(), <span class="stringliteral">&quot;could not parse architecture: unable to parse architecture header (line &quot;</span> + std::to_string(line_number) + <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;            }</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;            <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> res = parse_architecture_body(vhdl_entity); res.is_error())</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;            {</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#af20e293cf442ddedc129f87bbb6a69e9">ERR_APPEND</a>(res.get_error(), <span class="stringliteral">&quot;could not parse architecture: unable to parse architecture body (line &quot;</span> + std::to_string(line_number) + <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;            }</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;            <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> res = assign_attributes(vhdl_entity); res.is_error())</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;            {</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#af20e293cf442ddedc129f87bbb6a69e9">ERR_APPEND</a>(res.get_error(), <span class="stringliteral">&quot;could not parse architecture: unable to assign attributes (line &quot;</span> + std::to_string(line_number) + <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;            }</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160; </div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a5ad667153a89697b109f5b8e64da7fe7">OK</a>({});</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;        }</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    }</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160; </div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    Result&lt;std::monostate&gt; VHDLParser::parse_architecture_header(VhdlEntity* vhdl_entity)</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    {</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;        <span class="keyword">auto</span> next_token = m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#a660cabea791d72b7980930d49e8f8ec9">peek</a>();</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;        <span class="keywordflow">while</span> (next_token != <span class="stringliteral">&quot;begin&quot;</span>)</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;        {</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;            <span class="keywordflow">if</span> (next_token == <span class="stringliteral">&quot;signal&quot;</span>)</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;            {</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;                <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> res = parse_signal_definition(vhdl_entity); res.is_error())</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;                {</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#af20e293cf442ddedc129f87bbb6a69e9">ERR_APPEND</a>(res.get_error(), <span class="stringliteral">&quot;could not parse architecture header: unable to parse signal definition (line &quot;</span> + std::to_string(next_token.number) + <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;                }</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;            }</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (next_token == <span class="stringliteral">&quot;component&quot;</span>)</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;            {</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;                <span class="comment">// components are ignored</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;                m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>(<span class="stringliteral">&quot;component&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;                <span class="keyword">const</span> ci_string component_name = m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>().string;</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;                m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#a182e918c3841294d1e3faf71556c6c41">consume_until</a>(<span class="stringliteral">&quot;end&quot;</span>);</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>(<span class="stringliteral">&quot;end&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>(<span class="stringliteral">&quot;component&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                <span class="keywordflow">if</span> (m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#a660cabea791d72b7980930d49e8f8ec9">peek</a>() != <span class="stringliteral">&quot;;&quot;</span>)</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                {</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                    m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>(component_name, <span class="keyword">true</span>);    <span class="comment">// optional repetition of component name</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;                }</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;                m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>(<span class="stringliteral">&quot;;&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;            }</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (next_token == <span class="stringliteral">&quot;attribute&quot;</span>)</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;            {</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;                <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> res = parse_attribute(); res.is_error())</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                {</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#af20e293cf442ddedc129f87bbb6a69e9">ERR_APPEND</a>(res.get_error(), <span class="stringliteral">&quot;could not parse architecture header: unable to parse attribute (line &quot;</span> + std::to_string(next_token.number) + <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                }</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;            }</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;            {</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not parse architecture header: unexpected token &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(next_token.string) + <span class="stringliteral">&quot;&#39; (line &quot;</span> + std::to_string(next_token.number) + <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;            }</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160; </div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;            next_token = m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#a660cabea791d72b7980930d49e8f8ec9">peek</a>();</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;        }</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160; </div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a5ad667153a89697b109f5b8e64da7fe7">OK</a>({});</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    }</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160; </div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    Result&lt;std::monostate&gt; VHDLParser::parse_signal_definition(VhdlEntity* vhdl_entity)</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    {</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>(<span class="stringliteral">&quot;signal&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;        <a class="code" href="net__layout__point_8h.html#aa7fe0c70576e86ca2c5f641bb47ccc9d">u32</a> line_number = m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#a660cabea791d72b7980930d49e8f8ec9">peek</a>().number;</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160; </div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        <span class="comment">// extract names</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;        std::vector&lt;ci_string&gt; signal_names;</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;        <span class="keywordflow">do</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;        {</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;            signal_names.push_back(m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>().string);</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;        } <span class="keywordflow">while</span> (m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>(<span class="stringliteral">&quot;,&quot;</span>, <span class="keyword">false</span>));</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160; </div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;        m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>(<span class="stringliteral">&quot;:&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160; </div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;        <span class="comment">// extract bounds</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;        TokenStream&lt;ci_string&gt; signal_stream = m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#abeb97a5ae00e35a6ce00d4fa211de61a">extract_until</a>(<span class="stringliteral">&quot;;&quot;</span>);</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;        std::vector&lt;std::vector&lt;u32&gt;&gt; ranges;</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">auto</span> res = parse_signal_ranges(signal_stream); res.is_error())</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;        {</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#af20e293cf442ddedc129f87bbb6a69e9">ERR_APPEND</a>(res.get_error(), <span class="stringliteral">&quot;could not parse signal definition: unable to parse signal ranges (line &quot;</span> + std::to_string(line_number) + <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;        }</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;        {</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;            ranges = res.get();</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        }</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160; </div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;        m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>(<span class="stringliteral">&quot;;&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160; </div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; signal_name : signal_names)</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;        {</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;            <span class="keywordflow">if</span> (vhdl_entity-&gt;m_signals_by_name.find(signal_name) == vhdl_entity-&gt;m_signals_by_name.end())</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;            {</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;                <span class="keyword">auto</span> signal                                 = std::make_unique&lt;VhdlSignal&gt;();</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;                signal-&gt;m_name                              = signal_name;</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;                signal-&gt;m_ranges                            = ranges;</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                vhdl_entity-&gt;m_signals_by_name[signal_name] = signal.get();</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                vhdl_entity-&gt;m_signals.push_back(std::move(signal));</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;            }</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;        }</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160; </div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a5ad667153a89697b109f5b8e64da7fe7">OK</a>({});</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    }</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160; </div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    Result&lt;std::monostate&gt; VHDLParser::parse_architecture_body(VhdlEntity* vhdl_entity)</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    {</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;        m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>(<span class="stringliteral">&quot;begin&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;        <span class="keyword">auto</span> next_token = m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#a660cabea791d72b7980930d49e8f8ec9">peek</a>();</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160; </div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;        <span class="keywordflow">while</span> (next_token != <span class="stringliteral">&quot;end&quot;</span>)</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;        {</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;            <span class="comment">// new instance found</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;            <span class="keywordflow">if</span> (m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#a660cabea791d72b7980930d49e8f8ec9">peek</a>(1) == <span class="stringliteral">&quot;:&quot;</span>)</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;            {</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;                <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> res = parse_instance(vhdl_entity); res.is_error())</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;                {</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#af20e293cf442ddedc129f87bbb6a69e9">ERR_APPEND</a>(res.get_error(),</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;                                      <span class="stringliteral">&quot;could not parse architecture body of entity &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(vhdl_entity-&gt;m_name) + <span class="stringliteral">&quot;&#39;: unable to parse instance (line &quot;</span></div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;                                          + std::to_string(next_token.number) + <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;                }</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;            }</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;            <span class="comment">// not in instance -&gt; has to be a direct assignment</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#a77c5de4f3427dfc1f7edfa1e5234cf52">find_next</a>(<span class="stringliteral">&quot;&lt;=&quot;</span>) &lt; m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#a77c5de4f3427dfc1f7edfa1e5234cf52">find_next</a>(<span class="stringliteral">&quot;;&quot;</span>))</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;            {</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;                <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> res = parse_assignment(vhdl_entity); res.is_error())</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                {</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#af20e293cf442ddedc129f87bbb6a69e9">ERR_APPEND</a>(res.get_error(),</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;                                      <span class="stringliteral">&quot;could not parse architecture body of entity &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(vhdl_entity-&gt;m_name) + <span class="stringliteral">&quot;&#39;: unable to parse assignment (line &quot;</span></div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;                                          + std::to_string(next_token.number) + <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;                }</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;            }</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;            {</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not parse architecture body of entity &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(vhdl_entity-&gt;m_name) + <span class="stringliteral">&quot;&#39;: unexpected token &#39;&quot;</span></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                           + core_strings::to&lt;std::string&gt;(m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#a660cabea791d72b7980930d49e8f8ec9">peek</a>().string) + <span class="stringliteral">&quot;&#39; (line &quot;</span> + std::to_string(next_token.number) + <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;            }</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160; </div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;            next_token = m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#a660cabea791d72b7980930d49e8f8ec9">peek</a>();</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;        }</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160; </div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;        m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>(<span class="stringliteral">&quot;end&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;        m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>();</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;        m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>(<span class="stringliteral">&quot;;&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160; </div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a5ad667153a89697b109f5b8e64da7fe7">OK</a>({});</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    }</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160; </div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    Result&lt;std::monostate&gt; VHDLParser::parse_assignment(VhdlEntity* vhdl_entity)</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    {</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;        <a class="code" href="net__layout__point_8h.html#aa7fe0c70576e86ca2c5f641bb47ccc9d">u32</a> line_number = m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#a660cabea791d72b7980930d49e8f8ec9">peek</a>().number;</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;        VhdlAssignment assignment;</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160; </div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">auto</span> res = parse_assignment_expression(m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#abeb97a5ae00e35a6ce00d4fa211de61a">extract_until</a>(<span class="stringliteral">&quot;&lt;=&quot;</span>)); res.is_error())</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;        {</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#af20e293cf442ddedc129f87bbb6a69e9">ERR_APPEND</a>(res.get_error(), <span class="stringliteral">&quot;could not parse assignment: unable to parse assignment expression (line &quot;</span> + std::to_string(line_number) + <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;        }</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;        {</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;            assignment.m_variable = res.get();</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;        }</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;        m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>(<span class="stringliteral">&quot;&lt;=&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">auto</span> res = parse_assignment_expression(m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#abeb97a5ae00e35a6ce00d4fa211de61a">extract_until</a>(<span class="stringliteral">&quot;;&quot;</span>)); res.is_error())</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;        {</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#af20e293cf442ddedc129f87bbb6a69e9">ERR_APPEND</a>(res.get_error(), <span class="stringliteral">&quot;could not parse assignment: unable to parse assignment expression (line &quot;</span> + std::to_string(line_number) + <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;        }</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;        {</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;            assignment.m_assignment = res.get();</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;        }</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;        m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>(<span class="stringliteral">&quot;;&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160; </div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;        vhdl_entity-&gt;m_assignments.push_back(std::move(assignment));</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a5ad667153a89697b109f5b8e64da7fe7">OK</a>({});</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    }</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160; </div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    Result&lt;std::monostate&gt; VHDLParser::parse_instance(VhdlEntity* vhdl_entity)</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    {</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;        <span class="keyword">auto</span> instance    = std::make_unique&lt;VhdlInstance&gt;();</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;        <a class="code" href="net__layout__point_8h.html#aa7fe0c70576e86ca2c5f641bb47ccc9d">u32</a> line_number  = m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#a660cabea791d72b7980930d49e8f8ec9">peek</a>().number;</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;        instance-&gt;m_name = m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>();</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;        m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>(<span class="stringliteral">&quot;:&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160; </div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;        <span class="comment">// remove prefix from type</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;        <span class="keywordflow">if</span> (m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#a660cabea791d72b7980930d49e8f8ec9">peek</a>() == <span class="stringliteral">&quot;entity&quot;</span>)</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;        {</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;            m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>(<span class="stringliteral">&quot;entity&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;            instance-&gt;m_type = m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>();</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;            <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keywordtype">size_t</span> pos = instance-&gt;m_type.find(<span class="charliteral">&#39;.&#39;</span>); pos != std::string::npos)</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;            {</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;                instance-&gt;m_type = instance-&gt;m_type.substr(pos + 1);</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;            }</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;            <span class="keywordflow">if</span> (m_entities_by_name.find(instance-&gt;m_type) == m_entities_by_name.end())</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;            {</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not parse instance &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(instance-&gt;m_name) + <span class="stringliteral">&quot;&#39; of type &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(instance-&gt;m_type) + <span class="stringliteral">&quot;&#39;: entity with name &#39;&quot;</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;                           + core_strings::to&lt;std::string&gt;(instance-&gt;m_type) + <span class="stringliteral">&quot;&#39; does not exist (line &quot;</span> + std::to_string(line_number) + <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;            }</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;        }</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#a660cabea791d72b7980930d49e8f8ec9">peek</a>() == <span class="stringliteral">&quot;component&quot;</span>)</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;        {</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;            m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>(<span class="stringliteral">&quot;component&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;            instance-&gt;m_type = m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>();</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;        }</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;        {</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;            instance-&gt;m_type = m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>();</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;            ci_string prefix;</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160; </div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;            <span class="comment">// find longest matching library prefix</span></div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; lib : m_libraries)</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;            {</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;                <span class="keywordflow">if</span> (lib.size() &gt; prefix.size() &amp;&amp; <a class="code" href="namespacehal_1_1utils.html#a2ca8da557f49866efbd3d79be8bf5815">utils::starts_with</a>(instance-&gt;m_type, lib))</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;                {</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;                    prefix = lib;</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;                }</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;            }</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160; </div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;            <span class="comment">// remove prefix</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;            <span class="keywordflow">if</span> (!prefix.empty())</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;            {</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;                instance-&gt;m_type = instance-&gt;m_type.substr(prefix.size());</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;            }</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;        }</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160; </div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;        <span class="keywordflow">if</span> (m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>(<span class="stringliteral">&quot;generic&quot;</span>))</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;        {</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;            line_number = m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#a660cabea791d72b7980930d49e8f8ec9">peek</a>().number;</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;            <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> res = parse_generic_assign(instance.get()); res.is_error())</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;            {</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#af20e293cf442ddedc129f87bbb6a69e9">ERR_APPEND</a>(res.get_error(),</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                                  <span class="stringliteral">&quot;could not parse instance &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(instance-&gt;m_name) + <span class="stringliteral">&quot;&#39; of type &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(instance-&gt;m_type)</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;                                      + <span class="stringliteral">&quot;&#39;: unable to parse generic assignment (line &quot;</span> + std::to_string(line_number) + <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;            }</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;        }</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160; </div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;        <span class="keywordflow">if</span> (m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#a660cabea791d72b7980930d49e8f8ec9">peek</a>() == <span class="stringliteral">&quot;port&quot;</span>)</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;        {</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;            <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> res = parse_port_assign(instance.get()); res.is_error())</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;            {</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#af20e293cf442ddedc129f87bbb6a69e9">ERR_APPEND</a>(res.get_error(),</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;                                  <span class="stringliteral">&quot;could not parse instance &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(instance-&gt;m_name) + <span class="stringliteral">&quot;&#39; of type &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(instance-&gt;m_type)</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;                                      + <span class="stringliteral">&quot;&#39;: unable to parse port assignment (line &quot;</span> + std::to_string(line_number) + <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;            }</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;        }</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160; </div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;        vhdl_entity-&gt;m_instances_by_name[instance-&gt;m_name] = instance.get();</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        vhdl_entity-&gt;m_instances.push_back(std::move(instance));</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160; </div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;        m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>(<span class="stringliteral">&quot;;&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160; </div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a5ad667153a89697b109f5b8e64da7fe7">OK</a>({});</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    }</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160; </div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    Result&lt;std::monostate&gt; VHDLParser::parse_port_assign(VhdlInstance* instance)</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    {</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;        <a class="code" href="net__layout__point_8h.html#aa7fe0c70576e86ca2c5f641bb47ccc9d">u32</a> line_number = m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#a660cabea791d72b7980930d49e8f8ec9">peek</a>().number;</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;        m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>(<span class="stringliteral">&quot;port&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;        m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>(<span class="stringliteral">&quot;map&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;        m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>(<span class="stringliteral">&quot;(&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;        TokenStream&lt;ci_string&gt; port_stream = m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#abeb97a5ae00e35a6ce00d4fa211de61a">extract_until</a>(<span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;        m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>(<span class="stringliteral">&quot;)&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160; </div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;        <span class="keywordflow">if</span> (port_stream.find_next(<span class="stringliteral">&quot;=&gt;&quot;</span>) != <a class="code" href="classhal_1_1_token_stream.html#a059d296b9805d98e33992dd8b44c7139">TokenStream&lt;ci_string&gt;::END_OF_STREAM</a>)</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;        {</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;            <span class="keywordflow">while</span> (port_stream.remaining() &gt; 0)</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;            {</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;                TokenStream&lt;ci_string&gt; left_stream = port_stream.extract_until(<span class="stringliteral">&quot;=&gt;&quot;</span>);</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;                port_stream.consume(<span class="stringliteral">&quot;=&gt;&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;                TokenStream&lt;ci_string&gt; right_stream = port_stream.extract_until(<span class="stringliteral">&quot;,&quot;</span>);</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;                port_stream.consume(<span class="stringliteral">&quot;,&quot;</span>, port_stream.remaining() &gt; 0);    <span class="comment">// last entry has no comma</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160; </div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;                <span class="keywordflow">if</span> (!right_stream.consume(<span class="stringliteral">&quot;open&quot;</span>))</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;                {</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;                    VhdlPortAssignment port_assignment;</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160; </div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;                    <span class="keywordflow">if</span> (<span class="keyword">auto</span> res = parse_assignment_expression(std::move(left_stream)); res.is_error())</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;                    {</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#af20e293cf442ddedc129f87bbb6a69e9">ERR_APPEND</a>(res.get_error(), <span class="stringliteral">&quot;could not parse port assignment: unable to parse port (line &quot;</span> + std::to_string(line_number) + <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;                    }</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;                    {</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;                        <span class="comment">// vector can only have a single entry for left side of port assignment</span></div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;                        port_assignment.m_port = res.get().front();</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;                    }</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160; </div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;                    <span class="keywordflow">if</span> (<span class="keyword">auto</span> res = parse_assignment_expression(std::move(right_stream)); res.is_error())</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;                    {</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#af20e293cf442ddedc129f87bbb6a69e9">ERR_APPEND</a>(res.get_error(), <span class="stringliteral">&quot;could not parse port assignment: unable to parse assignment (line &quot;</span> + std::to_string(line_number) + <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;                    }</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;                    {</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;                        port_assignment.m_assignment = res.get();</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;                    }</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160; </div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;                    instance-&gt;m_port_assignments.push_back(std::move(port_assignment));</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;                }</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;            }</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;        }</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;        {</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;            <span class="keywordflow">while</span> (port_stream.remaining() &gt; 0)</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;            {</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;                TokenStream&lt;ci_string&gt; right_stream = port_stream.extract_until(<span class="stringliteral">&quot;,&quot;</span>);</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;                port_stream.consume(<span class="stringliteral">&quot;,&quot;</span>, port_stream.remaining() &gt; 0);    <span class="comment">// last entry has no comma</span></div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160; </div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;                <span class="keywordflow">if</span> (!right_stream.consume(<span class="stringliteral">&quot;open&quot;</span>))</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;                {</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;                    VhdlPortAssignment port_assignment;</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160; </div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;                    <span class="keywordflow">if</span> (<span class="keyword">auto</span> res = parse_assignment_expression(std::move(right_stream)); res.is_error())</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;                    {</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#af20e293cf442ddedc129f87bbb6a69e9">ERR_APPEND</a>(res.get_error(), <span class="stringliteral">&quot;could not parse port assignment: unable to parse assignment (line &quot;</span> + std::to_string(line_number) + <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;                    }</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;                    {</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;                        port_assignment.m_assignment = res.get();</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;                    }</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160; </div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;                    instance-&gt;m_port_assignments.push_back(std::move(port_assignment));</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;                }</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;                {</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;                    VhdlPortAssignment port_assignment;</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;                    port_assignment.m_assignment.push_back(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;                    instance-&gt;m_port_assignments.push_back(std::move(port_assignment));</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;                }</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;            }</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;        }</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160; </div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a5ad667153a89697b109f5b8e64da7fe7">OK</a>({});</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    }</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160; </div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;    Result&lt;std::monostate&gt; VHDLParser::parse_generic_assign(VhdlInstance* instance)</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;    {</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;        m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>(<span class="stringliteral">&quot;map&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;        m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>(<span class="stringliteral">&quot;(&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;        TokenStream&lt;ci_string&gt; generic_stream = m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#abeb97a5ae00e35a6ce00d4fa211de61a">extract_until</a>(<span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;        m_token_stream.<a class="code" href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">consume</a>(<span class="stringliteral">&quot;)&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160; </div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;        <span class="keywordflow">while</span> (generic_stream.remaining() &gt; 0)</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;        {</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;            VhdlDataEntry <span class="keyword">generic</span>;</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160; </div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;            <span class="keyword">generic</span>.m_line_number = generic_stream.peek().number;</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;            <span class="keyword">generic</span>.m_name        = core_strings::to&lt;std::string&gt;(generic_stream.join_until(<span class="stringliteral">&quot;=&gt;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>).string);</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;            generic_stream.consume(<span class="stringliteral">&quot;=&gt;&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;            <span class="keyword">const</span> <span class="keyword">auto</span> rhs = generic_stream.join_until(<span class="stringliteral">&quot;,&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;            generic_stream.consume(<span class="stringliteral">&quot;,&quot;</span>, generic_stream.remaining() &gt; 0);    <span class="comment">// last entry has no comma</span></div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160; </div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;            <span class="comment">// determine data type</span></div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;            <span class="keywordflow">if</span> ((rhs == <span class="stringliteral">&quot;true&quot;</span>) || (rhs == <span class="stringliteral">&quot;false&quot;</span>))</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;            {</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;                <span class="keyword">generic</span>.m_value = core_strings::to&lt;std::string&gt;(rhs.string);</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;                <span class="keyword">generic</span>.m_type  = <span class="stringliteral">&quot;boolean&quot;</span>;</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;            }</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacehal_1_1utils.html#a94d00e2a6c7e4945e1301d5e96377459">utils::is_integer</a>(rhs.string))</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;            {</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;                <span class="keyword">generic</span>.m_value = core_strings::to&lt;std::string&gt;(rhs.string);</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;                <span class="keyword">generic</span>.m_type  = <span class="stringliteral">&quot;integer&quot;</span>;</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;            }</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacehal_1_1utils.html#ac066333866ab6d67d66f1d9ec5671d79">utils::is_floating_point</a>(rhs.string))</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;            {</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;                <span class="keyword">generic</span>.m_value = core_strings::to&lt;std::string&gt;(rhs.string);</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;                <span class="keyword">generic</span>.m_type  = <span class="stringliteral">&quot;floating_point&quot;</span>;</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;            }</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacehal_1_1utils.html#a0de77a47a2551c69619fd6e3fce84674">utils::ends_with</a>(rhs.string, ci_string(<span class="stringliteral">&quot;s&quot;</span>)) || <a class="code" href="namespacehal_1_1utils.html#a0de77a47a2551c69619fd6e3fce84674">utils::ends_with</a>(rhs.string, ci_string(<span class="stringliteral">&quot;sec&quot;</span>)) || <a class="code" href="namespacehal_1_1utils.html#a0de77a47a2551c69619fd6e3fce84674">utils::ends_with</a>(rhs.string, ci_string(<span class="stringliteral">&quot;min&quot;</span>))</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;                     || <a class="code" href="namespacehal_1_1utils.html#a0de77a47a2551c69619fd6e3fce84674">utils::ends_with</a>(rhs.string, ci_string(<span class="stringliteral">&quot;hr&quot;</span>)))</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;            {</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;                <span class="keyword">generic</span>.m_value = core_strings::to&lt;std::string&gt;(rhs.string);</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;                <span class="keyword">generic</span>.m_type  = <span class="stringliteral">&quot;time&quot;</span>;</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;            }</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rhs.string.at(0) == <span class="charliteral">&#39;\&quot;&#39;</span> &amp;&amp; rhs.string.back() == <span class="charliteral">&#39;\&quot;&#39;</span>)</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;            {</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;                <span class="keyword">generic</span>.m_value = core_strings::to&lt;std::string&gt;(rhs.string.substr(1, rhs.string.size() - 2));</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;                <span class="keyword">generic</span>.m_type  = <span class="stringliteral">&quot;string&quot;</span>;</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;            }</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rhs.string.at(0) == <span class="charliteral">&#39;\&#39;&#39;</span> &amp;&amp; rhs.string.at(2) == <span class="charliteral">&#39;\&#39;&#39;</span>)</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;            {</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;                <span class="keyword">generic</span>.m_value = core_strings::to&lt;std::string&gt;(rhs.string.substr(1, 1));</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;                <span class="keyword">generic</span>.m_type  = <span class="stringliteral">&quot;bit_value&quot;</span>;</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;            }</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rhs.string.at(1) == <span class="charliteral">&#39;\&quot;&#39;</span> &amp;&amp; rhs.string.back() == <span class="charliteral">&#39;\&quot;&#39;</span>)</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;            {</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;                <span class="keywordflow">if</span> (<span class="keyword">auto</span> res = get_hex_from_literal(rhs); res.is_error())</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;                {</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#af20e293cf442ddedc129f87bbb6a69e9">ERR_APPEND</a>(res.get_error(), <span class="stringliteral">&quot;could not parse generic assignment: unable to translate token to hexadecimal string&quot;</span>);</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;                }</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;                {</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;                    <span class="keyword">generic</span>.m_value = core_strings::to&lt;std::string&gt;(res.get());</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;                    <span class="keyword">generic</span>.m_type  = <span class="stringliteral">&quot;bit_vector&quot;</span>;</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;                }</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;            }</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;            {</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not parse generic assignment: unable to identify data type of generic map value &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(rhs.string) + <span class="stringliteral">&quot;&#39; in instance &#39;&quot;</span></div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;                           + core_strings::to&lt;std::string&gt;(instance-&gt;m_name) + <span class="stringliteral">&quot;&#39; (line &quot;</span> + std::to_string(<span class="keyword">generic</span>.m_line_number) + <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;            }</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160; </div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;            instance-&gt;m_generics.push_back(<span class="keyword">generic</span>);</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;        }</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160; </div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a5ad667153a89697b109f5b8e64da7fe7">OK</a>({});</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    }</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160; </div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    Result&lt;std::monostate&gt; VHDLParser::assign_attributes(VhdlEntity* vhdl_entity)</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;    {</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [target_class, attributes] : m_attribute_buffer)</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;        {</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;            <span class="comment">// entity attributes</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;            <span class="keywordflow">if</span> (target_class == AttributeTarget::ENTITY)</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;            {</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [target, attribute] : attributes)</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;                {</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;                    <span class="keywordflow">if</span> (vhdl_entity-&gt;m_name != target)</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;                    {</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not assign attributes: invalid attribute target &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(target) + <span class="stringliteral">&quot;&#39; within entity &#39;&quot;</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;                                   + core_strings::to&lt;std::string&gt;(vhdl_entity-&gt;m_name) + <span class="stringliteral">&quot;&#39; (line &quot;</span> + std::to_string(attribute.m_line_number) + <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;                    }</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                    {</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;                        vhdl_entity-&gt;m_attributes.push_back(attribute);</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;                    }</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;                }</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;            }</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;            <span class="comment">// instance attributes</span></div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (target_class == AttributeTarget::INSTANCE)</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;            {</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [target, attribute] : attributes)</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;                {</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;                    <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> instance_it = vhdl_entity-&gt;m_instances_by_name.find(target); instance_it == vhdl_entity-&gt;m_instances_by_name.end())</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;                    {</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not assign attributes: invalid attribute target &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(target) + <span class="stringliteral">&quot;&#39; within entity &#39;&quot;</span></div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;                                   + core_strings::to&lt;std::string&gt;(vhdl_entity-&gt;m_name) + <span class="stringliteral">&quot;&#39; (line &quot;</span> + std::to_string(attribute.m_line_number) + <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;                    }</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;                    {</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;                        instance_it-&gt;second-&gt;m_attributes.push_back(attribute);</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;                    }</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;                }</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;            }</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;            <span class="comment">// signal attributes</span></div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (target_class == AttributeTarget::SIGNAL)</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;            {</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [target, attribute] : attributes)</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;                {</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;                    <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> signal_it = vhdl_entity-&gt;m_signals_by_name.find(target); signal_it != vhdl_entity-&gt;m_signals_by_name.end())</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;                    {</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;                        signal_it-&gt;second-&gt;m_attributes.push_back(attribute);</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;                    }</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;                    {</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not assign attributes: invalid attribute target &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(target) + <span class="stringliteral">&quot;&#39; within entity &#39;&quot;</span></div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;                                   + core_strings::to&lt;std::string&gt;(vhdl_entity-&gt;m_name) + <span class="stringliteral">&quot;&#39; (line &quot;</span> + std::to_string(attribute.m_line_number) + <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;                    }</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;                }</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;            }</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;        }</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160; </div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a5ad667153a89697b109f5b8e64da7fe7">OK</a>({});</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;    }</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160; </div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;    <span class="comment">// ###########################################################################</span></div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;    <span class="comment">// ###########      Assemble Netlist from Intermediate Format       ##########</span></div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;    <span class="comment">// ###########################################################################</span></div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160; </div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;    Result&lt;std::monostate&gt; VHDLParser::construct_netlist(VhdlEntity* top_entity)</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;    {</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;        m_netlist-&gt;<a class="code" href="classhal_1_1_netlist.html#a5e707263f93fa7df2cc420c653831ba2">set_design_name</a>(core_strings::to&lt;std::string&gt;(top_entity-&gt;m_name));</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;        m_netlist-&gt;<a class="code" href="classhal_1_1_netlist.html#a5fd4f32302dcb8dbcdc4b512d586fee9">enable_automatic_net_checks</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160; </div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;        std::unordered_map&lt;ci_string, u32&gt; instantiation_count;</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160; </div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;        <span class="comment">// preparations for alias: count the occurences of all names</span></div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;        std::queue&lt;VhdlEntity*&gt; q;</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;        q.push(top_entity);</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160; </div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;        <span class="keywordflow">while</span> (!q.empty())</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;        {</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;            VhdlEntity* <a class="code" href="_apache_01_license_8txt.html#aa1b09deb55aa1a0b7f14f7e3eb1004ec">entity</a> = q.front();</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;            q.pop();</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160; </div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;            instantiation_count[<a class="code" href="_apache_01_license_8txt.html#aa1b09deb55aa1a0b7f14f7e3eb1004ec">entity</a>-&gt;m_name]++;</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160; </div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;            <span class="comment">// collect and count all net names in the netlist</span></div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; s : <a class="code" href="_apache_01_license_8txt.html#aa1b09deb55aa1a0b7f14f7e3eb1004ec">entity</a>-&gt;m_signals)</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;            {</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;                std::vector&lt;ci_string&gt; expanded_names;</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;                expand_ranges_recursively(expanded_names, s-&gt;m_name, s-&gt;m_ranges, 0);</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; net_name : expanded_names)</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;                {</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;                    m_signal_name_occurrences[net_name]++;</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;                }</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;            }</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160; </div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; instance : <a class="code" href="_apache_01_license_8txt.html#aa1b09deb55aa1a0b7f14f7e3eb1004ec">entity</a>-&gt;m_instances)</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;            {</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;                m_instance_name_occurrences[instance-&gt;m_name]++;</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160; </div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;                <span class="comment">// add type of instance to q if it is a module</span></div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;                <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> it = m_entities_by_name.find(instance-&gt;m_type); it != m_entities_by_name.end())</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;                {</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;                    q.push(it-&gt;second);</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;                }</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;            }</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;        }</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160; </div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; [entity_name, vhdl_entity] : m_entities_by_name)</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;        {</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;            <span class="comment">// detect unused entities</span></div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;            <span class="keywordflow">if</span> (instantiation_count[entity_name] == 0)</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;            {</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;                <a class="code" href="group__utilities.html#gaccc921ec8323d53efb57a21a8d4be735">log_warning</a>(<span class="stringliteral">&quot;vhdl_parser&quot;</span>, <span class="stringliteral">&quot;entity &#39;{}&#39; has been defined in the netlist but is not instantiated.&quot;</span>, entity_name);</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;            }</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160; </div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;            <span class="comment">// expand gate pin assignments</span></div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; instance : vhdl_entity-&gt;m_instances)</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;            {</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;                <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> gate_type_it = m_gate_types.find(instance-&gt;m_type); gate_type_it != m_gate_types.end())</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;                {</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;                    <span class="keywordflow">if</span> (!instance-&gt;m_port_assignments.empty())</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;                    {</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;                        <span class="comment">// all port assignments by name</span></div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;                        <span class="keywordflow">if</span> (instance-&gt;m_port_assignments.front().m_port.has_value())</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;                        {</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;                            <span class="comment">// cache pin groups</span></div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;                            std::unordered_map&lt;ci_string, std::vector&lt;ci_string&gt;&gt; pin_groups;</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;                            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> pin_group : gate_type_it-&gt;second-&gt;get_pin_groups())</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;                            {</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;                                <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a1e273622affc5aefcd63c0036e5ce1b9">pins</a> = pin_group-&gt;get_pins();</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;                                <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a1e273622affc5aefcd63c0036e5ce1b9">pins</a>.rbegin(); it != <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a1e273622affc5aefcd63c0036e5ce1b9">pins</a>.rend(); it++)</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;                                {</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;                                    <span class="keyword">const</span> <span class="keyword">auto</span>* pin = *it;</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;                                    pin_groups[core_strings::to&lt;ci_string&gt;(pin_group-&gt;get_name())].push_back(core_strings::to&lt;ci_string&gt;(pin-&gt;get_name()));</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;                                }</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;                            }</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160; </div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;                            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; port_assignment : instance-&gt;m_port_assignments)</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;                            {</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;                                <span class="keyword">auto</span> right_res = expand_assignment_expression(vhdl_entity, port_assignment.m_assignment);</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;                                <span class="keywordflow">if</span> (right_res.is_error())</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;                                {</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;                                    <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#af20e293cf442ddedc129f87bbb6a69e9">ERR_APPEND</a>(right_res.get_error(), <span class="stringliteral">&quot;could not construct netlist: unable to expand gate port assignment&quot;</span>);</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;                                }</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;                                <span class="keyword">auto</span> right_port = right_res.get();</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160; </div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;                                <span class="keywordflow">if</span> (!right_port.empty())</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;                                {</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;                                    std::vector&lt;ci_string&gt; left_port;</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160; </div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;                                    <span class="keywordflow">if</span> (<span class="keyword">const</span> identifier_t* identifier = std::get_if&lt;identifier_t&gt;(&amp;(port_assignment.m_port.value())); identifier != <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;                                    {</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;                                        <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> group_it = pin_groups.find(*identifier); group_it != pin_groups.end())</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;                                        {</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;                                            left_port = group_it-&gt;second;</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;                                        }</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;                                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;                                        {</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;                                            left_port.push_back(*identifier);</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;                                        }</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;                                    }</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;                                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">const</span> ranged_identifier_t* ranged_identifier = std::get_if&lt;ranged_identifier_t&gt;(&amp;(port_assignment.m_port.value())); ranged_identifier != <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;                                    {</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;                                        left_port = expand_ranges(ranged_identifier-&gt;first, ranged_identifier-&gt;second);</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;                                    }</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;                                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;                                    {</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;                                        <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not construct netlist: unable to expand gate port assignment&quot;</span>);</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;                                    }</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160; </div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;                                    <span class="keywordflow">if</span> (right_port.size() != left_port.size())</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;                                    {</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;                                        <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not construct netlist: pin assignment width mismatch at instance &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(instance-&gt;m_name) + <span class="stringliteral">&quot;&#39; of gate type &#39;&quot;</span></div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;                                                   + core_strings::to&lt;std::string&gt;(instance-&gt;m_type) + <span class="stringliteral">&quot;&#39; within entity &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(entity_name) + <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;                                    }</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160; </div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;                                    <span class="keywordflow">for</span> (<a class="code" href="net__layout__point_8h.html#aa7fe0c70576e86ca2c5f641bb47ccc9d">u32</a> i = 0; i &lt; left_port.size(); i++)</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;                                    {</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;                                        instance-&gt;m_expanded_port_assignments.push_back(std::make_pair(left_port.at(i), right_port.at(i)));</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;                                    }</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;                                }</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;                            }</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;                        }</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;                        <span class="comment">// all port assignments by order</span></div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;                        {</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;                            <span class="comment">// cache pins</span></div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;                            std::vector&lt;ci_string&gt; <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a1e273622affc5aefcd63c0036e5ce1b9">pins</a>;</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;                            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> pin : gate_type_it-&gt;second-&gt;get_pins())</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;                            {</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;                                <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a1e273622affc5aefcd63c0036e5ce1b9">pins</a>.push_back(core_strings::to&lt;ci_string&gt;(pin-&gt;get_name()));</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;                            }</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;                            <span class="keyword">auto</span> pin_it = <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a1e273622affc5aefcd63c0036e5ce1b9">pins</a>.begin();</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160; </div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;                            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; port_assignment : instance-&gt;m_port_assignments)</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;                            {</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;                                <span class="keyword">auto</span> right_res = expand_assignment_expression(vhdl_entity, port_assignment.m_assignment);</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;                                <span class="keywordflow">if</span> (right_res.is_error())</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;                                {</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;                                    <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#af20e293cf442ddedc129f87bbb6a69e9">ERR_APPEND</a>(right_res.get_error(), <span class="stringliteral">&quot;could not construct netlist: unable to expand gate port assignment&quot;</span>);</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;                                }</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;                                <span class="keyword">auto</span> right_port = right_res.get();</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160; </div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;                                <span class="keywordflow">if</span> (!right_port.empty())</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;                                {</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;                                    std::vector&lt;ci_string&gt; left_port;</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160; </div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;                                    <span class="keywordflow">for</span> (<a class="code" href="net__layout__point_8h.html#aa7fe0c70576e86ca2c5f641bb47ccc9d">u32</a> i = 0; i &lt; right_port.size() &amp;&amp; pin_it != <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a1e273622affc5aefcd63c0036e5ce1b9">pins</a>.end(); i++)</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;                                    {</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;                                        left_port.push_back(*pin_it++);</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;                                    }</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160; </div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;                                    <a class="code" href="net__layout__point_8h.html#aa7fe0c70576e86ca2c5f641bb47ccc9d">u32</a> max_size = right_port.size() &lt;= left_port.size() ? right_port.size() : left_port.size();</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160; </div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;                                    <span class="keywordflow">for</span> (<a class="code" href="net__layout__point_8h.html#aa7fe0c70576e86ca2c5f641bb47ccc9d">u32</a> i = 0; i &lt; max_size; i++)</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;                                    {</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;                                        instance-&gt;m_expanded_port_assignments.push_back(std::make_pair(left_port.at(i), right_port.at(i)));</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;                                    }</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;                                }</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;                            }</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;                        }</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;                    }</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;                }</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;            }</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;        }</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160; </div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;        <span class="comment">// for the top module, generate global i/o signals for all ports</span></div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;        std::unordered_map&lt;ci_string, ci_string&gt; top_assignments;</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; port : top_entity-&gt;m_ports)</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;        {</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; expanded_port_identifier : port-&gt;m_expanded_identifiers)</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;            {</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;                <span class="keyword">const</span> <span class="keyword">auto</span> signal_name = get_unique_alias(<span class="stringliteral">&quot;&quot;</span>, expanded_port_identifier + <span class="stringliteral">&quot;__GLOBAL_IO__&quot;</span>, m_signal_name_occurrences);</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160; </div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;                <a class="code" href="group__gui.html#ggaab0cd38a41c1215ae70822b1d501daa1a5012af45088eb8e999bb8350077b12ca">Net</a>* global_port_net = m_netlist-&gt;<a class="code" href="classhal_1_1_netlist.html#a4735650221335f256fa7ce8d88c6f551">create_net</a>(core_strings::to&lt;std::string&gt;(signal_name));</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;                <span class="keywordflow">if</span> (global_port_net == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;                {</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not construct netlist: failed to create global I/O net &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(signal_name) + <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;                }</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160; </div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;                m_net_by_name[signal_name] = global_port_net;</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160; </div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;                <span class="comment">// assign global port nets to ports of top module</span></div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;                top_assignments[expanded_port_identifier] = signal_name;</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160; </div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;                <span class="keywordflow">if</span> (port-&gt;m_direction == <a class="code" href="namespacehal.html#a119eb4e25d047caa41d83e762cbed8ecaa43c1b0aa53a0c908810c06ab1ff3967">PinDirection::input</a> || port-&gt;m_direction == <a class="code" href="namespacehal.html#a119eb4e25d047caa41d83e762cbed8eca54c9ccb45f5ee60133cca31fca024432">PinDirection::inout</a>)</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;                {</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;                    <span class="keywordflow">if</span> (!global_port_net-&gt;mark_global_input_net())</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;                    {</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not construct netlist: failed to mark global I/O net &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(signal_name) + <span class="stringliteral">&quot;&#39; as global input&quot;</span>);</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;                    }</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;                }</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160; </div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;                <span class="keywordflow">if</span> (port-&gt;m_direction == <a class="code" href="namespacehal.html#a119eb4e25d047caa41d83e762cbed8eca78e6221f6393d1356681db398f14ce6d">PinDirection::output</a> || port-&gt;m_direction == <a class="code" href="namespacehal.html#a119eb4e25d047caa41d83e762cbed8eca54c9ccb45f5ee60133cca31fca024432">PinDirection::inout</a>)</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;                {</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;                    <span class="keywordflow">if</span> (!global_port_net-&gt;mark_global_output_net())</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;                    {</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not construct netlist: failed to mark global I/O net &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(signal_name) + <span class="stringliteral">&quot;&#39; as global output&quot;</span>);</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;                    }</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;                }</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;            }</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;        }</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160; </div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;        <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> res = instantiate_entity(<span class="stringliteral">&quot;top_module&quot;</span>, top_entity, <span class="keyword">nullptr</span>, top_assignments); res.is_error())</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;        {</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#af20e293cf442ddedc129f87bbb6a69e9">ERR_APPEND</a>(res.get_error(), <span class="stringliteral">&quot;could not construct netlist: unable to instantiate top module&quot;</span>);</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;        }</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160; </div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;        <span class="comment">// merge nets without gates in between them</span></div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;        std::unordered_map&lt;ci_string, ci_string&gt; merged_nets;</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;        std::unordered_map&lt;ci_string, std::vector&lt;ci_string&gt;&gt; master_to_slaves;</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160; </div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; [master, slave] : m_nets_to_merge)</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;        {</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;            <span class="comment">// check if master net has already been merged into other net</span></div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;            <span class="keywordflow">while</span> (<span class="keyword">true</span>)</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;            {</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;                <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> master_it = merged_nets.find(master); master_it != merged_nets.end())</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;                {</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;                    master = master_it-&gt;second;</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;                }</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;                {</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;                }</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;            }</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160; </div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;            <span class="comment">// check if slave net has already been merged into other net</span></div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;            <span class="keywordflow">while</span> (<span class="keyword">true</span>)</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;            {</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;                <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> slave_it = merged_nets.find(slave); slave_it != merged_nets.end())</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;                {</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;                    slave = slave_it-&gt;second;</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;                }</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;                {</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;                }</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;            }</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160; </div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;            <span class="keyword">auto</span> master_net = m_net_by_name.at(master);</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;            <span class="keyword">auto</span> slave_net  = m_net_by_name.at(slave);</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160; </div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;            <span class="keywordflow">if</span> (master_net == slave_net)</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;            {</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;            }</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (slave_net == m_zero_net || slave_net == m_one_net)</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;            {</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;                <span class="keyword">auto</span>* tmp_net = master_net;</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;                master_net    = slave_net;</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;                slave_net     = tmp_net;</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160; </div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;                <span class="keyword">auto</span> tmp_name = master;</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;                master        = slave;</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;                slave         = tmp_name;</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;            }</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160; </div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;            <span class="comment">// merge sources</span></div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;            <span class="keywordflow">if</span> (slave_net-&gt;is_global_input_net())</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;            {</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;                master_net-&gt;mark_global_input_net();</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;            }</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160; </div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">auto</span> src : slave_net-&gt;get_sources())</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;            {</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;                <a class="code" href="group__gui.html#ggaab0cd38a41c1215ae70822b1d501daa1ad25b4bd4c72aa2c07ee87adb10b59f16">Gate</a>* src_gate   = src-&gt;get_gate();</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;                GatePin* src_pin = src-&gt;get_pin();</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160; </div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;                <span class="keywordflow">if</span> (!slave_net-&gt;remove_source(src))</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;                {</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not construct netlist: failed to remove source from net &#39;&quot;</span> + slave_net-&gt;get_name() + <span class="stringliteral">&quot;&#39; with ID &quot;</span> + std::to_string(slave_net-&gt;get_id()));</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;                }</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160; </div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;                <span class="keywordflow">if</span> (!master_net-&gt;is_a_source(src_gate, src_pin))</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;                {</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;                    <span class="keywordflow">if</span> (!master_net-&gt;add_source(src_gate, src_pin))</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;                    {</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not construct netlist: failed to add source to net &#39;&quot;</span> + master_net-&gt;get_name() + <span class="stringliteral">&quot;&#39; with ID &quot;</span> + std::to_string(master_net-&gt;get_id()));</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;                    }</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;                }</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;            }</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160; </div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;            <span class="comment">// merge destinations</span></div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;            <span class="keywordflow">if</span> (slave_net-&gt;is_global_output_net())</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;            {</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;                master_net-&gt;mark_global_output_net();</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;            }</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160; </div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">auto</span> dst : slave_net-&gt;get_destinations())</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;            {</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;                <a class="code" href="group__gui.html#ggaab0cd38a41c1215ae70822b1d501daa1ad25b4bd4c72aa2c07ee87adb10b59f16">Gate</a>* dst_gate   = dst-&gt;get_gate();</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;                GatePin* dst_pin = dst-&gt;get_pin();</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160; </div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;                <span class="keywordflow">if</span> (!slave_net-&gt;remove_destination(dst))</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;                {</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not construct netlist: failed to remove destination from net &#39;&quot;</span> + slave_net-&gt;get_name() + <span class="stringliteral">&quot;&#39; with ID &quot;</span> + std::to_string(slave_net-&gt;get_id()));</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;                }</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160; </div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;                <span class="keywordflow">if</span> (!master_net-&gt;is_a_destination(dst_gate, dst_pin))</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;                {</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;                    <span class="keywordflow">if</span> (!master_net-&gt;add_destination(dst_gate, dst_pin))</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;                    {</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not construct netlist: failed to add destination to net &#39;&quot;</span> + master_net-&gt;get_name() + <span class="stringliteral">&quot;&#39; with ID &quot;</span> + std::to_string(master_net-&gt;get_id()));</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;                    }</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;                }</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;            }</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160; </div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;            <span class="comment">// merge generics and attributes</span></div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [identifier, content] : slave_net-&gt;get_data_map())</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;            {</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;                <span class="keywordflow">if</span> (!master_net-&gt;set_data(std::get&lt;0&gt;(identifier), std::get&lt;1&gt;(identifier), std::get&lt;0&gt;(content), std::get&lt;1&gt;(content)))</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;                {</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;                    <a class="code" href="group__utilities.html#gaccc921ec8323d53efb57a21a8d4be735">log_warning</a>(<span class="stringliteral">&quot;vhdl_parser&quot;</span>,</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;                                <span class="stringliteral">&quot;unable to transfer data from slave net &#39;{}&#39; with ID {} to master net &#39;{}&#39; with ID {}.&quot;</span>,</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;                                slave_net-&gt;get_name(),</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;                                slave_net-&gt;get_id(),</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;                                master_net-&gt;get_name(),</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;                                master_net-&gt;get_id());</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;                }</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;            }</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160; </div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;            <span class="comment">// update module ports</span></div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;            <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> it = m_module_port_by_net.find(slave_net); it != m_module_port_by_net.end())</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;            {</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">auto</span> [<a class="code" href="namespacehal_1_1_shortest_path.html#a6f60f4bfa62d51227fa5fcc3e7d838a9">module</a>, index] : it-&gt;second)</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;                {</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;                    std::get&lt;1&gt;(m_module_ports.at(<a class="code" href="namespacehal_1_1_shortest_path.html#a6f60f4bfa62d51227fa5fcc3e7d838a9">module</a>).at(index)) = master_net;</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;                }</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;                m_module_port_by_net[master_net].insert(m_module_port_by_net[master_net].end(), it-&gt;second.begin(), it-&gt;second.end());</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;                m_module_port_by_net.erase(it);</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;            }</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160; </div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;            m_netlist-&gt;<a class="code" href="classhal_1_1_netlist.html#a3c2fbba09aa1857d44790bbd16c9df4e">delete_net</a>(slave_net);</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;            m_net_by_name.erase(slave);</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;            merged_nets[slave] = master;</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;            master_to_slaves[master].push_back(slave);</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;        }</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160; </div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;        <span class="comment">// annotate all surviving master nets with the net names that where merged into them</span></div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; master_net : m_netlist-&gt;<a class="code" href="classhal_1_1_netlist.html#ac787de6b52a38112735e3ff9bd2b6d17">get_nets</a>())</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;        {</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;            <span class="keyword">const</span> <span class="keyword">auto</span> master_name = master_net-&gt;get_name();</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160; </div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;            <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> m2s_it = master_to_slaves.find(core_strings::to&lt;ci_string&gt;(master_name)); m2s_it != master_to_slaves.end())</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;            {</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;                std::vector&lt;std::vector&lt;ci_string&gt;&gt; merged_slaves;</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;                <span class="keyword">auto</span> current_slaves = m2s_it-&gt;second;</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160; </div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;                <span class="keywordflow">while</span> (!current_slaves.empty())</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;                {</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;                    std::vector&lt;ci_string&gt; next_slaves;</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;                    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; s : current_slaves)</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;                    {</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;                        <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> m2s_inner_it = master_to_slaves.find(s); m2s_inner_it != master_to_slaves.end())</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;                        {</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;                            next_slaves.insert(next_slaves.end(), m2s_inner_it-&gt;second.begin(), m2s_inner_it-&gt;second.end());</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;                        }</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;                    }</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160; </div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;                    merged_slaves.push_back(current_slaves);</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;                    current_slaves = next_slaves;</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;                    next_slaves.clear();</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;                }</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160; </div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;                <span class="comment">// annotate all merged slave wire names as a JSON formatted list of list of strings</span></div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;                <span class="comment">// each net can span a tree of &quot;consumed&quot; slave wire names where the nth list represents all wire names that where merged at depth n</span></div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;                ci_string merged_str = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;                <span class="keywordtype">bool</span> has_merged_nets = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; vec : merged_slaves)</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;                {</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;                    <span class="keywordflow">if</span> (!vec.empty())</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;                    {</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;                        has_merged_nets = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;                    }</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;                    <span class="comment">// const auto s = utils::join(&quot;, &quot;, vec, [](const auto e) { return &#39;&quot;&#39; + e + &#39;&quot;&#39;; });</span></div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;                    ci_string s = vec.empty() ? <span class="stringliteral">&quot;&quot;</span> : vec.front();</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;                    <span class="keywordflow">for</span> (<a class="code" href="net__layout__point_8h.html#aa7fe0c70576e86ca2c5f641bb47ccc9d">u32</a> idx = 1; idx &lt; vec.size(); idx++)</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;                    {</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;                        s += ci_string(<span class="stringliteral">&quot;, &quot;</span>) + vec.at(idx);</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;                    }</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160; </div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;                    merged_str += <span class="stringliteral">&quot;[&quot;</span> + s + <span class="stringliteral">&quot;], &quot;</span>;</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;                }</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;                merged_str = merged_str.substr(0, merged_str.size() - 2);</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160; </div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;                <span class="keywordflow">if</span> (has_merged_nets)</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;                {</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;                    master_net-&gt;set_data(<span class="stringliteral">&quot;parser_annotation&quot;</span>, <span class="stringliteral">&quot;merged_nets&quot;</span>, <span class="stringliteral">&quot;string&quot;</span>, <span class="stringliteral">&quot;[&quot;</span> + core_strings::to&lt;std::string&gt;(merged_str) + <span class="stringliteral">&quot;]&quot;</span>);</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;                }</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;            }</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;        }</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160; </div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;        <span class="comment">// update module nets, internal nets, input nets, and output nets</span></div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;        <span class="keywordflow">for</span> (Module* <a class="code" href="namespacehal_1_1_shortest_path.html#a6f60f4bfa62d51227fa5fcc3e7d838a9">module</a> : m_netlist-&gt;<a class="code" href="classhal_1_1_netlist.html#a7eb17e617d1b20d05fdd146ad63c138b">get_modules</a>())</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;        {</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;            <a class="code" href="namespacehal_1_1_shortest_path.html#a6f60f4bfa62d51227fa5fcc3e7d838a9">module</a>-&gt;<a class="code" href="classhal_1_1_module.html#a02af541336529b5ff7a4babadd43bbdb">update_nets</a>();</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;        }</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160; </div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;        <span class="comment">// assign module pins</span></div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [<a class="code" href="namespacehal_1_1_shortest_path.html#a6f60f4bfa62d51227fa5fcc3e7d838a9">module</a>, ports] : m_module_ports)</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;        {</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [port_name, port_net] : ports)</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;            {</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;                <span class="comment">// check if net is actually a port net</span></div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="namespacehal_1_1_shortest_path.html#a6f60f4bfa62d51227fa5fcc3e7d838a9">module</a>-&gt;<a class="code" href="classhal_1_1_module.html#a009c72540e8a05665c2ca51ab8e62b07">is_input_net</a>(port_net) &amp;&amp; !<a class="code" href="namespacehal_1_1_shortest_path.html#a6f60f4bfa62d51227fa5fcc3e7d838a9">module</a>-&gt;<a class="code" href="classhal_1_1_module.html#a74611022d6c488580fae0106005f7627">is_output_net</a>(port_net))</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;                {</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;                }</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160; </div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;                <span class="keywordflow">if</span> (<span class="keyword">auto</span> res = <a class="code" href="namespacehal_1_1_shortest_path.html#a6f60f4bfa62d51227fa5fcc3e7d838a9">module</a>-&gt;<a class="code" href="classhal_1_1_module.html#ad35559b823f388e85241716ef8189fc9">create_pin</a>(port_name, port_net); res.is_error())</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;                {</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#af20e293cf442ddedc129f87bbb6a69e9">ERR_APPEND</a>(res.get_error(),</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;                                      <span class="stringliteral">&quot;could not construct netlist: failed to create pin &#39;&quot;</span> + port_name + <span class="stringliteral">&quot;&#39; at net &#39;&quot;</span> + port_net-&gt;get_name() + <span class="stringliteral">&quot;&#39; with ID &quot;</span> + std::to_string(port_net-&gt;get_id())</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;                                          + <span class="stringliteral">&quot; within module &#39;&quot;</span> + <a class="code" href="namespacehal_1_1_shortest_path.html#a6f60f4bfa62d51227fa5fcc3e7d838a9">module</a>-&gt;<a class="code" href="classhal_1_1_module.html#a87cf9f30579e5e461f525ab78274e1df">get_name</a>() + <span class="stringliteral">&quot;&#39; with ID &quot;</span> + std::to_string(<a class="code" href="namespacehal_1_1_shortest_path.html#a6f60f4bfa62d51227fa5fcc3e7d838a9">module</a>-&gt;<a class="code" href="classhal_1_1_module.html#af771e486709f93e4abab9f0fe092010b">get_id</a>()));</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;                }</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;            }</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;        }</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160; </div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;        <span class="keywordflow">for</span> (Module* <a class="code" href="namespacehal_1_1_shortest_path.html#a6f60f4bfa62d51227fa5fcc3e7d838a9">module</a> : m_netlist-&gt;<a class="code" href="classhal_1_1_netlist.html#a7eb17e617d1b20d05fdd146ad63c138b">get_modules</a>())</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;        {</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;            std::unordered_set&lt;Net*&gt; input_nets  = <a class="code" href="namespacehal_1_1_shortest_path.html#a6f60f4bfa62d51227fa5fcc3e7d838a9">module</a>-&gt;<a class="code" href="classhal_1_1_module.html#a8e83b6de125c04f00e5cdc18580bed8d">get_input_nets</a>();</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;            std::unordered_set&lt;Net*&gt; output_nets = <a class="code" href="namespacehal_1_1_shortest_path.html#a6f60f4bfa62d51227fa5fcc3e7d838a9">module</a>-&gt;<a class="code" href="classhal_1_1_module.html#a8e83b6de125c04f00e5cdc18580bed8d">get_input_nets</a>();</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160; </div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;            <span class="keywordflow">if</span> ((<a class="code" href="namespacehal_1_1_shortest_path.html#a6f60f4bfa62d51227fa5fcc3e7d838a9">module</a>-&gt;<a class="code" href="classhal_1_1_module.html#ab8cd2075036048e2fb55b1e62828a865">get_pin_by_net</a>(m_one_net) == <span class="keyword">nullptr</span>) &amp;&amp; (input_nets.find(m_one_net) != input_nets.end() || output_nets.find(m_one_net) != input_nets.end()))</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;            {</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;                <span class="keywordflow">if</span> (<span class="keyword">auto</span> res = <a class="code" href="namespacehal_1_1_shortest_path.html#a6f60f4bfa62d51227fa5fcc3e7d838a9">module</a>-&gt;<a class="code" href="classhal_1_1_module.html#ad35559b823f388e85241716ef8189fc9">create_pin</a>(<span class="stringliteral">&quot;&#39;1&#39;&quot;</span>, m_one_net); res.is_error())</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;                {</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#af20e293cf442ddedc129f87bbb6a69e9">ERR_APPEND</a>(res.get_error(),</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;                                      <span class="stringliteral">&quot;could not construct netlist: failed to create pin &#39;1&#39; at net &#39;&quot;</span> + m_one_net-&gt;<a class="code" href="classhal_1_1_net.html#a4627e0be693c99fece29559be12898bd">get_name</a>() + <span class="stringliteral">&quot;&#39; with ID &quot;</span> + std::to_string(m_one_net-&gt;<a class="code" href="classhal_1_1_net.html#a086e0fa561405ac8b0beae95d8caa69d">get_id</a>()) + <span class="stringliteral">&quot;within module &#39;&quot;</span></div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;                                          + <a class="code" href="namespacehal_1_1_shortest_path.html#a6f60f4bfa62d51227fa5fcc3e7d838a9">module</a>-&gt;<a class="code" href="classhal_1_1_module.html#a87cf9f30579e5e461f525ab78274e1df">get_name</a>() + <span class="stringliteral">&quot;&#39; with ID &quot;</span> + std::to_string(<a class="code" href="namespacehal_1_1_shortest_path.html#a6f60f4bfa62d51227fa5fcc3e7d838a9">module</a>-&gt;<a class="code" href="classhal_1_1_module.html#af771e486709f93e4abab9f0fe092010b">get_id</a>()));</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;                }</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;            }</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160; </div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;            <span class="keywordflow">if</span> ((<a class="code" href="namespacehal_1_1_shortest_path.html#a6f60f4bfa62d51227fa5fcc3e7d838a9">module</a>-&gt;<a class="code" href="classhal_1_1_module.html#ab8cd2075036048e2fb55b1e62828a865">get_pin_by_net</a>(m_zero_net) == <span class="keyword">nullptr</span>) &amp;&amp; (input_nets.find(m_zero_net) != input_nets.end() || output_nets.find(m_zero_net) != input_nets.end()))</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;            {</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;                <span class="keywordflow">if</span> (<span class="keyword">auto</span> res = <a class="code" href="namespacehal_1_1_shortest_path.html#a6f60f4bfa62d51227fa5fcc3e7d838a9">module</a>-&gt;<a class="code" href="classhal_1_1_module.html#ad35559b823f388e85241716ef8189fc9">create_pin</a>(<span class="stringliteral">&quot;&#39;0&#39;&quot;</span>, m_zero_net); res.is_error())</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;                {</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#af20e293cf442ddedc129f87bbb6a69e9">ERR_APPEND</a>(res.get_error(),</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;                                      <span class="stringliteral">&quot;could not construct netlist: failed to create pin &#39;0&#39; at net &#39;&quot;</span> + m_zero_net-&gt;<a class="code" href="classhal_1_1_net.html#a4627e0be693c99fece29559be12898bd">get_name</a>() + <span class="stringliteral">&quot;&#39; with ID &quot;</span> + std::to_string(m_zero_net-&gt;<a class="code" href="classhal_1_1_net.html#a086e0fa561405ac8b0beae95d8caa69d">get_id</a>())</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;                                          + <span class="stringliteral">&quot;within module &#39;&quot;</span> + <a class="code" href="namespacehal_1_1_shortest_path.html#a6f60f4bfa62d51227fa5fcc3e7d838a9">module</a>-&gt;<a class="code" href="classhal_1_1_module.html#a87cf9f30579e5e461f525ab78274e1df">get_name</a>() + <span class="stringliteral">&quot;&#39; with ID &quot;</span> + std::to_string(<a class="code" href="namespacehal_1_1_shortest_path.html#a6f60f4bfa62d51227fa5fcc3e7d838a9">module</a>-&gt;<a class="code" href="classhal_1_1_module.html#af771e486709f93e4abab9f0fe092010b">get_id</a>()));</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;                }</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;            }</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;        }</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160; </div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;        m_netlist-&gt;<a class="code" href="classhal_1_1_netlist.html#a5fd4f32302dcb8dbcdc4b512d586fee9">enable_automatic_net_checks</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a5ad667153a89697b109f5b8e64da7fe7">OK</a>({});</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;    }</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160; </div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;    Result&lt;Module*&gt;</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;        VHDLParser::instantiate_entity(<span class="keyword">const</span> ci_string&amp; instance_identifier, VhdlEntity* vhdl_entity, Module* parent, <span class="keyword">const</span> std::unordered_map&lt;ci_string, ci_string&gt;&amp; parent_module_assignments)</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;    {</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;        std::unordered_map&lt;ci_string, ci_string&gt; signal_alias;</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;        std::unordered_map&lt;ci_string, ci_string&gt; instance_alias;</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160; </div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;        <span class="comment">// TODO check parent module assignments for port aliases</span></div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160; </div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;        <span class="keyword">const</span> std::string parent_name       = parent == (<span class="keyword">nullptr</span>) ? <span class="stringliteral">&quot;&quot;</span> : parent-&gt;get_name();</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;        instance_alias[instance_identifier] = get_unique_alias(core_strings::to&lt;ci_string&gt;(parent_name), instance_identifier, m_instance_name_occurrences);</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160; </div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;        <span class="comment">// create netlist module</span></div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;        <a class="code" href="group__gui.html#ggaab0cd38a41c1215ae70822b1d501daa1ae55f75a29310d7b60f7ac1d390c8ae42">Module</a>* <a class="code" href="namespacehal_1_1_shortest_path.html#a6f60f4bfa62d51227fa5fcc3e7d838a9">module</a>;</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;        <span class="keywordflow">if</span> (parent == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;        {</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;            <a class="code" href="namespacehal_1_1_shortest_path.html#a6f60f4bfa62d51227fa5fcc3e7d838a9">module</a> = m_netlist-&gt;<a class="code" href="classhal_1_1_netlist.html#a0b4333d865d8813103a495745a30c817">get_top_module</a>();</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;            <a class="code" href="namespacehal_1_1_shortest_path.html#a6f60f4bfa62d51227fa5fcc3e7d838a9">module</a>-&gt;<a class="code" href="classhal_1_1_module.html#a00c72047157e9a34c9706d2685a90a13">set_name</a>(core_strings::to&lt;std::string&gt;(instance_alias.at(instance_identifier)));</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;        }</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;        {</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;            <a class="code" href="namespacehal_1_1_shortest_path.html#a6f60f4bfa62d51227fa5fcc3e7d838a9">module</a> = m_netlist-&gt;<a class="code" href="classhal_1_1_netlist.html#af2441daee88b306451caa9265d37d78c">create_module</a>(core_strings::to&lt;std::string&gt;(instance_alias.at(instance_identifier)), parent);</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;        }</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160; </div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;        ci_string instance_type = vhdl_entity-&gt;m_name;</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacehal_1_1_shortest_path.html#a6f60f4bfa62d51227fa5fcc3e7d838a9">module</a> == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;        {</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not create instance &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(instance_identifier) + <span class="stringliteral">&quot;&#39; of type &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(instance_type)</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;                       + <span class="stringliteral">&quot;&#39;: failed to create module&quot;</span>);</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;        }</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;        <a class="code" href="namespacehal_1_1_shortest_path.html#a6f60f4bfa62d51227fa5fcc3e7d838a9">module</a>-&gt;<a class="code" href="classhal_1_1_module.html#a9bcc555241bfad8b6abccaecb2f021ce">set_type</a>(core_strings::to&lt;std::string&gt;(instance_type));</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160; </div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;        <span class="comment">// assign entity-level attributes</span></div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> VhdlDataEntry&amp; attribute : vhdl_entity-&gt;m_attributes)</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;        {</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="namespacehal_1_1_shortest_path.html#a6f60f4bfa62d51227fa5fcc3e7d838a9">module</a>-&gt;<a class="code" href="classhal_1_1_data_container.html#ab5cb9be187148a5be1f9ee9e558df2c9">set_data</a>(<span class="stringliteral">&quot;attribute&quot;</span>, attribute.m_name, attribute.m_type, attribute.m_value))</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;            {</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;                <a class="code" href="group__utilities.html#gaccc921ec8323d53efb57a21a8d4be735">log_warning</a>(<span class="stringliteral">&quot;vhdl_parser&quot;</span>,</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;                            <span class="stringliteral">&quot;could not set attribute &#39;{} = {}&#39; of type &#39;{}&#39; for instance &#39;{}&#39; type &#39;{}&#39;.&quot;</span>,</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;                            attribute.m_name,</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;                            attribute.m_value,</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;                            attribute.m_type,</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;                            instance_identifier,</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;                            instance_type);</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;            }</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;        }</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160; </div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;        <span class="comment">// assign module port names</span></div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; port : vhdl_entity-&gt;m_ports)</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;        {</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; expanded_port_identifier : port-&gt;m_expanded_identifiers)</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;            {</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;                <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> it = parent_module_assignments.find(expanded_port_identifier); it != parent_module_assignments.end())</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;                {</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;                    <a class="code" href="group__gui.html#ggaab0cd38a41c1215ae70822b1d501daa1a5012af45088eb8e999bb8350077b12ca">Net</a>* port_net = m_net_by_name.at(it-&gt;second);</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;                    m_module_ports[<a class="code" href="namespacehal_1_1_shortest_path.html#a6f60f4bfa62d51227fa5fcc3e7d838a9">module</a>].push_back(std::make_pair(core_strings::to&lt;std::string&gt;(expanded_port_identifier), port_net));</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;                    m_module_port_by_net[port_net].push_back(std::make_pair(<a class="code" href="namespacehal_1_1_shortest_path.html#a6f60f4bfa62d51227fa5fcc3e7d838a9">module</a>, m_module_ports[<a class="code" href="namespacehal_1_1_shortest_path.html#a6f60f4bfa62d51227fa5fcc3e7d838a9">module</a>].size() - 1));</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;                }</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;            }</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;        }</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160; </div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;        <span class="comment">// create internal signals</span></div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; signal : vhdl_entity-&gt;m_signals)</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;        {</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; expanded_name : signal-&gt;m_expanded_names)</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;            {</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;                signal_alias[expanded_name] = get_unique_alias(instance_alias[instance_identifier], expanded_name, m_signal_name_occurrences);</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160; </div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;                <span class="comment">// create new net for the signal</span></div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;                <a class="code" href="group__gui.html#ggaab0cd38a41c1215ae70822b1d501daa1a5012af45088eb8e999bb8350077b12ca">Net</a>* signal_net = m_netlist-&gt;<a class="code" href="classhal_1_1_netlist.html#a4735650221335f256fa7ce8d88c6f551">create_net</a>(core_strings::to&lt;std::string&gt;(signal_alias.at(expanded_name)));</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;                <span class="keywordflow">if</span> (signal_net == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;                {</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not create instance &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(instance_identifier) + <span class="stringliteral">&quot;&#39; of type &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(instance_type)</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;                               + <span class="stringliteral">&quot;&#39;: failed to create net &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(expanded_name) + <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;                }</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160; </div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;                m_net_by_name[signal_alias.at(expanded_name)] = signal_net;</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160; </div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;                <span class="comment">// assign signal attributes</span></div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">const</span> VhdlDataEntry&amp; attribute : signal-&gt;m_attributes)</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;                {</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;                    <span class="keywordflow">if</span> (!signal_net-&gt;set_data(<span class="stringliteral">&quot;attribute&quot;</span>, attribute.m_name, attribute.m_type, attribute.m_value))</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;                    {</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;                        <a class="code" href="group__utilities.html#gaccc921ec8323d53efb57a21a8d4be735">log_warning</a>(<span class="stringliteral">&quot;vhdl_parser&quot;</span>,</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;                                    <span class="stringliteral">&quot;could not set attribute ({} = {}) for net &#39;{}&#39; of instance &#39;{}&#39; of type &#39;{}&#39;.&quot;</span>,</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;                                    attribute.m_name,</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;                                    attribute.m_value,</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;                                    expanded_name,</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;                                    instance_identifier,</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;                                    instance_type);</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;                    }</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;                }</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;            }</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;        }</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160; </div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;        <span class="comment">// schedule assigned nets for merging</span></div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [left_expanded_signal, right_expanded_signal] : vhdl_entity-&gt;m_expanded_assignments)</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;        {</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;            ci_string a = left_expanded_signal;</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;            ci_string b = right_expanded_signal;</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160; </div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;            <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> alias_it = signal_alias.find(a); alias_it != signal_alias.end())</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;            {</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;                a = alias_it-&gt;second;</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;            }</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;            {</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not create instance &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(instance_identifier) + <span class="stringliteral">&quot;&#39; of type &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(instance_type)</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;                           + <span class="stringliteral">&quot;&#39;: failed to find alias for net &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(a) + <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;            }</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160; </div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;            <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> alias_it = signal_alias.find(b); alias_it != signal_alias.end())</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;            {</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;                b = alias_it-&gt;second;</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;            }</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (b == <span class="stringliteral">&quot;&#39;Z&#39;&quot;</span> || b == <span class="stringliteral">&quot;&#39;X&#39;&quot;</span>)</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;            {</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;            }</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (b != <span class="stringliteral">&quot;&#39;0&#39;&quot;</span> &amp;&amp; b != <span class="stringliteral">&quot;&#39;1&#39;&quot;</span>)</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;            {</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not create instance &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(instance_identifier) + <span class="stringliteral">&quot;&#39; of type &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(instance_type)</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;                           + <span class="stringliteral">&quot;&#39;: failed to find alias for net &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(b) + <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;            }</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160; </div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;            m_nets_to_merge.push_back(std::make_pair(a, b));</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;        }</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160; </div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;        <span class="comment">// schedule assigned port nets for merging</span></div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [port_expression, net_name] : parent_module_assignments)</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;        {</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;            <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> alias_it = signal_alias.find(port_expression); alias_it != signal_alias.end())</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;            {</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">bool</span> swap = net_name.find(<span class="stringliteral">&quot;__GLOBAL_IO__&quot;</span>) == std::string::npos;</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;                m_nets_to_merge.push_back(swap ? std::make_pair(net_name, alias_it-&gt;second) : std::make_pair(alias_it-&gt;second, net_name));</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;            }</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;            {</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not create instance &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(instance_identifier) + <span class="stringliteral">&quot;&#39; of type &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(instance_type)</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;                           + <span class="stringliteral">&quot;&#39;: failed to find alias for net &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(port_expression) + <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;            }</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;        }</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160; </div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;        <span class="comment">// process instances i.e. gates or other entities</span></div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; instance : vhdl_entity-&gt;m_instances)</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;        {</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;            <span class="comment">// will later hold either module or gate, so attributes can be assigned properly</span></div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;            DataContainer* container = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160; </div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;            <span class="comment">// assign actual signal names to ports</span></div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;            std::unordered_map&lt;ci_string, ci_string&gt; instance_assignments;</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160; </div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;            <span class="comment">// if the instance is another entity, recursively instantiate it</span></div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;            <span class="keywordflow">if</span> (<span class="keyword">auto</span> entity_it = m_entities_by_name.find(instance-&gt;m_type); entity_it != m_entities_by_name.end())</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;            {</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;                <span class="comment">// expand port assignments</span></div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [port, assignment] : instance-&gt;m_expanded_port_assignments)</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;                {</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;                    <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> alias_it = signal_alias.find(assignment); alias_it != signal_alias.end())</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;                    {</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;                        instance_assignments[port] = alias_it-&gt;second;</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;                    }</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (assignment == <span class="stringliteral">&quot;&#39;0&#39;&quot;</span> || assignment == <span class="stringliteral">&quot;&#39;1&#39;&quot;</span>)</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;                    {</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;                        instance_assignments[port] = assignment;</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;                    }</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (assignment == <span class="stringliteral">&quot;&#39;Z&#39;&quot;</span> || assignment == <span class="stringliteral">&quot;&#39;X&#39;&quot;</span> || assignment == <span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;                    {</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;                        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;                    }</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;                    {</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not create instance &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(instance_identifier) + <span class="stringliteral">&quot;&#39; of type &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(instance_type)</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;                                   + <span class="stringliteral">&quot;&#39;: port assignment &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(port) + <span class="stringliteral">&quot; = &quot;</span> + core_strings::to&lt;std::string&gt;(assignment) + <span class="stringliteral">&quot;&#39; is invalid&quot;</span>);</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;                    }</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;                }</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160; </div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;                <span class="keywordflow">if</span> (<span class="keyword">auto</span> res = instantiate_entity(instance-&gt;m_name, entity_it-&gt;second, <a class="code" href="namespacehal_1_1_shortest_path.html#a6f60f4bfa62d51227fa5fcc3e7d838a9">module</a>, instance_assignments); res.is_error())</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;                {</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#af20e293cf442ddedc129f87bbb6a69e9">ERR_APPEND</a>(res.get_error(),</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;                                      <span class="stringliteral">&quot;could not create instance &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(instance_identifier) + <span class="stringliteral">&quot;&#39; of type &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(instance_type)</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;                                          + <span class="stringliteral">&quot;&#39;: unable to create instance &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(instance-&gt;m_name) + <span class="stringliteral">&quot;&#39; of type &#39;&quot;</span></div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;                                          + core_strings::to&lt;std::string&gt;(entity_it-&gt;second-&gt;m_name) + <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;                }</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;                {</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;                    container = res.get();</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;                }</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;            }</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;            <span class="comment">// otherwise it has to be an element from the gate library</span></div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> gate_type_it = m_gate_types.find(instance-&gt;m_type); gate_type_it != m_gate_types.end())</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;            {</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;                <span class="comment">// create the new gate</span></div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;                instance_alias[instance-&gt;m_name] = get_unique_alias(instance_alias[instance_identifier], instance-&gt;m_name, m_instance_name_occurrences);</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160; </div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;                <a class="code" href="group__gui.html#ggaab0cd38a41c1215ae70822b1d501daa1ad25b4bd4c72aa2c07ee87adb10b59f16">Gate</a>* new_gate = m_netlist-&gt;<a class="code" href="classhal_1_1_netlist.html#aaeb832a880bee7804dd2bd7cfd6adfd4">create_gate</a>(gate_type_it-&gt;second, core_strings::to&lt;std::string&gt;(instance_alias.at(instance-&gt;m_name)));</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;                <span class="keywordflow">if</span> (new_gate == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;                {</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not create instance &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(instance_identifier) + <span class="stringliteral">&quot;&#39; of type &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(instance_type)</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;                               + <span class="stringliteral">&quot;&#39;: failed to create gate &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(instance-&gt;m_name) + <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;                }</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160; </div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="namespacehal_1_1_shortest_path.html#a6f60f4bfa62d51227fa5fcc3e7d838a9">module</a>-&gt;<a class="code" href="classhal_1_1_module.html#a5ed13732e904b8bf1b3bc670f637acc2">is_top_module</a>())</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;                {</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;                    <a class="code" href="namespacehal_1_1_shortest_path.html#a6f60f4bfa62d51227fa5fcc3e7d838a9">module</a>-&gt;<a class="code" href="classhal_1_1_module.html#a7446c45dc94cefbf49a51261e0299e1d">assign_gate</a>(new_gate);</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;                }</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160; </div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;                container = new_gate;</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160; </div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;                <span class="comment">// if gate is of a GND or VCC gate type, mark it as such</span></div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;                <span class="keywordflow">if</span> (m_vcc_gate_types.find(instance-&gt;m_type) != m_vcc_gate_types.end() &amp;&amp; !new_gate-&gt;mark_vcc_gate())</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;                {</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not create instance &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(instance_identifier) + <span class="stringliteral">&quot;&#39; of type &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(instance_type) + <span class="stringliteral">&quot;&#39;: failed to mark &#39;&quot;</span></div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;                               + core_strings::to&lt;std::string&gt;(instance-&gt;m_name) + <span class="stringliteral">&quot;&#39; of type &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(instance-&gt;m_type) + <span class="stringliteral">&quot;&#39; as GND gate&quot;</span>);</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;                }</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;                <span class="keywordflow">if</span> (m_gnd_gate_types.find(instance-&gt;m_type) != m_gnd_gate_types.end() &amp;&amp; !new_gate-&gt;mark_gnd_gate())</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;                {</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not create instance &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(instance_identifier) + <span class="stringliteral">&quot;&#39; of type &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(instance_type) + <span class="stringliteral">&quot;&#39;: failed to mark &#39;&quot;</span></div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;                               + core_strings::to&lt;std::string&gt;(instance-&gt;m_name) + <span class="stringliteral">&quot;&#39; of type &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(instance-&gt;m_type) + <span class="stringliteral">&quot;&#39; as VCC gate&quot;</span>);</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;                }</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160; </div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;                <span class="comment">// cache pin names</span></div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;                std::unordered_map&lt;ci_string, GatePin*&gt; pin_names_map;</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">auto</span>* pin : gate_type_it-&gt;second-&gt;get_pins())</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;                {</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;                    pin_names_map[core_strings::to&lt;ci_string&gt;(pin-&gt;get_name())] = pin;</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;                }</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160; </div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;                <span class="comment">// expand pin assignments</span></div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [pin, assignment] : instance-&gt;m_expanded_port_assignments)</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;                {</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;                    ci_string signal;</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160; </div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;                    <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> alias_it = signal_alias.find(assignment); alias_it != signal_alias.end())</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;                    {</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;                        signal = alias_it-&gt;second;</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;                    }</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (assignment == <span class="stringliteral">&quot;&#39;0&#39;&quot;</span> || assignment == <span class="stringliteral">&quot;&#39;1&#39;&quot;</span>)</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;                    {</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;                        signal = assignment;</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;                    }</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (assignment == <span class="stringliteral">&quot;&#39;Z&#39;&quot;</span> || assignment == <span class="stringliteral">&quot;&#39;X&#39;&quot;</span> || assignment == <span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;                    {</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;                        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;                    }</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;                    {</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not create instance &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(instance_identifier) + <span class="stringliteral">&quot;&#39; of type &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(instance_type)</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;                                   + <span class="stringliteral">&quot;&#39;: failed to assign &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(assignment) + <span class="stringliteral">&quot;&#39; to pin &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(pin) + <span class="stringliteral">&quot;&#39; of gate &#39;&quot;</span></div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;                                   + core_strings::to&lt;std::string&gt;(instance-&gt;m_name) + <span class="stringliteral">&quot;&#39; of type &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(instance-&gt;m_type) + <span class="stringliteral">&quot;&#39; as the assignment is invalid&quot;</span>);</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;                    }</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160; </div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;                    <span class="comment">// get the respective net for the assignment</span></div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;                    <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> net_it = m_net_by_name.find(signal); net_it == m_net_by_name.end())</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;                    {</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not create instance &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(instance_identifier) + <span class="stringliteral">&quot;&#39; of type &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(instance_type)</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;                                   + <span class="stringliteral">&quot;&#39;: failed to assign signal&#39;&quot;</span> + core_strings::to&lt;std::string&gt;(signal) + <span class="stringliteral">&quot;&#39; to pin &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(pin)</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;                                   + <span class="stringliteral">&quot;&#39; as the signal has not been declared&quot;</span>);</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;                    }</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;                    {</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;                        <a class="code" href="group__gui.html#ggaab0cd38a41c1215ae70822b1d501daa1a5012af45088eb8e999bb8350077b12ca">Net</a>* current_net = net_it-&gt;second;</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160; </div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;                        <span class="comment">// add net src/dst by pin types</span></div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;                        <span class="keywordtype">bool</span> is_input  = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;                        <span class="keywordtype">bool</span> is_output = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160; </div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;                        <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> it = pin_names_map.find(pin); it != pin_names_map.end())</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;                        {</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;                            <a class="code" href="namespacehal.html#a119eb4e25d047caa41d83e762cbed8ec">PinDirection</a> <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a924ab95925fc83b38cba3ac2d8d7e9aa">direction</a> = it-&gt;second-&gt;get_direction();</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;                            <span class="keywordflow">if</span> (<a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a924ab95925fc83b38cba3ac2d8d7e9aa">direction</a> == <a class="code" href="namespacehal.html#a119eb4e25d047caa41d83e762cbed8ecaa43c1b0aa53a0c908810c06ab1ff3967">PinDirection::input</a> || <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a924ab95925fc83b38cba3ac2d8d7e9aa">direction</a> == <a class="code" href="namespacehal.html#a119eb4e25d047caa41d83e762cbed8eca54c9ccb45f5ee60133cca31fca024432">PinDirection::inout</a>)</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;                            {</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;                                is_input = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;                            }</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160; </div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;                            <span class="keywordflow">if</span> (<a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a924ab95925fc83b38cba3ac2d8d7e9aa">direction</a> == <a class="code" href="namespacehal.html#a119eb4e25d047caa41d83e762cbed8eca78e6221f6393d1356681db398f14ce6d">PinDirection::output</a> || <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a924ab95925fc83b38cba3ac2d8d7e9aa">direction</a> == <a class="code" href="namespacehal.html#a119eb4e25d047caa41d83e762cbed8eca54c9ccb45f5ee60133cca31fca024432">PinDirection::inout</a>)</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;                            {</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;                                is_output = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;                            }</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;                        }</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160; </div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;                        <span class="keywordflow">if</span> (!is_input &amp;&amp; !is_output)</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;                        {</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;                            <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not create instance &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(instance_identifier) + <span class="stringliteral">&quot;&#39; of type &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(instance_type)</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;                                       + <span class="stringliteral">&quot;&#39;: failed to assign net &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(signal) + <span class="stringliteral">&quot;&#39; to pin &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(pin) + <span class="stringliteral">&quot;&#39; as it is not a pin of gate &#39;&quot;</span></div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;                                       + new_gate-&gt;get_name() + <span class="stringliteral">&quot;&#39; of type &#39;&quot;</span> + new_gate-&gt;get_type()-&gt;get_name() + <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;                        }</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160; </div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;                        <span class="keywordflow">if</span> (is_output &amp;&amp; !current_net-&gt;add_source(new_gate, core_strings::to&lt;std::string&gt;(pin)))</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;                        {</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;                            <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not create instance &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(instance_identifier) + <span class="stringliteral">&quot;&#39; of type &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(instance_type)</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;                                       + <span class="stringliteral">&quot;&#39;: failed to add net &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(signal) + <span class="stringliteral">&quot;&#39; as a source to gate &#39;&quot;</span> + new_gate-&gt;get_name() + <span class="stringliteral">&quot;&#39; via pin &#39;&quot;</span></div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;                                       + core_strings::to&lt;std::string&gt;(pin) + <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;                        }</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160; </div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;                        <span class="keywordflow">if</span> (is_input &amp;&amp; !current_net-&gt;add_destination(new_gate, core_strings::to&lt;std::string&gt;(pin)))</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;                        {</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;                            <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not create instance &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(instance_identifier) + <span class="stringliteral">&quot;&#39; of type &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(instance_type)</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;                                       + <span class="stringliteral">&quot;&#39;: failed to add net &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(signal) + <span class="stringliteral">&quot;&#39; as a destination to gate &#39;&quot;</span> + new_gate-&gt;get_name() + <span class="stringliteral">&quot;&#39; via pin &#39;&quot;</span></div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;                                       + core_strings::to&lt;std::string&gt;(pin) + <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;                        }</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;                    }</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;                }</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;            }</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;            {</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not create instance &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(instance_identifier) + <span class="stringliteral">&quot;&#39; of type &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(instance_type)</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;                           + <span class="stringliteral">&quot;&#39;: failed to find gate type &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(instance-&gt;m_type) + <span class="stringliteral">&quot;&#39; in gate library &#39;&quot;</span> + m_netlist-&gt;<a class="code" href="classhal_1_1_netlist.html#adeae0f508eb65ca66c78d560f89340c2">get_gate_library</a>()-&gt;<a class="code" href="classhal_1_1_gate_library.html#aef64b8371779e27c778227552deb3a6d">get_name</a>() + <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;            }</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160; </div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;            <span class="comment">// assign instance attributes</span></div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; attribute : instance-&gt;m_attributes)</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;            {</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;                <span class="keywordflow">if</span> (!container-&gt;set_data(<span class="stringliteral">&quot;attribute&quot;</span>, attribute.m_name, attribute.m_type, attribute.m_value))</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;                {</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;                    <a class="code" href="group__utilities.html#gaccc921ec8323d53efb57a21a8d4be735">log_warning</a>(<span class="stringliteral">&quot;vhdl_parser&quot;</span>,</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;                                <span class="stringliteral">&quot;could not set attribute &#39;{} = {}&#39; of type &#39;{}&#39; for instance &#39;{}&#39; of type &#39;{}&#39; within instance &#39;{}&#39; of type &#39;{}&#39;.&quot;</span>,</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;                                attribute.m_name,</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;                                attribute.m_value,</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;                                attribute.m_type,</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;                                instance-&gt;m_name,</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;                                instance-&gt;m_type,</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;                                instance_identifier,</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;                                instance_type);</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;                }</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;            }</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160; </div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;            <span class="comment">// process generics</span></div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; <span class="keyword">generic</span> : instance-&gt;m_generics)</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;            {</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;                <span class="keywordflow">if</span> (!container-&gt;set_data(<span class="stringliteral">&quot;generic&quot;</span>, <span class="keyword">generic</span>.m_name, <span class="keyword">generic</span>.m_type, <span class="keyword">generic</span>.m_value))</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;                {</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;                    <a class="code" href="group__utilities.html#gaccc921ec8323d53efb57a21a8d4be735">log_warning</a>(<span class="stringliteral">&quot;vhdl_parser&quot;</span>,</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;                                <span class="stringliteral">&quot;could not set generic &#39;{} = {}&#39; of type &#39;{}&#39; for instance &#39;{}&#39; of type &#39;{}&#39; within instance &#39;{}&#39; of type &#39;{}&#39;.&quot;</span>,</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;                                <span class="keyword">generic</span>.m_name,</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;                                <span class="keyword">generic</span>.m_value,</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;                                <span class="keyword">generic</span>.m_type,</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;                                instance-&gt;m_name,</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;                                instance-&gt;m_type,</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;                                instance_identifier,</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;                                instance_type);</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;                }</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;            }</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;        }</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160; </div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a5ad667153a89697b109f5b8e64da7fe7">OK</a>(<a class="code" href="namespacehal_1_1_shortest_path.html#a6f60f4bfa62d51227fa5fcc3e7d838a9">module</a>);</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;    }</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160; </div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;    <span class="comment">// ###########################################################################</span></div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;    <span class="comment">// ###################          Helper Functions          ####################</span></div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;    <span class="comment">// ###########################################################################</span></div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160; </div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;    <span class="keyword">namespace</span></div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;    {</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;        <span class="keyword">const</span> <span class="keyword">static</span> std::map&lt;core_strings::CaseInsensitiveString, size_t&gt; id_to_dim = {{<span class="stringliteral">&quot;std_logic_vector&quot;</span>, 1}, {<span class="stringliteral">&quot;std_logic_vector2&quot;</span>, 2}, {<span class="stringliteral">&quot;std_logic_vector3&quot;</span>, 3}};</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160; </div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;        <span class="keyword">static</span> <span class="keyword">const</span> std::map&lt;char, BooleanFunction::Value&gt; bin_map = {{<span class="charliteral">&#39;0&#39;</span>, BooleanFunction::Value::ZERO},</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;                                                                       {<span class="charliteral">&#39;1&#39;</span>, BooleanFunction::Value::ONE},</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;                                                                       {<span class="charliteral">&#39;X&#39;</span>, BooleanFunction::Value::X},</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;                                                                       {<span class="charliteral">&#39;Z&#39;</span>, BooleanFunction::Value::Z}};</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160; </div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;        <span class="keyword">static</span> <span class="keyword">const</span> std::map&lt;char, std::vector&lt;BooleanFunction::Value&gt;&gt; oct_map = {{<span class="charliteral">&#39;0&#39;</span>, {BooleanFunction::Value::ZERO, BooleanFunction::Value::ZERO, BooleanFunction::Value::ZERO}},</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;                                                                                    {<span class="charliteral">&#39;1&#39;</span>, {BooleanFunction::Value::ONE, BooleanFunction::Value::ZERO, BooleanFunction::Value::ZERO}},</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;                                                                                    {<span class="charliteral">&#39;2&#39;</span>, {BooleanFunction::Value::ZERO, BooleanFunction::Value::ONE, BooleanFunction::Value::ZERO}},</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;                                                                                    {<span class="charliteral">&#39;3&#39;</span>, {BooleanFunction::Value::ONE, BooleanFunction::Value::ONE, BooleanFunction::Value::ZERO}},</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;                                                                                    {<span class="charliteral">&#39;4&#39;</span>, {BooleanFunction::Value::ZERO, BooleanFunction::Value::ZERO, BooleanFunction::Value::ONE}},</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;                                                                                    {<span class="charliteral">&#39;5&#39;</span>, {BooleanFunction::Value::ONE, BooleanFunction::Value::ZERO, BooleanFunction::Value::ONE}},</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;                                                                                    {<span class="charliteral">&#39;6&#39;</span>, {BooleanFunction::Value::ZERO, BooleanFunction::Value::ONE, BooleanFunction::Value::ONE}},</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;                                                                                    {<span class="charliteral">&#39;7&#39;</span>, {BooleanFunction::Value::ONE, BooleanFunction::Value::ONE, BooleanFunction::Value::ONE}},</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;                                                                                    {<span class="charliteral">&#39;X&#39;</span>, {BooleanFunction::Value::X, BooleanFunction::Value::X, BooleanFunction::Value::X}},</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;                                                                                    {<span class="charliteral">&#39;Z&#39;</span>, {BooleanFunction::Value::Z, BooleanFunction::Value::Z, BooleanFunction::Value::Z}}};</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160; </div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;        <span class="keyword">static</span> <span class="keyword">const</span> std::map&lt;char, std::vector&lt;BooleanFunction::Value&gt;&gt; hex_map = {</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;            {<span class="charliteral">&#39;0&#39;</span>, {BooleanFunction::Value::ZERO, BooleanFunction::Value::ZERO, BooleanFunction::Value::ZERO, BooleanFunction::Value::ZERO}},</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;            {<span class="charliteral">&#39;1&#39;</span>, {BooleanFunction::Value::ONE, BooleanFunction::Value::ZERO, BooleanFunction::Value::ZERO, BooleanFunction::Value::ZERO}},</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;            {<span class="charliteral">&#39;2&#39;</span>, {BooleanFunction::Value::ZERO, BooleanFunction::Value::ONE, BooleanFunction::Value::ZERO, BooleanFunction::Value::ZERO}},</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;            {<span class="charliteral">&#39;3&#39;</span>, {BooleanFunction::Value::ONE, BooleanFunction::Value::ONE, BooleanFunction::Value::ZERO, BooleanFunction::Value::ZERO}},</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;            {<span class="charliteral">&#39;4&#39;</span>, {BooleanFunction::Value::ZERO, BooleanFunction::Value::ZERO, BooleanFunction::Value::ONE, BooleanFunction::Value::ZERO}},</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;            {<span class="charliteral">&#39;5&#39;</span>, {BooleanFunction::Value::ONE, BooleanFunction::Value::ZERO, BooleanFunction::Value::ONE, BooleanFunction::Value::ZERO}},</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;            {<span class="charliteral">&#39;6&#39;</span>, {BooleanFunction::Value::ZERO, BooleanFunction::Value::ONE, BooleanFunction::Value::ONE, BooleanFunction::Value::ZERO}},</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;            {<span class="charliteral">&#39;7&#39;</span>, {BooleanFunction::Value::ONE, BooleanFunction::Value::ONE, BooleanFunction::Value::ONE, BooleanFunction::Value::ZERO}},</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;            {<span class="charliteral">&#39;8&#39;</span>, {BooleanFunction::Value::ZERO, BooleanFunction::Value::ZERO, BooleanFunction::Value::ZERO, BooleanFunction::Value::ONE}},</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;            {<span class="charliteral">&#39;9&#39;</span>, {BooleanFunction::Value::ONE, BooleanFunction::Value::ZERO, BooleanFunction::Value::ZERO, BooleanFunction::Value::ONE}},</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;            {<span class="charliteral">&#39;A&#39;</span>, {BooleanFunction::Value::ZERO, BooleanFunction::Value::ONE, BooleanFunction::Value::ZERO, BooleanFunction::Value::ONE}},</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;            {<span class="charliteral">&#39;B&#39;</span>, {BooleanFunction::Value::ONE, BooleanFunction::Value::ONE, BooleanFunction::Value::ZERO, BooleanFunction::Value::ONE}},</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;            {<span class="charliteral">&#39;C&#39;</span>, {BooleanFunction::Value::ZERO, BooleanFunction::Value::ZERO, BooleanFunction::Value::ONE, BooleanFunction::Value::ONE}},</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;            {<span class="charliteral">&#39;D&#39;</span>, {BooleanFunction::Value::ONE, BooleanFunction::Value::ZERO, BooleanFunction::Value::ONE, BooleanFunction::Value::ONE}},</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;            {<span class="charliteral">&#39;E&#39;</span>, {BooleanFunction::Value::ZERO, BooleanFunction::Value::ONE, BooleanFunction::Value::ONE, BooleanFunction::Value::ONE}},</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;            {<span class="charliteral">&#39;F&#39;</span>, {BooleanFunction::Value::ONE, BooleanFunction::Value::ONE, BooleanFunction::Value::ONE, BooleanFunction::Value::ONE}},</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;            {<span class="charliteral">&#39;X&#39;</span>, {BooleanFunction::Value::X, BooleanFunction::Value::X, BooleanFunction::Value::X, BooleanFunction::Value::X}},</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;            {<span class="charliteral">&#39;Z&#39;</span>, {BooleanFunction::Value::Z, BooleanFunction::Value::Z, BooleanFunction::Value::Z, BooleanFunction::Value::Z}}};</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;    }    <span class="comment">// namespace</span></div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160; </div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;    <span class="comment">// generate a unique name for a gate/module instance</span></div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;    VHDLParser::ci_string VHDLParser::get_unique_alias(<span class="keyword">const</span> ci_string&amp; parent_name, <span class="keyword">const</span> ci_string&amp; <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a>, <span class="keyword">const</span> std::unordered_map&lt;ci_string, u32&gt;&amp; name_occurences)<span class="keyword"> const</span></div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;        ci_string unique_alias = <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a>;</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160; </div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;        <span class="keywordflow">if</span> (!parent_name.empty())</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;        {</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;            <span class="comment">// if there is no other instance with that name, we omit the name prefix</span></div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;            <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> instance_name_it = name_occurences.find(<a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a>); instance_name_it != name_occurences.end() &amp;&amp; instance_name_it-&gt;second &gt; 1)</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;            {</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;                unique_alias = parent_name + ci_string(<span class="stringliteral">&quot;/&quot;</span>) + unique_alias;</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;            }</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;        }</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160; </div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;        <span class="keywordflow">return</span> unique_alias;</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;    }</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160; </div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;    std::vector&lt;u32&gt; VHDLParser::parse_range(TokenStream&lt;ci_string&gt;&amp; range_stream)<span class="keyword"> const</span></div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;        <span class="keywordflow">if</span> (range_stream.remaining() == 1)</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;        {</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;            <span class="keywordflow">return</span> {(<a class="code" href="net__layout__point_8h.html#aa7fe0c70576e86ca2c5f641bb47ccc9d">u32</a>)std::stoi(core_strings::to&lt;std::string&gt;(range_stream.consume().string))};</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;        }</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160; </div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a924ab95925fc83b38cba3ac2d8d7e9aa">direction</a> = 1;</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> end = std::stoi(core_strings::to&lt;std::string&gt;(range_stream.consume().string));</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160; </div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;        <span class="keywordflow">if</span> (range_stream.peek() == <span class="stringliteral">&quot;downto&quot;</span>)</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;        {</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;            range_stream.consume(<span class="stringliteral">&quot;downto&quot;</span>);</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;        }</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;        {</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;            range_stream.consume(<span class="stringliteral">&quot;to&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;            <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a924ab95925fc83b38cba3ac2d8d7e9aa">direction</a> = -1;</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;        }</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160; </div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> start = std::stoi(core_strings::to&lt;std::string&gt;(range_stream.consume().string));</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160; </div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;        std::vector&lt;u32&gt; res;</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = start; i != end + <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a924ab95925fc83b38cba3ac2d8d7e9aa">direction</a>; i += <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a924ab95925fc83b38cba3ac2d8d7e9aa">direction</a>)</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;        {</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;            res.push_back((<a class="code" href="net__layout__point_8h.html#aa7fe0c70576e86ca2c5f641bb47ccc9d">u32</a>)i);</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;        }</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;        <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;    }</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160; </div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;    Result&lt;std::vector&lt;std::vector&lt;u32&gt;&gt;&gt; VHDLParser::parse_signal_ranges(TokenStream&lt;ci_string&gt;&amp; signal_stream)<span class="keyword"> const</span></div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;        std::vector&lt;std::vector&lt;u32&gt;&gt; ranges;</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;        <span class="keyword">const</span> <a class="code" href="net__layout__point_8h.html#aa7fe0c70576e86ca2c5f641bb47ccc9d">u32</a> line_number = signal_stream.peek().number;</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160; </div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;        <span class="keyword">const</span> Token&lt;ci_string&gt; type_name = signal_stream.consume();</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;        <span class="keywordflow">if</span> (type_name == <span class="stringliteral">&quot;std_logic&quot;</span>)</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;        {</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a5ad667153a89697b109f5b8e64da7fe7">OK</a>(ranges);</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;        }</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160; </div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;        signal_stream.consume(<span class="stringliteral">&quot;(&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;        TokenStream&lt;ci_string&gt; signal_bounds_stream = signal_stream.extract_until(<span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160; </div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;        <span class="comment">// process ranges</span></div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;        <span class="keywordflow">do</span></div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;        {</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;            TokenStream&lt;ci_string&gt; bound_stream = signal_bounds_stream.extract_until(<span class="stringliteral">&quot;,&quot;</span>);</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;            ranges.emplace_back(parse_range(bound_stream));</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;        } <span class="keywordflow">while</span> (signal_bounds_stream.consume(<span class="stringliteral">&quot;,&quot;</span>));</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160; </div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;        signal_stream.consume(<span class="stringliteral">&quot;)&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160; </div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;        <span class="keywordflow">if</span> (id_to_dim.find(type_name) != id_to_dim.end())</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;        {</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">size_t</span> dimension = id_to_dim.at(type_name);</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160; </div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;            <span class="keywordflow">if</span> (ranges.size() != dimension)</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;            {</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not parse signal ranges: mismatch of dimensions (line &quot;</span> + std::to_string(line_number) + <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;            }</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;        }</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;        {</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not parse signal ranges: type name &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(type_name.string) + <span class="stringliteral">&quot;&#39; is invalid (line &quot;</span> + std::to_string(line_number) + <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;        }</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160; </div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a5ad667153a89697b109f5b8e64da7fe7">OK</a>(ranges);</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;    }</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160; </div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;    <span class="keywordtype">void</span> VHDLParser::expand_ranges_recursively(std::vector&lt;ci_string&gt;&amp; expanded_names, <span class="keyword">const</span> ci_string&amp; current_name, <span class="keyword">const</span> std::vector&lt;std::vector&lt;u32&gt;&gt;&amp; ranges, <a class="code" href="net__layout__point_8h.html#aa7fe0c70576e86ca2c5f641bb47ccc9d">u32</a> dimension)<span class="keyword"> const</span></div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;        <span class="comment">// expand signal recursively</span></div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;        <span class="keywordflow">if</span> (ranges.size() &gt; dimension)</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;        {</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">const</span> <a class="code" href="net__layout__point_8h.html#aa7fe0c70576e86ca2c5f641bb47ccc9d">u32</a> index : ranges[dimension])</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;            {</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;                expand_ranges_recursively(expanded_names, current_name + <span class="stringliteral">&quot;(&quot;</span> + core_strings::to&lt;ci_string&gt;(std::to_string(index)) + <span class="stringliteral">&quot;)&quot;</span>, ranges, dimension + 1);</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;            }</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;        }</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;        {</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;            <span class="comment">// last dimension</span></div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;            expanded_names.push_back(current_name);</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;        }</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;    }</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160; </div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;    std::vector&lt;VHDLParser::ci_string&gt; VHDLParser::expand_ranges(<span class="keyword">const</span> ci_string&amp; <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a>, <span class="keyword">const</span> std::vector&lt;std::vector&lt;u32&gt;&gt;&amp; ranges)<span class="keyword"> const</span></div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;        std::vector&lt;ci_string&gt; res;</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160; </div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;        expand_ranges_recursively(res, <a class="code" href="netlist_2persistent_2netlist__serializer_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a>, ranges, 0);</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160; </div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;        <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;    }</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160; </div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;    Result&lt;std::vector&lt;BooleanFunction::Value&gt;&gt; VHDLParser::get_binary_vector(std::string value)<span class="keyword"> const</span></div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;        value = <a class="code" href="namespacehal_1_1utils.html#ac4b3b46a9b2575322a0a296daac79828">utils::to_upper</a>(<a class="code" href="namespacehal_1_1utils.html#a0b35fa35b17eeadefc578daab0de6c06">utils::replace</a>(value, std::string(<span class="stringliteral">&quot;_&quot;</span>), std::string(<span class="stringliteral">&quot;&quot;</span>)));</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160; </div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;        std::string prefix;</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;        std::string number;</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;        std::vector&lt;BooleanFunction::Value&gt; result;</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160; </div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;        <span class="comment">// base specified?</span></div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;        <span class="keywordflow">if</span> (value.at(0) != <span class="charliteral">&#39;\&quot;&#39;</span>)</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;        {</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;            prefix = value.at(0);</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;            number = value.substr(2, value.rfind(<span class="charliteral">&#39;\&quot;&#39;</span>) - 2);</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;        }</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;        {</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;            prefix = <span class="stringliteral">&quot;B&quot;</span>;</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;            number = value.substr(1, value.rfind(<span class="charliteral">&#39;\&quot;&#39;</span>) - 1);</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;        }</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160; </div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;        <span class="comment">// select base</span></div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;        <span class="keywordflow">switch</span> (prefix.at(0))</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;        {</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;B&#39;</span>: {</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = number.rbegin(); it != number.rend(); it++)</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;                {</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">char</span> c = *it;</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;                    <span class="keywordflow">if</span> (c == <span class="charliteral">&#39;0&#39;</span> || c == <span class="charliteral">&#39;1&#39;</span> || c == <span class="charliteral">&#39;Z&#39;</span> || c == <span class="charliteral">&#39;X&#39;</span>)</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;                    {</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;                        result.push_back(bin_map.at(c));</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;                    }</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;                    {</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not convert string to binary vector: invalid character within binary number literal &#39;&quot;</span> + value + <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;                    }</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;                }</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;            }</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160; </div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;O&#39;</span>:</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = number.rbegin(); it != number.rend(); it++)</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;                {</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">char</span> c = *it;</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;                    <span class="keywordflow">if</span> ((c &gt;= <span class="charliteral">&#39;0&#39;</span> &amp;&amp; c &lt;= <span class="charliteral">&#39;7&#39;</span>) || c == <span class="charliteral">&#39;X&#39;</span> || c == <span class="charliteral">&#39;Z&#39;</span>)</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;                    {</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;                        <span class="keyword">const</span> <span class="keyword">auto</span>&amp; bits = oct_map.at(c);</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;                        result.insert(result.end(), bits.begin(), bits.end());</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;                    }</div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;                    {</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not convert string to binary vector: invalid character within octal number literal &#39;&quot;</span> + value + <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;                    }</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;                }</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160; </div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;D&#39;</span>: {</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;                <a class="code" href="defines_8h.html#a1af9f95651e921615e75917a6dd1b574">u64</a> tmp_val = 0;</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160; </div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keywordtype">char</span> c : number)</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;                {</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;                    <span class="keywordflow">if</span> ((c &gt;= <span class="charliteral">&#39;0&#39;</span> &amp;&amp; c &lt;= <span class="charliteral">&#39;9&#39;</span>))</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;                    {</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;                        tmp_val = (tmp_val * 10) + (c - <span class="charliteral">&#39;0&#39;</span>);</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;                    }</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;                    {</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not convert string to binary vector: invalid character within decimal number literal &#39;&quot;</span> + value + <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;                    }</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;                }</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160; </div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;                <span class="keywordflow">do</span></div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;                {</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;                    result.push_back(((tmp_val &amp; 1) == 1) ? BooleanFunction::Value::ONE : BooleanFunction::Value::ZERO);</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;                    tmp_val &gt;&gt;= 1;</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;                } <span class="keywordflow">while</span> (tmp_val != 0);</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;            }</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160; </div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;H&#39;</span>: {</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = number.rbegin(); it != number.rend(); it++)</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;                {</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">char</span> c = *it;</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;                    <span class="keywordflow">if</span> ((c &gt;= <span class="charliteral">&#39;0&#39;</span> &amp;&amp; c &lt;= <span class="charliteral">&#39;9&#39;</span>) || (c &gt;= <span class="charliteral">&#39;A&#39;</span> &amp;&amp; c &lt;= <span class="charliteral">&#39;F&#39;</span>) || c == <span class="charliteral">&#39;X&#39;</span> || c == <span class="charliteral">&#39;Z&#39;</span>)</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;                    {</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;                        <span class="keyword">const</span> <span class="keyword">auto</span>&amp; bits = hex_map.at(c);</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;                        result.insert(result.end(), bits.begin(), bits.end());</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;                    }</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;                    {</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not convert string to binary vector: invalid character within hexadecimal number literal &#39;&quot;</span> + value + <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;                    }</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;                }</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;            }</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160; </div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;            <span class="keywordflow">default</span>: {</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not convert string to binary vector: invalid base &#39;&quot;</span> + prefix + <span class="stringliteral">&quot;&#39; within number literal &#39;&quot;</span> + value + <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;            }</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;        }</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160; </div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a5ad667153a89697b109f5b8e64da7fe7">OK</a>(result);</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;    }</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160; </div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;    Result&lt;std::string&gt; VHDLParser::get_hex_from_literal(<span class="keyword">const</span> Token&lt;ci_string&gt;&amp; value_token)<span class="keyword"> const</span></div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;        <span class="keyword">const</span> <a class="code" href="net__layout__point_8h.html#aa7fe0c70576e86ca2c5f641bb47ccc9d">u32</a> line_number = value_token.number;</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;        <span class="keyword">const</span> ci_string value = <a class="code" href="namespacehal_1_1utils.html#ac4b3b46a9b2575322a0a296daac79828">utils::to_upper</a>(<a class="code" href="namespacehal_1_1utils.html#a0b35fa35b17eeadefc578daab0de6c06">utils::replace</a>(value_token.string, ci_string(<span class="stringliteral">&quot;_&quot;</span>), ci_string(<span class="stringliteral">&quot;&quot;</span>)));</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160; </div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;        ci_string prefix;</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;        ci_string number;</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;        <a class="code" href="net__layout__point_8h.html#aa7fe0c70576e86ca2c5f641bb47ccc9d">u32</a> base;</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160; </div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;        <span class="comment">// base specified?</span></div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;        <span class="keywordflow">if</span> (value.at(0) != <span class="charliteral">&#39;\&quot;&#39;</span>)</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;        {</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;            prefix = value.at(0);</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;            number = value.substr(2, value.rfind(<span class="charliteral">&#39;\&quot;&#39;</span>) - 2);</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;        }</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;        {</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;            prefix = <span class="stringliteral">&quot;B&quot;</span>;</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;            number = value.substr(1, value.rfind(<span class="charliteral">&#39;\&quot;&#39;</span>) - 1);</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;        }</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160; </div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;        <span class="comment">// select base</span></div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;        <span class="keywordflow">switch</span> (prefix.at(0))</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;        {</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;B&#39;</span>: {</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;                <span class="keywordflow">if</span> (!std::all_of(number.begin(), number.end(), [](<span class="keyword">const</span> <span class="keywordtype">char</span>&amp; c) { return (c &gt;= <span class="stringliteral">&#39;0&#39;</span> &amp;&amp; c &lt;= <span class="stringliteral">&#39;1&#39;</span>); }))</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;                {</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not convert token to hexadecimal string: invalid character within binary number literal &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(value) + <span class="stringliteral">&quot;&#39; (line &quot;</span></div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;                               + std::to_string(line_number) + <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;                }</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160; </div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;                base = 2;</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;            }</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160; </div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;O&#39;</span>: {</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;                <span class="keywordflow">if</span> (!std::all_of(number.begin(), number.end(), [](<span class="keyword">const</span> <span class="keywordtype">char</span>&amp; c) { return (c &gt;= <span class="stringliteral">&#39;0&#39;</span> &amp;&amp; c &lt;= <span class="stringliteral">&#39;7&#39;</span>); }))</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;                {</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not convert token to hexadecimal string: invalid character within ocatl number literal &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(value) + <span class="stringliteral">&quot;&#39; (line &quot;</span></div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;                               + std::to_string(line_number) + <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;                }</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160; </div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;                base = 8;</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;            }</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160; </div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;D&#39;</span>: {</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;                <span class="keywordflow">if</span> (!std::all_of(number.begin(), number.end(), [](<span class="keyword">const</span> <span class="keywordtype">char</span>&amp; c) { return (c &gt;= <span class="stringliteral">&#39;0&#39;</span> &amp;&amp; c &lt;= <span class="stringliteral">&#39;9&#39;</span>); }))</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;                {</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not convert token to hexadecimal string: invalid character within decimal number literal &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(value) + <span class="stringliteral">&quot;&#39; (line &quot;</span></div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;                               + std::to_string(line_number) + <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;                }</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160; </div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;                base = 10;</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;            }</div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160; </div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;X&#39;</span>: {</div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;                std::string res;</div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160; </div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keywordtype">char</span> c : number)</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;                {</div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;                    <span class="keywordflow">if</span> ((c &gt;= <span class="charliteral">&#39;0&#39;</span> &amp;&amp; c &lt;= <span class="charliteral">&#39;9&#39;</span>) || (c &gt;= <span class="charliteral">&#39;A&#39;</span> &amp;&amp; c &lt;= <span class="charliteral">&#39;F&#39;</span>))</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;                    {</div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;                        res += c;</div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;                    }</div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;                    {</div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not convert token to hexadecimal string: invalid character within hexadecimal number literal &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(value) + <span class="stringliteral">&quot;&#39; (line &quot;</span></div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;                                   + std::to_string(line_number) + <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;                    }</div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;                }</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160; </div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a5ad667153a89697b109f5b8e64da7fe7">OK</a>(res);</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;            }</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160; </div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;            <span class="keywordflow">default</span>: {</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not convert token to hexadecimal string: invalid base &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(prefix) + <span class="stringliteral">&quot;&#39; within number literal &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(value)</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;                           + <span class="stringliteral">&quot;&#39; (line &quot;</span> + std::to_string(line_number) + <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;            }</div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;        }</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160; </div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;        std::stringstream ss;</div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;        ss &lt;&lt; std::uppercase &lt;&lt; std::hex &lt;&lt; stoull(core_strings::to&lt;std::string&gt;(number), 0, base);</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a5ad667153a89697b109f5b8e64da7fe7">OK</a>(ss.str());</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;    }</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160; </div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;    Result&lt;std::vector&lt;VHDLParser::assignment_t&gt;&gt; VHDLParser::parse_assignment_expression(TokenStream&lt;ci_string&gt;&amp;&amp; stream)<span class="keyword"> const</span></div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;        <span class="comment">// PARSE ASSIGNMENT</span></div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;        <span class="comment">//   assignment can currently be one of the following:</span></div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;        <span class="comment">//   (1) NAME</span></div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;        <span class="comment">//   (2) NUMBER</span></div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;        <span class="comment">//   (3) NAME(INDEX1, INDEX2, ...)</span></div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;        <span class="comment">//   (4) NAME(BEGIN_INDEX1 to/downto END_INDEX1, BEGIN_INDEX2 to/downto END_INDEX2, ...)</span></div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;        <span class="comment">//   (5) ((1 - 4), (1 - 4), ...)</span></div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160; </div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;        std::vector&lt;TokenStream&lt;ci_string&gt;&gt; parts;</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160; </div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;        <span class="keywordflow">if</span> (stream.size() == 0)</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;        {</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a5ad667153a89697b109f5b8e64da7fe7">OK</a>({});</div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;        }</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160; </div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;        <span class="comment">// (5) ((1 - 4), (1 - 4), ...)</span></div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;        <span class="keywordflow">if</span> (stream.consume(<span class="stringliteral">&quot;(&quot;</span>))</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;        {</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;            <span class="keywordflow">do</span></div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;            {</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;                parts.push_back(stream.extract_until(<span class="stringliteral">&quot;,&quot;</span>));</div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;            } <span class="keywordflow">while</span> (stream.consume(<span class="stringliteral">&quot;,&quot;</span>, <span class="keyword">false</span>));</div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160; </div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;            stream.consume(<span class="stringliteral">&quot;)&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;        }</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;        {</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;            parts.push_back(stream);</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;        }</div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160; </div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;        std::vector&lt;assignment_t&gt; result;</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;        result.reserve(parts.size());</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160; </div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = parts.rbegin(); it != parts.rend(); it++)</div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;        {</div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;            TokenStream&lt;ci_string&gt;&amp; part_stream = *it;</div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160; </div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;            <span class="keyword">const</span> Token&lt;ci_string&gt; signal_name_token = part_stream.consume();</div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;            ci_string signal_name                    = signal_name_token.string;</div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160; </div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;            <span class="comment">// (2) NUMBER</span></div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="namespacehal_1_1utils.html#a2ca8da557f49866efbd3d79be8bf5815">utils::starts_with</a>(signal_name, <a class="code" href="namespacehal_1_1core__strings.html#a939599c80f140610abb0390b66acf8a6">core_strings::CaseInsensitiveString</a>(<span class="stringliteral">&quot;\&quot;&quot;</span>)) || <a class="code" href="namespacehal_1_1utils.html#a2ca8da557f49866efbd3d79be8bf5815">utils::starts_with</a>(signal_name, <a class="code" href="namespacehal_1_1core__strings.html#a939599c80f140610abb0390b66acf8a6">core_strings::CaseInsensitiveString</a>(<span class="stringliteral">&quot;b\&quot;&quot;</span>))</div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;                || <a class="code" href="namespacehal_1_1utils.html#a2ca8da557f49866efbd3d79be8bf5815">utils::starts_with</a>(signal_name, <a class="code" href="namespacehal_1_1core__strings.html#a939599c80f140610abb0390b66acf8a6">core_strings::CaseInsensitiveString</a>(<span class="stringliteral">&quot;o\&quot;&quot;</span>)) || <a class="code" href="namespacehal_1_1utils.html#a2ca8da557f49866efbd3d79be8bf5815">utils::starts_with</a>(signal_name, <a class="code" href="namespacehal_1_1core__strings.html#a939599c80f140610abb0390b66acf8a6">core_strings::CaseInsensitiveString</a>(<span class="stringliteral">&quot;x\&quot;&quot;</span>)))</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;            {</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;                <span class="keywordflow">if</span> (<span class="keyword">auto</span> res = get_binary_vector(core_strings::to&lt;std::string&gt;(signal_name_token.string)); res.is_error())</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;                {</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#af20e293cf442ddedc129f87bbb6a69e9">ERR_APPEND</a>(res.get_error(), <span class="stringliteral">&quot;could not expand assignment signal: unable to convert literal to binary string (line &quot;</span> + std::to_string(signal_name_token.number) + <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;                }</div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;                {</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;                    result.push_back(std::move(res.get()));</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;                }</div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;            }</div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (signal_name == <span class="stringliteral">&quot;&#39;0&#39;&quot;</span>)</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;            {</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;                result.push_back(numeral_t({BooleanFunction::Value::ZERO}));</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;            }</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (signal_name == <span class="stringliteral">&quot;&#39;1&#39;&quot;</span>)</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;            {</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;                result.push_back(numeral_t({BooleanFunction::Value::ONE}));</div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;            }</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (signal_name == <span class="stringliteral">&quot;&#39;X&#39;&quot;</span>)</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;            {</div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;                result.push_back(numeral_t({BooleanFunction::Value::X}));</div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;            }</div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (signal_name == <span class="stringliteral">&quot;&#39;Z&#39;&quot;</span>)</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;            {</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;                result.push_back(numeral_t({BooleanFunction::Value::Z}));</div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;            }</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;            {</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;                <span class="comment">// (3) NAME(INDEX1, INDEX2, ...)</span></div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;                <span class="comment">// (4) NAME(BEGIN_INDEX1 to/downto END_INDEX1, BEGIN_INDEX2 to/downto END_INDEX2, ...)</span></div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;                <span class="keywordflow">if</span> (part_stream.consume(<span class="stringliteral">&quot;(&quot;</span>))</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;                {</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;                    std::vector&lt;std::vector&lt;u32&gt;&gt; ranges;</div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;                    <a class="code" href="net__layout__point_8h.html#aa7fe0c70576e86ca2c5f641bb47ccc9d">u32</a> closing_pos = part_stream.find_next(<span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;                    <span class="keywordflow">do</span></div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;                    {</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;                        TokenStream&lt;ci_string&gt; range_stream = part_stream.extract_until(<span class="stringliteral">&quot;,&quot;</span>, closing_pos);</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;                        ranges.emplace_back(parse_range(range_stream));</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160; </div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;                    } <span class="keywordflow">while</span> (part_stream.consume(<span class="stringliteral">&quot;,&quot;</span>, <span class="keyword">false</span>));</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;                    part_stream.consume(<span class="stringliteral">&quot;)&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;                    result.push_back(ranged_identifier_t({std::move(signal_name), std::move(ranges)}));</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;                }</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;                {</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;                    <span class="comment">// (1) NAME</span></div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;                    result.push_back(std::move(signal_name));</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;                }</div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;            }</div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;        }</div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160; </div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a5ad667153a89697b109f5b8e64da7fe7">OK</a>(result);</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;    }</div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160; </div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;    Result&lt;std::vector&lt;VHDLParser::ci_string&gt;&gt; VHDLParser::expand_assignment_expression(VhdlEntity* vhdl_entity, <span class="keyword">const</span> std::vector&lt;assignment_t&gt;&amp; vars)<span class="keyword"> const</span></div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;        std::vector&lt;ci_string&gt; result;</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; var : vars)</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;        {</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;            <span class="keywordflow">if</span> (<span class="keyword">const</span> identifier_t* identifier = std::get_if&lt;identifier_t&gt;(&amp;var); identifier != <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;            {</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;                <span class="keywordflow">if</span> (identifier-&gt;empty())</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;                {</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;                    result.push_back(*identifier);</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;                }</div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;                std::vector&lt;std::vector&lt;u32&gt;&gt; ranges;</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160; </div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;                <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> signal_it = vhdl_entity-&gt;m_signals_by_name.find(*identifier); signal_it != vhdl_entity-&gt;m_signals_by_name.end())</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;                {</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;                    ranges = signal_it-&gt;second-&gt;m_ranges;</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;                }</div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> port_it = vhdl_entity-&gt;m_ports_by_identifier.find(*identifier); port_it != vhdl_entity-&gt;m_ports_by_identifier.end())</div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;                {</div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;                    ranges = port_it-&gt;second-&gt;m_ranges;</div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;                }</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;                {</div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a>(<span class="stringliteral">&quot;could not expand assignment expression&#39;: &#39;&quot;</span> + core_strings::to&lt;std::string&gt;(*identifier) + <span class="stringliteral">&quot;&#39; is neither a signal nor a port of entity &#39;&quot;</span></div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;                               + core_strings::to&lt;std::string&gt;(vhdl_entity-&gt;m_name) + <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;                }</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160; </div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;                std::vector&lt;ci_string&gt; expanded = expand_ranges(*identifier, ranges);</div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;                result.insert(result.end(), expanded.begin(), expanded.end());</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;            }</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">const</span> ranged_identifier_t* ranged_identifier = std::get_if&lt;ranged_identifier_t&gt;(&amp;var); ranged_identifier != <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;            {</div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;                std::vector&lt;ci_string&gt; expanded = expand_ranges(ranged_identifier-&gt;first, ranged_identifier-&gt;second);</div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;                result.insert(result.end(), expanded.begin(), expanded.end());</div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;            }</div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">const</span> numeral_t* numeral = std::get_if&lt;numeral_t&gt;(&amp;var); numeral != <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;            {</div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">auto</span> value : *numeral)</div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;                {</div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;                    result.push_back(core_strings::to&lt;ci_string&gt;(<span class="stringliteral">&quot;&#39;&quot;</span> + <a class="code" href="classhal_1_1_boolean_function.html#acc5f75a5a1c393c06c89237576f5bb0f">BooleanFunction::to_string</a>(value) + <span class="stringliteral">&quot;&#39;&quot;</span>));</div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;                }</div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;            }</div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;        }</div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160; </div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="include_2hal__core_2utilities_2result_8h.html#a5ad667153a89697b109f5b8e64da7fe7">OK</a>(result);</div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;    }</div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;}    <span class="comment">// namespace hal</span></div>
<div class="ttc" id="a_apache_01_license_8txt_html_aa1b09deb55aa1a0b7f14f7e3eb1004ec"><div class="ttname"><a href="_apache_01_license_8txt.html#aa1b09deb55aa1a0b7f14f7e3eb1004ec">entity</a></div><div class="ttdeci">Apache License January AND DISTRIBUTION Definitions License shall mean the terms and conditions for and distribution as defined by Sections through of this document Licensor shall mean the copyright owner or entity authorized by the copyright owner that is granting the License Legal Entity shall mean the union of the acting entity and all other entities that control are controlled by or are under common control with that entity For the purposes of this definition control direct or to cause the direction or management of such entity</div><div class="ttdef"><b>Definition:</b> <a href="_apache_01_license_8txt_source.html#l00019">Apache License.txt:19</a></div></div>
<div class="ttc" id="aclasshal_1_1_boolean_function_html_acc5f75a5a1c393c06c89237576f5bb0f"><div class="ttname"><a href="classhal_1_1_boolean_function.html#acc5f75a5a1c393c06c89237576f5bb0f">hal::BooleanFunction::to_string</a></div><div class="ttdeci">static std::string to_string(Value value)</div><div class="ttdef"><b>Definition:</b> <a href="netlist_2boolean__function_8cpp_source.html#l00024">boolean_function.cpp:24</a></div></div>
<div class="ttc" id="aclasshal_1_1_data_container_html_ab5cb9be187148a5be1f9ee9e558df2c9"><div class="ttname"><a href="classhal_1_1_data_container.html#ab5cb9be187148a5be1f9ee9e558df2c9">hal::DataContainer::set_data</a></div><div class="ttdeci">bool set_data(const std::string &amp;category, const std::string &amp;key, const std::string &amp;data_type, const std::string &amp;value, const bool log_with_info_level=false)</div><div class="ttdef"><b>Definition:</b> <a href="netlist_2data__container_8cpp_source.html#l00017">data_container.cpp:17</a></div></div>
<div class="ttc" id="aclasshal_1_1_gate_html"><div class="ttname"><a href="classhal_1_1_gate.html">hal::Gate</a></div><div class="ttdef"><b>Definition:</b> <a href="gate_8h_source.html#l00057">gate.h:58</a></div></div>
<div class="ttc" id="aclasshal_1_1_gate_library_html"><div class="ttname"><a href="classhal_1_1_gate_library.html">hal::GateLibrary</a></div><div class="ttdef"><b>Definition:</b> <a href="gate__library_8h_source.html#l00043">gate_library.h:44</a></div></div>
<div class="ttc" id="aclasshal_1_1_gate_library_html_a4af85f352307e0cead8336be95cf2fea"><div class="ttname"><a href="classhal_1_1_gate_library.html#a4af85f352307e0cead8336be95cf2fea">hal::GateLibrary::get_gate_types</a></div><div class="ttdeci">std::unordered_map&lt; std::string, GateType * &gt; get_gate_types(const std::function&lt; bool(const GateType *)&gt; &amp;filter=nullptr) const</div><div class="ttdef"><b>Definition:</b> <a href="netlist_2gate__library_2gate__library_8cpp_source.html#l00139">gate_library.cpp:139</a></div></div>
<div class="ttc" id="aclasshal_1_1_gate_library_html_a4f3f32d464c6cc8bc93704d317e86428"><div class="ttname"><a href="classhal_1_1_gate_library.html#a4f3f32d464c6cc8bc93704d317e86428">hal::GateLibrary::get_vcc_gate_types</a></div><div class="ttdeci">std::unordered_map&lt; std::string, GateType * &gt; get_vcc_gate_types() const</div><div class="ttdef"><b>Definition:</b> <a href="netlist_2gate__library_2gate__library_8cpp_source.html#l00174">gate_library.cpp:174</a></div></div>
<div class="ttc" id="aclasshal_1_1_gate_library_html_abc606af53f4d9c1fc42e029851410e1e"><div class="ttname"><a href="classhal_1_1_gate_library.html#abc606af53f4d9c1fc42e029851410e1e">hal::GateLibrary::get_gnd_gate_types</a></div><div class="ttdeci">std::unordered_map&lt; std::string, GateType * &gt; get_gnd_gate_types() const</div><div class="ttdef"><b>Definition:</b> <a href="netlist_2gate__library_2gate__library_8cpp_source.html#l00196">gate_library.cpp:196</a></div></div>
<div class="ttc" id="aclasshal_1_1_gate_library_html_aef64b8371779e27c778227552deb3a6d"><div class="ttname"><a href="classhal_1_1_gate_library.html#aef64b8371779e27c778227552deb3a6d">hal::GateLibrary::get_name</a></div><div class="ttdeci">std::string get_name() const</div><div class="ttdef"><b>Definition:</b> <a href="netlist_2gate__library_2gate__library_8cpp_source.html#l00013">gate_library.cpp:13</a></div></div>
<div class="ttc" id="aclasshal_1_1_gate_pin_html"><div class="ttname"><a href="classhal_1_1_gate_pin.html">hal::GatePin</a></div><div class="ttdef"><b>Definition:</b> <a href="gate__pin_8h_source.html#l00044">gate_pin.h:45</a></div></div>
<div class="ttc" id="aclasshal_1_1_gate_type_html"><div class="ttname"><a href="classhal_1_1_gate_type.html">hal::GateType</a></div><div class="ttdef"><b>Definition:</b> <a href="gate__type_8h_source.html#l00051">gate_type.h:52</a></div></div>
<div class="ttc" id="aclasshal_1_1_gate_type_html_a2ff8c787cda54ece95f10b399abb839a"><div class="ttname"><a href="classhal_1_1_gate_type.html#a2ff8c787cda54ece95f10b399abb839a">hal::GateType::get_output_pins</a></div><div class="ttdeci">std::vector&lt; GatePin * &gt; get_output_pins() const</div><div class="ttdef"><b>Definition:</b> <a href="netlist_2gate__library_2gate__type_8cpp_source.html#l00285">gate_type.cpp:285</a></div></div>
<div class="ttc" id="aclasshal_1_1_module_html_a009c72540e8a05665c2ca51ab8e62b07"><div class="ttname"><a href="classhal_1_1_module.html#a009c72540e8a05665c2ca51ab8e62b07">hal::Module::is_input_net</a></div><div class="ttdeci">bool is_input_net(Net *net) const</div><div class="ttdef"><b>Definition:</b> <a href="netlist_2module_8cpp_source.html#l00555">module.cpp:555</a></div></div>
<div class="ttc" id="aclasshal_1_1_module_html_a00c72047157e9a34c9706d2685a90a13"><div class="ttname"><a href="classhal_1_1_module.html#a00c72047157e9a34c9706d2685a90a13">hal::Module::set_name</a></div><div class="ttdeci">void set_name(const std::string &amp;name)</div><div class="ttdef"><b>Definition:</b> <a href="netlist_2module_8cpp_source.html#l00092">module.cpp:92</a></div></div>
<div class="ttc" id="aclasshal_1_1_module_html_a02af541336529b5ff7a4babadd43bbdb"><div class="ttname"><a href="classhal_1_1_module.html#a02af541336529b5ff7a4babadd43bbdb">hal::Module::update_nets</a></div><div class="ttdeci">void update_nets()</div><div class="ttdef"><b>Definition:</b> <a href="netlist_2module_8cpp_source.html#l00434">module.cpp:434</a></div></div>
<div class="ttc" id="aclasshal_1_1_module_html_a5ed13732e904b8bf1b3bc670f637acc2"><div class="ttname"><a href="classhal_1_1_module.html#a5ed13732e904b8bf1b3bc670f637acc2">hal::Module::is_top_module</a></div><div class="ttdeci">bool is_top_module() const</div><div class="ttdef"><b>Definition:</b> <a href="netlist_2module_8cpp_source.html#l00312">module.cpp:312</a></div></div>
<div class="ttc" id="aclasshal_1_1_module_html_a7446c45dc94cefbf49a51261e0299e1d"><div class="ttname"><a href="classhal_1_1_module.html#a7446c45dc94cefbf49a51261e0299e1d">hal::Module::assign_gate</a></div><div class="ttdeci">bool assign_gate(Gate *gate)</div><div class="ttdef"><b>Definition:</b> <a href="netlist_2module_8cpp_source.html#l00322">module.cpp:322</a></div></div>
<div class="ttc" id="aclasshal_1_1_module_html_a74611022d6c488580fae0106005f7627"><div class="ttname"><a href="classhal_1_1_module.html#a74611022d6c488580fae0106005f7627">hal::Module::is_output_net</a></div><div class="ttdeci">bool is_output_net(Net *net) const</div><div class="ttdef"><b>Definition:</b> <a href="netlist_2module_8cpp_source.html#l00565">module.cpp:565</a></div></div>
<div class="ttc" id="aclasshal_1_1_module_html_a87cf9f30579e5e461f525ab78274e1df"><div class="ttname"><a href="classhal_1_1_module.html#a87cf9f30579e5e461f525ab78274e1df">hal::Module::get_name</a></div><div class="ttdeci">std::string get_name() const</div><div class="ttdef"><b>Definition:</b> <a href="netlist_2module_8cpp_source.html#l00087">module.cpp:87</a></div></div>
<div class="ttc" id="aclasshal_1_1_module_html_a8e83b6de125c04f00e5cdc18580bed8d"><div class="ttname"><a href="classhal_1_1_module.html#a8e83b6de125c04f00e5cdc18580bed8d">hal::Module::get_input_nets</a></div><div class="ttdeci">const std::unordered_set&lt; Net * &gt; &amp; get_input_nets() const</div><div class="ttdef"><b>Definition:</b> <a href="netlist_2module_8cpp_source.html#l00540">module.cpp:540</a></div></div>
<div class="ttc" id="aclasshal_1_1_module_html_a9bcc555241bfad8b6abccaecb2f021ce"><div class="ttname"><a href="classhal_1_1_module.html#a9bcc555241bfad8b6abccaecb2f021ce">hal::Module::set_type</a></div><div class="ttdeci">void set_type(const std::string &amp;type)</div><div class="ttdef"><b>Definition:</b> <a href="netlist_2module_8cpp_source.html#l00111">module.cpp:111</a></div></div>
<div class="ttc" id="aclasshal_1_1_module_html_ab8cd2075036048e2fb55b1e62828a865"><div class="ttname"><a href="classhal_1_1_module.html#ab8cd2075036048e2fb55b1e62828a865">hal::Module::get_pin_by_net</a></div><div class="ttdeci">ModulePin * get_pin_by_net(Net *net) const</div><div class="ttdef"><b>Definition:</b> <a href="netlist_2module_8cpp_source.html#l01017">module.cpp:1017</a></div></div>
<div class="ttc" id="aclasshal_1_1_module_html_ad35559b823f388e85241716ef8189fc9"><div class="ttname"><a href="classhal_1_1_module.html#ad35559b823f388e85241716ef8189fc9">hal::Module::create_pin</a></div><div class="ttdeci">Result&lt; ModulePin * &gt; create_pin(const u32 id, const std::string &amp;name, Net *net, PinType type=PinType::none, bool create_group=true, bool force_name=false)</div><div class="ttdef"><b>Definition:</b> <a href="netlist_2module_8cpp_source.html#l00787">module.cpp:787</a></div></div>
<div class="ttc" id="aclasshal_1_1_module_html_af771e486709f93e4abab9f0fe092010b"><div class="ttname"><a href="classhal_1_1_module.html#af771e486709f93e4abab9f0fe092010b">hal::Module::get_id</a></div><div class="ttdeci">u32 get_id() const</div><div class="ttdef"><b>Definition:</b> <a href="netlist_2module_8cpp_source.html#l00082">module.cpp:82</a></div></div>
<div class="ttc" id="aclasshal_1_1_net_html"><div class="ttname"><a href="classhal_1_1_net.html">hal::Net</a></div><div class="ttdef"><b>Definition:</b> <a href="net_8h_source.html#l00057">net.h:58</a></div></div>
<div class="ttc" id="aclasshal_1_1_net_html_a086e0fa561405ac8b0beae95d8caa69d"><div class="ttname"><a href="classhal_1_1_net.html#a086e0fa561405ac8b0beae95d8caa69d">hal::Net::get_id</a></div><div class="ttdeci">u32 get_id() const</div><div class="ttdef"><b>Definition:</b> <a href="netlist_2net_8cpp_source.html#l00088">net.cpp:88</a></div></div>
<div class="ttc" id="aclasshal_1_1_net_html_a43001069500ebb42e6ac86b865d25947"><div class="ttname"><a href="classhal_1_1_net.html#a43001069500ebb42e6ac86b865d25947">hal::Net::add_source</a></div><div class="ttdeci">Endpoint * add_source(Gate *gate, const std::string &amp;pin_name)</div><div class="ttdef"><b>Definition:</b> <a href="netlist_2net_8cpp_source.html#l00127">net.cpp:127</a></div></div>
<div class="ttc" id="aclasshal_1_1_net_html_a4627e0be693c99fece29559be12898bd"><div class="ttname"><a href="classhal_1_1_net.html#a4627e0be693c99fece29559be12898bd">hal::Net::get_name</a></div><div class="ttdeci">const std::string &amp; get_name() const</div><div class="ttdef"><b>Definition:</b> <a href="netlist_2net_8cpp_source.html#l00098">net.cpp:98</a></div></div>
<div class="ttc" id="aclasshal_1_1_net_html_aa76dff7b223ce4676dfb8e4232ae2488"><div class="ttname"><a href="classhal_1_1_net.html#aa76dff7b223ce4676dfb8e4232ae2488">hal::Net::get_num_of_destinations</a></div><div class="ttdeci">u32 get_num_of_destinations(const std::function&lt; bool(Endpoint *ep)&gt; &amp;filter=nullptr) const</div><div class="ttdef"><b>Definition:</b> <a href="netlist_2net_8cpp_source.html#l00408">net.cpp:408</a></div></div>
<div class="ttc" id="aclasshal_1_1_netlist_html_a0b4333d865d8813103a495745a30c817"><div class="ttname"><a href="classhal_1_1_netlist.html#a0b4333d865d8813103a495745a30c817">hal::Netlist::get_top_module</a></div><div class="ttdeci">Module * get_top_module() const</div><div class="ttdef"><b>Definition:</b> <a href="src_2netlist_2netlist_8cpp_source.html#l00608">netlist.cpp:608</a></div></div>
<div class="ttc" id="aclasshal_1_1_netlist_html_a0e33d071f904e7538f927a6a92885057"><div class="ttname"><a href="classhal_1_1_netlist.html#a0e33d071f904e7538f927a6a92885057">hal::Netlist::get_unique_gate_id</a></div><div class="ttdeci">u32 get_unique_gate_id()</div><div class="ttdef"><b>Definition:</b> <a href="src_2netlist_2netlist_8cpp_source.html#l00160">netlist.cpp:160</a></div></div>
<div class="ttc" id="aclasshal_1_1_netlist_html_a13814c485dc7040d31820466b0a6883f"><div class="ttname"><a href="classhal_1_1_netlist.html#a13814c485dc7040d31820466b0a6883f">hal::Netlist::mark_vcc_gate</a></div><div class="ttdeci">bool mark_vcc_gate(Gate *gate)</div><div class="ttdef"><b>Definition:</b> <a href="src_2netlist_2netlist_8cpp_source.html#l00228">netlist.cpp:228</a></div></div>
<div class="ttc" id="aclasshal_1_1_netlist_html_a1600d7ec1cf6455657786174bc958589"><div class="ttname"><a href="classhal_1_1_netlist.html#a1600d7ec1cf6455657786174bc958589">hal::Netlist::mark_gnd_gate</a></div><div class="ttdeci">bool mark_gnd_gate(Gate *gate)</div><div class="ttdef"><b>Definition:</b> <a href="src_2netlist_2netlist_8cpp_source.html#l00244">netlist.cpp:244</a></div></div>
<div class="ttc" id="aclasshal_1_1_netlist_html_a2f4fbe600e19dc28c5bddf40b38ac0cf"><div class="ttname"><a href="classhal_1_1_netlist.html#a2f4fbe600e19dc28c5bddf40b38ac0cf">hal::Netlist::load_gate_locations_from_data</a></div><div class="ttdeci">bool load_gate_locations_from_data(const std::string &amp;data_category=&quot;&quot;, const std::pair&lt; std::string, std::string &gt; &amp;data_identifiers=std::pair&lt; std::string, std::string &gt;())</div><div class="ttdef"><b>Definition:</b> <a href="src_2netlist_2netlist_8cpp_source.html#l00862">netlist.cpp:862</a></div></div>
<div class="ttc" id="aclasshal_1_1_netlist_html_a3c2fbba09aa1857d44790bbd16c9df4e"><div class="ttname"><a href="classhal_1_1_netlist.html#a3c2fbba09aa1857d44790bbd16c9df4e">hal::Netlist::delete_net</a></div><div class="ttdeci">bool delete_net(Net *net)</div><div class="ttdef"><b>Definition:</b> <a href="src_2netlist_2netlist_8cpp_source.html#l00343">netlist.cpp:343</a></div></div>
<div class="ttc" id="aclasshal_1_1_netlist_html_a4735650221335f256fa7ce8d88c6f551"><div class="ttname"><a href="classhal_1_1_netlist.html#a4735650221335f256fa7ce8d88c6f551">hal::Netlist::create_net</a></div><div class="ttdeci">Net * create_net(const u32 net_id, const std::string &amp;name)</div><div class="ttdef"><b>Definition:</b> <a href="src_2netlist_2netlist_8cpp_source.html#l00333">netlist.cpp:333</a></div></div>
<div class="ttc" id="aclasshal_1_1_netlist_html_a5024423d773b9705545bf62f64c749a9"><div class="ttname"><a href="classhal_1_1_netlist.html#a5024423d773b9705545bf62f64c749a9">hal::Netlist::get_gnd_gates</a></div><div class="ttdeci">const std::vector&lt; Gate * &gt; &amp; get_gnd_gates() const</div><div class="ttdef"><b>Definition:</b> <a href="src_2netlist_2netlist_8cpp_source.html#l00309">netlist.cpp:309</a></div></div>
<div class="ttc" id="aclasshal_1_1_netlist_html_a5e707263f93fa7df2cc420c653831ba2"><div class="ttname"><a href="classhal_1_1_netlist.html#a5e707263f93fa7df2cc420c653831ba2">hal::Netlist::set_design_name</a></div><div class="ttdeci">void set_design_name(const std::string &amp;name)</div><div class="ttdef"><b>Definition:</b> <a href="src_2netlist_2netlist_8cpp_source.html#l00109">netlist.cpp:109</a></div></div>
<div class="ttc" id="aclasshal_1_1_netlist_html_a5fd4f32302dcb8dbcdc4b512d586fee9"><div class="ttname"><a href="classhal_1_1_netlist.html#a5fd4f32302dcb8dbcdc4b512d586fee9">hal::Netlist::enable_automatic_net_checks</a></div><div class="ttdeci">void enable_automatic_net_checks(bool enable_checks=true)</div><div class="ttdef"><b>Definition:</b> <a href="src_2netlist_2netlist_8cpp_source.html#l00563">netlist.cpp:563</a></div></div>
<div class="ttc" id="aclasshal_1_1_netlist_html_a6b9524e351ab55d1b6cd6cb27dec707c"><div class="ttname"><a href="classhal_1_1_netlist.html#a6b9524e351ab55d1b6cd6cb27dec707c">hal::Netlist::get_vcc_gates</a></div><div class="ttdeci">const std::vector&lt; Gate * &gt; &amp; get_vcc_gates() const</div><div class="ttdef"><b>Definition:</b> <a href="src_2netlist_2netlist_8cpp_source.html#l00304">netlist.cpp:304</a></div></div>
<div class="ttc" id="aclasshal_1_1_netlist_html_a7eb17e617d1b20d05fdd146ad63c138b"><div class="ttname"><a href="classhal_1_1_netlist.html#a7eb17e617d1b20d05fdd146ad63c138b">hal::Netlist::get_modules</a></div><div class="ttdeci">const std::vector&lt; Module * &gt; &amp; get_modules() const</div><div class="ttdef"><b>Definition:</b> <a href="src_2netlist_2netlist_8cpp_source.html#l00624">netlist.cpp:624</a></div></div>
<div class="ttc" id="aclasshal_1_1_netlist_html_aaeb832a880bee7804dd2bd7cfd6adfd4"><div class="ttname"><a href="classhal_1_1_netlist.html#aaeb832a880bee7804dd2bd7cfd6adfd4">hal::Netlist::create_gate</a></div><div class="ttdeci">Gate * create_gate(const u32 gate_id, GateType *gate_type, const std::string &amp;name=&quot;&quot;, i32 x=-1, i32 y=-1)</div><div class="ttdef"><b>Definition:</b> <a href="src_2netlist_2netlist_8cpp_source.html#l00173">netlist.cpp:173</a></div></div>
<div class="ttc" id="aclasshal_1_1_netlist_html_ac787de6b52a38112735e3ff9bd2b6d17"><div class="ttname"><a href="classhal_1_1_netlist.html#ac787de6b52a38112735e3ff9bd2b6d17">hal::Netlist::get_nets</a></div><div class="ttdeci">const std::vector&lt; Net * &gt; &amp; get_nets() const</div><div class="ttdef"><b>Definition:</b> <a href="src_2netlist_2netlist_8cpp_source.html#l00364">netlist.cpp:364</a></div></div>
<div class="ttc" id="aclasshal_1_1_netlist_html_adeae0f508eb65ca66c78d560f89340c2"><div class="ttname"><a href="classhal_1_1_netlist.html#adeae0f508eb65ca66c78d560f89340c2">hal::Netlist::get_gate_library</a></div><div class="ttdeci">const GateLibrary * get_gate_library() const</div><div class="ttdef"><b>Definition:</b> <a href="src_2netlist_2netlist_8cpp_source.html#l00132">netlist.cpp:132</a></div></div>
<div class="ttc" id="aclasshal_1_1_netlist_html_af2441daee88b306451caa9265d37d78c"><div class="ttname"><a href="classhal_1_1_netlist.html#af2441daee88b306451caa9265d37d78c">hal::Netlist::create_module</a></div><div class="ttdeci">Module * create_module(const u32 module_id, const std::string &amp;name, Module *parent, const std::vector&lt; Gate * &gt; &amp;gates={})</div><div class="ttdef"><b>Definition:</b> <a href="src_2netlist_2netlist_8cpp_source.html#l00587">netlist.cpp:587</a></div></div>
<div class="ttc" id="aclasshal_1_1_result_html"><div class="ttname"><a href="classhal_1_1_result.html">hal::Result</a></div><div class="ttdef"><b>Definition:</b> <a href="include_2hal__core_2utilities_2result_8h_source.html#l00063">result.h:64</a></div></div>
<div class="ttc" id="aclasshal_1_1_token_stream_html"><div class="ttname"><a href="classhal_1_1_token_stream.html">hal::TokenStream</a></div><div class="ttdef"><b>Definition:</b> <a href="token__stream_8h_source.html#l00125">token_stream.h:126</a></div></div>
<div class="ttc" id="aclasshal_1_1_token_stream_html_a0001aa8643e27c8a387420769982679a"><div class="ttname"><a href="classhal_1_1_token_stream.html#a0001aa8643e27c8a387420769982679a">hal::TokenStream::remaining</a></div><div class="ttdeci">u32 remaining() const</div><div class="ttdef"><b>Definition:</b> <a href="token__stream_8h_source.html#l00494">token_stream.h:494</a></div></div>
<div class="ttc" id="aclasshal_1_1_token_stream_html_a059d296b9805d98e33992dd8b44c7139"><div class="ttname"><a href="classhal_1_1_token_stream.html#a059d296b9805d98e33992dd8b44c7139">hal::TokenStream&lt; ci_string &gt;::END_OF_STREAM</a></div><div class="ttdeci">static const u32 END_OF_STREAM</div><div class="ttdef"><b>Definition:</b> <a href="token__stream_8h_source.html#l00147">token_stream.h:147</a></div></div>
<div class="ttc" id="aclasshal_1_1_token_stream_html_a182e918c3841294d1e3faf71556c6c41"><div class="ttname"><a href="classhal_1_1_token_stream.html#a182e918c3841294d1e3faf71556c6c41">hal::TokenStream::consume_until</a></div><div class="ttdeci">Token&lt; T &gt; consume_until(const T &amp;expected, u32 end=END_OF_STREAM, bool level_aware=true, bool throw_on_error=false)</div><div class="ttdef"><b>Definition:</b> <a href="token__stream_8h_source.html#l00266">token_stream.h:266</a></div></div>
<div class="ttc" id="aclasshal_1_1_token_stream_html_a660cabea791d72b7980930d49e8f8ec9"><div class="ttname"><a href="classhal_1_1_token_stream.html#a660cabea791d72b7980930d49e8f8ec9">hal::TokenStream::peek</a></div><div class="ttdeci">Token&lt; T &gt; &amp; peek(i32 offset=0)</div><div class="ttdef"><b>Definition:</b> <a href="token__stream_8h_source.html#l00392">token_stream.h:392</a></div></div>
<div class="ttc" id="aclasshal_1_1_token_stream_html_a77c5de4f3427dfc1f7edfa1e5234cf52"><div class="ttname"><a href="classhal_1_1_token_stream.html#a77c5de4f3427dfc1f7edfa1e5234cf52">hal::TokenStream::find_next</a></div><div class="ttdeci">u32 find_next(const T &amp;match, u32 end=END_OF_STREAM, bool level_aware=true) const</div><div class="ttdef"><b>Definition:</b> <a href="token__stream_8h_source.html#l00446">token_stream.h:446</a></div></div>
<div class="ttc" id="aclasshal_1_1_token_stream_html_a8cd436414ae5483c8cb37b24fffd88e2"><div class="ttname"><a href="classhal_1_1_token_stream.html#a8cd436414ae5483c8cb37b24fffd88e2">hal::TokenStream::join_until</a></div><div class="ttdeci">Token&lt; T &gt; join_until(const T &amp;match, const T &amp;joiner, u32 end=END_OF_STREAM, bool level_aware=true, bool throw_on_error=false)</div><div class="ttdef"><b>Definition:</b> <a href="token__stream_8h_source.html#l00338">token_stream.h:338</a></div></div>
<div class="ttc" id="aclasshal_1_1_token_stream_html_abeb97a5ae00e35a6ce00d4fa211de61a"><div class="ttname"><a href="classhal_1_1_token_stream.html#abeb97a5ae00e35a6ce00d4fa211de61a">hal::TokenStream::extract_until</a></div><div class="ttdeci">TokenStream&lt; T &gt; extract_until(const T &amp;expected, u32 end=END_OF_STREAM, bool level_aware=true, bool throw_on_error=false)</div><div class="ttdef"><b>Definition:</b> <a href="token__stream_8h_source.html#l00308">token_stream.h:308</a></div></div>
<div class="ttc" id="aclasshal_1_1_token_stream_html_ac78663ded2f48ed5c0001f98e28aad7f"><div class="ttname"><a href="classhal_1_1_token_stream.html#ac78663ded2f48ed5c0001f98e28aad7f">hal::TokenStream::consume</a></div><div class="ttdeci">Token&lt; T &gt; consume(u32 num=1)</div><div class="ttdef"><b>Definition:</b> <a href="token__stream_8h_source.html#l00216">token_stream.h:216</a></div></div>
<div class="ttc" id="aclasshal_1_1_v_h_d_l_parser_html_a4f2a41871abc23e22badf76ded8169ae"><div class="ttname"><a href="classhal_1_1_v_h_d_l_parser.html#a4f2a41871abc23e22badf76ded8169ae">hal::VHDLParser::parse</a></div><div class="ttdeci">Result&lt; std::monostate &gt; parse(const std::filesystem::path &amp;file_path) override</div><div class="ttdef"><b>Definition:</b> <a href="src_2vhdl__parser_8cpp_source.html#l00022">vhdl_parser.cpp:22</a></div></div>
<div class="ttc" id="aclasshal_1_1_v_h_d_l_parser_html_afef7ad24385cdb4a5219bb96c6e55898"><div class="ttname"><a href="classhal_1_1_v_h_d_l_parser.html#afef7ad24385cdb4a5219bb96c6e55898">hal::VHDLParser::instantiate</a></div><div class="ttdeci">Result&lt; std::unique_ptr&lt; Netlist &gt; &gt; instantiate(const GateLibrary *gate_library) override</div><div class="ttdef"><b>Definition:</b> <a href="src_2vhdl__parser_8cpp_source.html#l00241">vhdl_parser.cpp:241</a></div></div>
<div class="ttc" id="adefines_8h_html_a1af9f95651e921615e75917a6dd1b574"><div class="ttname"><a href="defines_8h.html#a1af9f95651e921615e75917a6dd1b574">u64</a></div><div class="ttdeci">uint64_t u64</div><div class="ttdef"><b>Definition:</b> <a href="defines_8h_source.html#l00042">defines.h:42</a></div></div>
<div class="ttc" id="aendpoint_8h_html"><div class="ttname"><a href="endpoint_8h.html">endpoint.h</a></div></div>
<div class="ttc" id="aenums_8h_html"><div class="ttname"><a href="enums_8h.html">enums.h</a></div></div>
<div class="ttc" id="agate_8h_html"><div class="ttname"><a href="gate_8h.html">gate.h</a></div></div>
<div class="ttc" id="agroup__gui_html_ggaab0cd38a41c1215ae70822b1d501daa1a5012af45088eb8e999bb8350077b12ca"><div class="ttname"><a href="group__gui.html#ggaab0cd38a41c1215ae70822b1d501daa1a5012af45088eb8e999bb8350077b12ca">hal::ItemType::Net</a></div><div class="ttdeci">@ Net</div></div>
<div class="ttc" id="agroup__gui_html_ggaab0cd38a41c1215ae70822b1d501daa1ad25b4bd4c72aa2c07ee87adb10b59f16"><div class="ttname"><a href="group__gui.html#ggaab0cd38a41c1215ae70822b1d501daa1ad25b4bd4c72aa2c07ee87adb10b59f16">hal::ItemType::Gate</a></div><div class="ttdeci">@ Gate</div></div>
<div class="ttc" id="agroup__gui_html_ggaab0cd38a41c1215ae70822b1d501daa1ae55f75a29310d7b60f7ac1d390c8ae42"><div class="ttname"><a href="group__gui.html#ggaab0cd38a41c1215ae70822b1d501daa1ae55f75a29310d7b60f7ac1d390c8ae42">hal::ItemType::Module</a></div><div class="ttdeci">@ Module</div></div>
<div class="ttc" id="agroup__utilities_html_gaccc921ec8323d53efb57a21a8d4be735"><div class="ttname"><a href="group__utilities.html#gaccc921ec8323d53efb57a21a8d4be735">log_warning</a></div><div class="ttdeci">#define log_warning(channel,...)</div><div class="ttdef"><b>Definition:</b> <a href="log_8h_source.html#l00076">log.h:76</a></div></div>
<div class="ttc" id="ainclude_2hal__core_2netlist_2netlist_8h_html"><div class="ttname"><a href="include_2hal__core_2netlist_2netlist_8h.html">netlist.h</a></div></div>
<div class="ttc" id="ainclude_2hal__core_2utilities_2result_8h_html_a1c3e89a5c947d0af52de06b706adcf09"><div class="ttname"><a href="include_2hal__core_2utilities_2result_8h.html#a1c3e89a5c947d0af52de06b706adcf09">ERR</a></div><div class="ttdeci">#define ERR(message)</div><div class="ttdef"><b>Definition:</b> <a href="include_2hal__core_2utilities_2result_8h_source.html#l00053">result.h:53</a></div></div>
<div class="ttc" id="ainclude_2hal__core_2utilities_2result_8h_html_a5ad667153a89697b109f5b8e64da7fe7"><div class="ttname"><a href="include_2hal__core_2utilities_2result_8h.html#a5ad667153a89697b109f5b8e64da7fe7">OK</a></div><div class="ttdeci">#define OK(...)</div><div class="ttdef"><b>Definition:</b> <a href="include_2hal__core_2utilities_2result_8h_source.html#l00049">result.h:49</a></div></div>
<div class="ttc" id="ainclude_2hal__core_2utilities_2result_8h_html_af20e293cf442ddedc129f87bbb6a69e9"><div class="ttname"><a href="include_2hal__core_2utilities_2result_8h.html#af20e293cf442ddedc129f87bbb6a69e9">ERR_APPEND</a></div><div class="ttdeci">#define ERR_APPEND(prev_error, message)</div><div class="ttdef"><b>Definition:</b> <a href="include_2hal__core_2utilities_2result_8h_source.html#l00057">result.h:57</a></div></div>
<div class="ttc" id="alog_8h_html"><div class="ttname"><a href="log_8h.html">log.h</a></div></div>
<div class="ttc" id="anamespacehal_1_1_shortest_path_html_a6f60f4bfa62d51227fa5fcc3e7d838a9"><div class="ttname"><a href="namespacehal_1_1_shortest_path.html#a6f60f4bfa62d51227fa5fcc3e7d838a9">hal::ShortestPath::module</a></div><div class="ttdeci">const Module * module(const Gate *g, const NodeBoxes &amp;boxes)</div><div class="ttdef"><b>Definition:</b> <a href="graph__graphics__view_8cpp_source.html#l00747">graph_graphics_view.cpp:747</a></div></div>
<div class="ttc" id="anamespacehal_1_1core__strings_html_a939599c80f140610abb0390b66acf8a6"><div class="ttname"><a href="namespacehal_1_1core__strings.html#a939599c80f140610abb0390b66acf8a6">hal::core_strings::CaseInsensitiveString</a></div><div class="ttdeci">std::basic_string&lt; char, CaseInsensitiveCharTraits &gt; CaseInsensitiveString</div><div class="ttdef"><b>Definition:</b> <a href="special__strings_8h_source.html#l00143">special_strings.h:143</a></div></div>
<div class="ttc" id="anamespacehal_1_1netlist__factory_html_a02885346f0ee983f70af158fdb0f3968"><div class="ttname"><a href="namespacehal_1_1netlist__factory.html#a02885346f0ee983f70af158fdb0f3968">hal::netlist_factory::create_netlist</a></div><div class="ttdeci">std::unique_ptr&lt; Netlist &gt; create_netlist(const GateLibrary *gate_library)</div><div class="ttdoc">Create a new empty netlist using the specified gate library.</div><div class="ttdef"><b>Definition:</b> <a href="netlist_2netlist__factory_8cpp_source.html#l00019">netlist_factory.cpp:19</a></div></div>
<div class="ttc" id="anamespacehal_1_1utils_html_a0b35fa35b17eeadefc578daab0de6c06"><div class="ttname"><a href="namespacehal_1_1utils.html#a0b35fa35b17eeadefc578daab0de6c06">hal::utils::replace</a></div><div class="ttdeci">CORE_API T replace(const T &amp;str, const T &amp;search, const T &amp;replace)</div><div class="ttdef"><b>Definition:</b> <a href="utils_8h_source.html#l00382">utils.h:382</a></div></div>
<div class="ttc" id="anamespacehal_1_1utils_html_a0de77a47a2551c69619fd6e3fce84674"><div class="ttname"><a href="namespacehal_1_1utils.html#a0de77a47a2551c69619fd6e3fce84674">hal::utils::ends_with</a></div><div class="ttdeci">CORE_API bool ends_with(const T &amp;s, const T &amp;end)</div><div class="ttdef"><b>Definition:</b> <a href="utils_8h_source.html#l00147">utils.h:147</a></div></div>
<div class="ttc" id="anamespacehal_1_1utils_html_a0fc4367e2b10cb8ed7c83998e231797d"><div class="ttname"><a href="namespacehal_1_1utils.html#a0fc4367e2b10cb8ed7c83998e231797d">hal::utils::is_digits</a></div><div class="ttdeci">CORE_API bool is_digits(const T &amp;s)</div><div class="ttdef"><b>Definition:</b> <a href="utils_8h_source.html#l00186">utils.h:186</a></div></div>
<div class="ttc" id="anamespacehal_1_1utils_html_a2ca8da557f49866efbd3d79be8bf5815"><div class="ttname"><a href="namespacehal_1_1utils.html#a2ca8da557f49866efbd3d79be8bf5815">hal::utils::starts_with</a></div><div class="ttdeci">CORE_API bool starts_with(const T &amp;s, const T &amp;start)</div><div class="ttdef"><b>Definition:</b> <a href="utils_8h_source.html#l00167">utils.h:167</a></div></div>
<div class="ttc" id="anamespacehal_1_1utils_html_a3b3244bd8945cb61cfa299c32686a601"><div class="ttname"><a href="namespacehal_1_1utils.html#a3b3244bd8945cb61cfa299c32686a601">hal::utils::trim</a></div><div class="ttdeci">CORE_API T trim(const T &amp;s, const char *to_remove=&quot; \t\r\n&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="utils_8h_source.html#l00358">utils.h:358</a></div></div>
<div class="ttc" id="anamespacehal_1_1utils_html_a94d00e2a6c7e4945e1301d5e96377459"><div class="ttname"><a href="namespacehal_1_1utils.html#a94d00e2a6c7e4945e1301d5e96377459">hal::utils::is_integer</a></div><div class="ttdeci">CORE_API bool is_integer(const T &amp;s)</div><div class="ttdef"><b>Definition:</b> <a href="utils_8h_source.html#l00198">utils.h:198</a></div></div>
<div class="ttc" id="anamespacehal_1_1utils_html_ac066333866ab6d67d66f1d9ec5671d79"><div class="ttname"><a href="namespacehal_1_1utils.html#ac066333866ab6d67d66f1d9ec5671d79">hal::utils::is_floating_point</a></div><div class="ttdeci">CORE_API bool is_floating_point(const T &amp;s)</div><div class="ttdef"><b>Definition:</b> <a href="utils_8h_source.html#l00218">utils.h:218</a></div></div>
<div class="ttc" id="anamespacehal_1_1utils_html_ac4b3b46a9b2575322a0a296daac79828"><div class="ttname"><a href="namespacehal_1_1utils.html#ac4b3b46a9b2575322a0a296daac79828">hal::utils::to_upper</a></div><div class="ttdeci">CORE_API T to_upper(const T &amp;s)</div><div class="ttdef"><b>Definition:</b> <a href="utils_8h_source.html#l00463">utils.h:463</a></div></div>
<div class="ttc" id="anamespacehal_html"><div class="ttname"><a href="namespacehal.html">hal</a></div><div class="ttdef"><b>Definition:</b> <a href="parser__liberty_8cpp_source.html#l00009">parser_liberty.cpp:10</a></div></div>
<div class="ttc" id="anamespacehal_html_a119eb4e25d047caa41d83e762cbed8ec"><div class="ttname"><a href="namespacehal.html#a119eb4e25d047caa41d83e762cbed8ec">hal::PinDirection</a></div><div class="ttdeci">PinDirection</div><div class="ttdef"><b>Definition:</b> <a href="pin__direction_8h_source.html#l00035">pin_direction.h:36</a></div></div>
<div class="ttc" id="anamespacehal_html_a119eb4e25d047caa41d83e762cbed8eca54c9ccb45f5ee60133cca31fca024432"><div class="ttname"><a href="namespacehal.html#a119eb4e25d047caa41d83e762cbed8eca54c9ccb45f5ee60133cca31fca024432">hal::PinDirection::inout</a></div><div class="ttdeci">@ inout</div></div>
<div class="ttc" id="anamespacehal_html_a119eb4e25d047caa41d83e762cbed8eca78e6221f6393d1356681db398f14ce6d"><div class="ttname"><a href="namespacehal.html#a119eb4e25d047caa41d83e762cbed8eca78e6221f6393d1356681db398f14ce6d">hal::PinDirection::output</a></div><div class="ttdeci">@ output</div></div>
<div class="ttc" id="anamespacehal_html_a119eb4e25d047caa41d83e762cbed8ecaa43c1b0aa53a0c908810c06ab1ff3967"><div class="ttname"><a href="namespacehal.html#a119eb4e25d047caa41d83e762cbed8ecaa43c1b0aa53a0c908810c06ab1ff3967">hal::PinDirection::input</a></div><div class="ttdeci">@ input</div></div>
<div class="ttc" id="anet__layout__point_8h_html_aa7fe0c70576e86ca2c5f641bb47ccc9d"><div class="ttname"><a href="net__layout__point_8h.html#aa7fe0c70576e86ca2c5f641bb47ccc9d">u32</a></div><div class="ttdeci">quint32 u32</div><div class="ttdef"><b>Definition:</b> <a href="net__layout__point_8h_source.html#l00040">net_layout_point.h:40</a></div></div>
<div class="ttc" id="anetlist_2persistent_2netlist__serializer_8cpp_html_a1e273622affc5aefcd63c0036e5ce1b9"><div class="ttname"><a href="netlist_2persistent_2netlist__serializer_8cpp.html#a1e273622affc5aefcd63c0036e5ce1b9">pins</a></div><div class="ttdeci">std::vector&lt; PinInformation &gt; pins</div><div class="ttdef"><b>Definition:</b> <a href="netlist_2persistent_2netlist__serializer_8cpp_source.html#l00066">netlist_serializer.cpp:66</a></div></div>
<div class="ttc" id="anetlist_2persistent_2netlist__serializer_8cpp_html_a504c73ff1a68c50e5435dece66bc2772"><div class="ttname"><a href="netlist_2persistent_2netlist__serializer_8cpp.html#a504c73ff1a68c50e5435dece66bc2772">net</a></div><div class="ttdeci">Net * net</div><div class="ttdef"><b>Definition:</b> <a href="netlist_2persistent_2netlist__serializer_8cpp_source.html#l00057">netlist_serializer.cpp:57</a></div></div>
<div class="ttc" id="anetlist_2persistent_2netlist__serializer_8cpp_html_a924ab95925fc83b38cba3ac2d8d7e9aa"><div class="ttname"><a href="netlist_2persistent_2netlist__serializer_8cpp.html#a924ab95925fc83b38cba3ac2d8d7e9aa">direction</a></div><div class="ttdeci">PinDirection direction</div><div class="ttdef"><b>Definition:</b> <a href="netlist_2persistent_2netlist__serializer_8cpp_source.html#l00064">netlist_serializer.cpp:64</a></div></div>
<div class="ttc" id="anetlist_2persistent_2netlist__serializer_8cpp_html_a9b45b3e13bd9167aab02e17e08916231"><div class="ttname"><a href="netlist_2persistent_2netlist__serializer_8cpp.html#a9b45b3e13bd9167aab02e17e08916231">name</a></div><div class="ttdeci">std::string name</div><div class="ttdef"><b>Definition:</b> <a href="netlist_2persistent_2netlist__serializer_8cpp_source.html#l00058">netlist_serializer.cpp:58</a></div></div>
<div class="ttc" id="anetlist__factory_8h_html"><div class="ttname"><a href="netlist__factory_8h.html">netlist_factory.h</a></div><div class="ttdoc">This file contains various functions to create and load netlists.</div></div>
<div class="ttc" id="autils_8h_html"><div class="ttname"><a href="utils_8h.html">utils.h</a></div></div>
<div class="ttc" id="avhdl__parser_8h_html"><div class="ttname"><a href="vhdl__parser_8h.html">vhdl_parser.h</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_38c8d24aef3972a7f87b834274e76e31.html">plugins</a></li><li class="navelem"><a class="el" href="dir_b2e15e0a6fe3a6a07f9d14a493185f01.html">vhdl_parser</a></li><li class="navelem"><a class="el" href="dir_9d74caa11a0db9d268d42e2db73237a0.html">src</a></li><li class="navelem"><a class="el" href="src_2vhdl__parser_8cpp.html">vhdl_parser.cpp</a></li>
    <li class="footer">Generated on Thu Jun 19 2025 21:47:36 for HAL by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
